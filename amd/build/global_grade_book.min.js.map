{"version":3,"sources":["../src/global_grade_book.js"],"names":["define","$","read_only_view_styles","hide","bind","init","grade","document","ready","pilos","getIDs","deleteNoPilos","bloquearTotales","length","location","origin","getCourseid","swal","title","text","type","showCancelButton","confirmButtonClass","confirmButtonText","closeOnConfirm","update_grade_items","reload","on","validateNota","id","attr","split","userid","itemid","nota","val","curso","ajax","data","user","item","finalgrade","course","url","async","success","msg","updGrade","console","log","menMonitor","monitor","menPracticante","practicante","menProfesional","profesional","dataType","cache","error","e","tecla","all","keyCode","which","patron","tecla_final","String","fromCharCode","test","course_id","selector","bool","html","confirmButtonColor","removeAttr","each","css","input","children","next","isPilo","remove","click","parent","code","search","i","push","informacionUrl","window","elemento"],"mappings":"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","sourcesContent":["/**\r\n* Grade book management\r\n* @module amd/src/global_grade_book\r\n* @author Camilo José Cruz rivera\r\n* @copyright 2018 Camilo José Cruz Rivera <cruz.camilo@correounivalle.edu.co> \r\n* @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n*/\r\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert', 'block_ases/jqueryui'], function ($, bootstrap, sweetalert, jqueryui) {\r\n\r\n    return {\r\n        read_only_view_styles: function() {\r\n            /*Hide 'Change to aggregates only' icon in grade report header of moodle*/\r\n            $('.category .action-icon').hide();\r\n            /* Disable surname and firstname links */\r\n            $('#studentheader > a').bind('click', false);\r\n        },\r\n        init: function () {\r\n            var grade;\r\n\r\n            $(document).ready(function () {\r\n                var pilos = getIDs();\r\n                deleteNoPilos(pilos);\r\n                bloquearTotales();\r\n                if ($('.gradingerror').length != 0) {\r\n                    //Redirect to a new page given the course id \r\n                    var new_page = location.origin + \"/moodle/grade/report/grader/index.php?id=\" + getCourseid();\r\n                    swal({\r\n                        title: \"Recalculando ítems.\",\r\n                        text: \"Debido al proceso de actualización del campus virtual se debe realizar este paso.\\nGracias por su paciencia \\nDe seguir presentando este problema, por favor dirigirse al area de sistemas Ases\",\r\n                        type: \"warning\",\r\n                        showCancelButton: false,\r\n                        confirmButtonClass: \"btn-danger\",\r\n                        confirmButtonText: \"Continuar\",\r\n                        closeOnConfirm: false\r\n                    },\r\n                        function () {\r\n                            update_grade_items(getCourseid());\r\n                            location.reload();\r\n                        });\r\n                }\r\n            });\r\n\r\n\r\n\r\n\r\n            $(document).on('blur', '.text', function () {\r\n                if (validateNota($(this))) {\r\n                    var id = $(this).attr('id').split(\"_\");\r\n                    var userid = id[1];\r\n                    var itemid = id[2];\r\n                    var nota = $(this).val();\r\n                    var curso = getCourseid();\r\n                    var data = { user: userid, item: itemid, finalgrade: nota, course: curso };\r\n                    $.ajax({\r\n                        type: \"POST\",\r\n                        data: data,\r\n                        url: \"../managers/grade_categories/grader_processing.php\",\r\n                        async: false,\r\n                        success: function (msg) {\r\n\r\n                            var updGrade = msg.nota;\r\n\r\n                            if (updGrade == true) {\r\n                                console.log(\"Nota actualizada\");\r\n\r\n                                if (nota < 3) {\r\n                                    var menMonitor = msg.monitor;\r\n                                    var menPracticante = msg.practicante;\r\n                                    var menProfesional = msg.profesional;\r\n\r\n                                    if (menMonitor == true) {\r\n                                        console.log(\"mensaje al monitor enviado correctamente\");\r\n                                    } else {\r\n                                        console.log(\"error monitor\");\r\n                                        swal('Error',\r\n                                            'Error al enviar correo al monitor',\r\n                                            'error');\r\n                                    }\r\n\r\n                                    if (menPracticante == true) {\r\n                                        console.log(\"mensaje al practicante enviado correctamente\");\r\n                                    } else {\r\n                                        console.log(\"error practicante\");\r\n                                        swal('Error',\r\n                                            'Error al enviar correo al practicante',\r\n                                            'error');\r\n                                    }\r\n\r\n                                    if (menProfesional == true) {\r\n                                        console.log(\"mensaje al profesional enviado correctamente\");\r\n                                    } else {\r\n                                        console.log(\"error profesional\");\r\n                                        swal('Error',\r\n                                            'Error al enviar correo al profesional',\r\n                                            'error');\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                swal('Error',\r\n                                    'Error al actualizar la nota',\r\n                                    'error');\r\n                            }\r\n\r\n                        },\r\n                        dataType: \"json\",\r\n                        cache: \"false\",\r\n                        error: function (msg) {\r\n                             console.log(msg); \r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            $(document).on('focus', '.text', function () {\r\n                grade = $(this).val();\r\n                //console.log(grade);\r\n            });\r\n\r\n            $(document).on('keypress', '.text', function (e) {\r\n\r\n                var tecla = (document.all) ? e.keyCode : e.which;\r\n\r\n                //backspace to delete and (.)  always allows it\r\n                if (tecla == 8 || tecla == 46) {\r\n                    return true;\r\n                }\r\n                // entry pattern, just accept numbers\r\n                patron = /[0-9]/;\r\n                tecla_final = String.fromCharCode(tecla);\r\n                return patron.test(tecla_final);\r\n            });\r\n\r\n\r\n            $(document).on('click', '.reload', function () {\r\n                location.reload();\r\n            });\r\n\r\n            /**\r\n             * @method update_grade_items \r\n             * @desc uptade the items which needsupdate from a course\r\n             * @param {integer} course_id\r\n             * @return {boolean} \r\n             */\r\n            function update_grade_items(course_id) {\r\n\r\n                var curso = course_id;\r\n                var data = { type: 'update_grade_items', course: curso };\r\n\r\n                $.ajax({\r\n                    type: \"POST\",\r\n                    data: data,\r\n                    url: \"../managers/grade_categories/grader_processing.php\",\r\n                    async: false,\r\n                    success: function (msg) {\r\n                        if (msg == '1') {\r\n                            console.log('update ok');\r\n                        } else {\r\n                            console.log('update fail');\r\n                        }\r\n                    },\r\n                    dataType: \"text\",\r\n                    cache: \"false\",\r\n                    error: function (msg) { console.log(msg); },\r\n                });\r\n            }\r\n            /**\r\n             * @method validateNota\r\n             * @desc Verifies if a grade is correct value (not empty or within a range)\r\n             * @param {DOM element} selector represents all inputs where every grade is registered\r\n             * @return {boolean} Return false in case there was any mistake or error, true if the grade is correct or there isn't a selected grade\r\n             */\r\n            function validateNota(selector) {\r\n                var bool = false;\r\n                var nota = selector.val();\r\n\r\n                if (nota > 5 || nota < 0) {\r\n                    swal({\r\n                        title: \"Ingrese un valor valido, entre 0 y 5. \\n\\rUsted ingresó: \" + nota,\r\n                        html: true,\r\n                        type: \"warning\",\r\n                        confirmButtonColor: \"#d51b23\"\r\n                    });\r\n                    selector.val(grade);\r\n                    bool = false;\r\n                } else if (nota == '' && grade != '') {\r\n                    selector.val('0');\r\n                    bool = true;\r\n                } else if (nota == '' && grade == '' || nota == grade) {\r\n                    bool = false;\r\n                } else {\r\n                    bool = true;\r\n                }\r\n\r\n\r\n\r\n                return bool;\r\n            }\r\n\r\n            /**\r\n             * @method bloquearTotales\r\n             * @desc disable some fields on front page and changes CSS (font weight and size)\r\n             * @return {void}\r\n             */\r\n            function bloquearTotales() {\r\n                $(\"#user-grades a\").removeAttr(\"href\");\r\n\r\n                $('.cat').each(function () {\r\n                    $(this).css('background-color', 'rgb(225, 228, 254)');\r\n                    var input = $(this).children().next('.text');\r\n                    input.attr('disabled', true);\r\n                    input.css('font-weight', 'bold');\r\n                });\r\n\r\n                $('.course').each(function () {\r\n                    $(this).css('background-color', 'rgb(225, 228, 254)');\r\n                    var input = $(this).children().next('.text');\r\n                    input.attr('disabled', true);\r\n                    input.css('font-weight', 'bold');\r\n                    input.css('font-size', 16);\r\n                });\r\n\r\n                $('.header').children().each(function () {\r\n                    $(this).removeAttr('href');\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * @method deleteNoPilos\r\n             * @desc Removes every student who's not 'pilo'. IF the student is 'pilo' remove href attribute (link to other page)\r\n             * @param {array} pilos 'pilos' students to filtrate with the entry from DOM\r\n             * @return {void}\r\n             */\r\n            function deleteNoPilos(pilos) {\r\n                $(\"#user-grades\").children().children().each(function () {\r\n                    if ($(this).attr('data-uid') != undefined) {\r\n                        if (!isPilo($(this).attr('data-uid'), pilos)) {\r\n                            $(this).remove();\r\n                        } else {\r\n                            $(this).children('th').children().each(function () {\r\n                                $(this).removeAttr('href');\r\n                                $(this).click(function () {\r\n                                    var id = $(this).parent().parent().attr('data-uid');\r\n                                    var code = $('#idmoodle_' + id).attr('data-code');\r\n                                    var pagina = \"student_profile.php\";\r\n                                    var url = pagina + location.search + \"&student_code=\" + code;\r\n                                    //window.open(url, '_blank');\r\n                                });\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            /**\r\n             * @method isPilo\r\n             * @desc verifies if a student id is in an array of 'pilos'\r\n             * @param {integer} id \r\n             * @param {array} pilos \r\n             * @return {boolean} True if the student is 'pilo', false otherwise\r\n             */\r\n            function isPilo(id, pilos) {\r\n                for (var i = 0; i < pilos.length; i++) {\r\n                    if (pilos[i].split(\"_\")[1] === id) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n\r\n            /**\r\n             * @method getIDs\r\n             * @desc Returns an array of ids, belonging to students 'pilos'\r\n             * @return {array} array of students id\r\n             */\r\n            function getIDs() {\r\n                var pilos = new Array;\r\n                $(\"#students-pilos\").children().each(function () {\r\n                    pilos.push($(this).attr(\"id\"));\r\n                });\r\n                return pilos;\r\n            }\r\n\r\n            /**\r\n             * @method getCourseid\r\n             * @description Obtains the course id present on the url\r\n             * @return {integer} course id\r\n             */\r\n            function getCourseid() {\r\n                var informacionUrl = window.location.search.split(\"&\");\r\n                for (var i = 0; i < informacionUrl.length; i++) {\r\n                    var elemento = informacionUrl[i].split(\"=\");\r\n                    if (elemento[0] == \"?id_course\" || elemento[0] == \"id_course\") {\r\n                        var curso = elemento[1];\r\n                        return curso;\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n    };\r\n});\r\n\r\n"],"file":"global_grade_book.min.js"}