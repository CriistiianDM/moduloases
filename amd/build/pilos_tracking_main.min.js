define(["jquery","block_ases/Modernizr-v282","block_ases/bootstrap","block_ases/datatables","block_ases/sweetalert","block_ases/select2"],function(e,a,o,i,r,n){return{init:function(){var a=0,o="",i="";function r(){e(".dphpforms-peer-record").on("click",function(){var a,o,i=e(this).attr("data-record-id");a="seguimiento_pares",o=i,e.get("../managers/dphpforms/dphpforms_forms_core.php?form_id="+a+"&record_id="+o,function(a){e("#body_editor").html(""),e("#body_editor").append(a),e(".dphpforms.dphpforms-record.dphpforms-updater").append('<br><br><div class="div-observation col-xs-12 col-sm-12 col-md-12 col-lg-12 comentarios_vida_uni">Observaciones de Practicante/profesional:<br> <textarea id="observation_text" class="form-control " name="observation_text" maxlength="5000"></textarea><br><a id="send_observation" class="btn btn-sm btn-danger btn-dphpforms-univalle btn-dphpforms-send-observation">Enviar observación</a></div>'),e("button.btn.btn-sm.btn-danger.btn-dphpforms-univalle").attr("id","button"),e("#permissions_informationr").html("");var o=e(".dphpforms-record").find(".revisado_profesional").find(".checkbox").find("input[type=checkbox]").prop("checked"),i=e(".dphpforms-record").find(".revisado_practicante").find(".checkbox").find("input[type=checkbox]").prop("checked");(o||i)&&e(".dphpforms-record").find(".btn-dphpforms-delete-record").remove();for(var r=JSON.parse(e("#permissions_information").text()),n=0;n<r.behaviors_permissions.length;n++){for(var t=r.behaviors_permissions[n].behaviors[0],s=t.behaviors_accessibility,l=0;l<s.length;l++){var c=s[l].disabled;"true"==c?c=!0:"false"==c&&(c=!1),e(".dphpforms-record").find("#"+s[l].id).prop("disabled",c),e(".dphpforms-record").find("."+s[l].class).prop("disabled",c)}for(var p=t.behaviors_fields_to_remove,l=0;l<p.length;l++)e(".dphpforms-record").find("#"+p[l].id).remove(),e(".dphpforms-record").find("."+p[l].class).remove();for(var d=t.limpiar_to_eliminate,l=0;l<d.length;l++)e(".dphpforms-record").find("."+d[l].class+".limpiar ").remove()}e("#permissions_informationr").html("")}),e("#modal_v2_edit_peer_tracking").fadeIn(300)})}function n(){e('a[class*="practicant"]').click(function(){var a=e(this).attr("href").split("#practicant")[1],o=e(this).attr("href");e.ajax({type:"POST",data:{type:"get_practicants_of_professional",practicant_code:a,instance:y()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){e(o+" > div").empty(),e(o+" > div").append(a),t()},dataType:"json",cache:"false",error:function(e){swal({title:"Oops !",text:"Se presentó un inconveniente con el practicante seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function t(){e('a[class*="monitor"]').click(function(){var a=e(this).attr("href").split("#monitor")[1],o=e(this).attr("href");e.ajax({type:"POST",data:{type:"get_monitors_of_practicant",monitor_code:a,instance:y()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){e(o+" > div").empty(),e(o+" > div").append(a),s()},dataType:"json",cache:"false",error:function(e){swal({title:"Oops !",text:"Se presentó un inconveniente con el monitor seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function s(){e('a[class*="student"]').click(function(){console.log("student : "+e(this).attr("href").split("#student")[1]);var a=e(this).attr("href").split("#student")[1],o=e(this).attr("href");e.ajax({type:"POST",data:{type:"get_student_trackings",student_code:a,instance:i},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){e(o+" > div").empty(),e(o+" > div").append(a),r()},dataType:"json",cache:"false",error:function(e){swal({title:"Oops !",text:"Se presentó un inconveniente con el estudiante seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function l(a){var o=0;return e(a).find(".opcionesRadio").find("div").each(function(){e(this).find("label").find("input").is(":checked")&&(o=e(this).find("label").find("input").val())}),o}function c(o,i){e("#periodos").change(function(){if("sistemas"!=namerol){var l=e("#periodos").val(),c=a;e.ajax({type:"POST",data:{id_persona:c,id_semestre:l,instance:o,otro:!0,type:"consulta_sistemas"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){""==a?(e("#reemplazarToogle").html("<label> No se encontraron registros </label>"),p(i)):(e("#reemplazarToogle").html(a),s(),t(),n()),e(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").slideDown("slow"),p(i)},dataType:"text",cache:"false",error:function(e){alert("error al consultar seguimientos de personas")}}),r()}})}function p(a){var o=e("#periodos option:selected").text(),i="";if("monitor_ps"==a.namerol){var r=d(a);i='<div class="row"><div class="col-sm-12"><h2>Información monitor - PERIODO :'+o+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :<label for="revisado_monitor_0">'+r[0]+'</label><b></b> - NO Revisados :<label for="norevisado_monitor_0">'+r[1]+'</label><b></b> - Total  :<label for="total_monitor_0">'+r[2]+"</label> <b></b> </span></h4></div></div></div></div>",e("#conteo_principal").empty(),e("#conteo_principal").html(i)}else if("practicante_ps"==a.namerol){var n=d(a);i='<div class="row"><div class="col-sm-12"><h2>Información practicante - PERIODO :'+o+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :'+n[0]+" <b></b> - NO Revisados :"+n[1]+" <b></b> - Total  :"+n[2]+" <b></b> </span></h4></div></div></div></div>",e("#conteo_principal").empty(),e("#conteo_principal").html(i)}else if("profesional_ps"==a.namerol){var t=d(a);i='<div class="row"><div class="col-sm-12"><h2>Información profesional - PERIODO :'+o+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :'+t[0]+" <b></b> - NO Revisados :"+t[1]+" <b></b> - Total  :"+t[2]+" <b></b> </span></h4></div></div></div></div>",e("#conteo_principal").empty(),e("#conteo_principal").html(i)}else a.namerol}function d(a,o){void 0===o&&(o="ninguno");var i=[],r=0,n=0,t=0,s=0;if("monitor_ps"==a.namerol){var l=0,c=0;"ninguno"==o?(l=e(".panel-heading.pares").children().length,c=e(".panel-heading.grupal").children().length):(l=e("#collapse"+a.id+" .panel-heading.pares").children().length,c=e("#collapse"+a.id+" .panel-heading.grupal").children().length),e("label[for='norevisado_grupal_"+a.id+"']").html(c),e("label[for='total_grupal_"+a.id+"']").html(c);for(var p=0;p<l;p++)t+=Number(e("label[for='revisado_pares_"+a.id+"_"+p+"']").text()),s+=Number(e("label[for='norevisado_pares_"+a.id+"_"+p+"']").text());for(p=0;p<c;p++)r+=0,n=c;return total=t+r+(s+n),new Array(t+r,s+n,total)}if("practicante_ps"==a.namerol){var m=0;i=[0,0,0];var u=[];if("ninguno"==o){m=e(".panel-heading.practicante").children().length;for(var _=0;_<m;_++){var f=e(".panel-heading.practicante:eq("+_+")").find("a").attr("href").split("#collapse")[1];(v=[]).id=f,v.namerol="monitor_ps",u=d(v,"practicante"),e("label[for='revisado_monitor_"+f+"']").html(u[0]),e("label[for='norevisado_monitor_"+f+"']").html(u[1]),e("label[for='total_monitor_"+f+"']").html(u[2]),i[0]+=u[0],i[1]+=u[1],i[2]+=u[2]}}else{m=e("#collapse"+a.id+" .panel-heading.practicante").children().length;for(_=0;_<m;_++){var v;f=e("#collapse"+a.id+" .panel-heading.practicante:eq("+_+")").find("a").attr("href").split("#collapse")[1];(v=[]).id=f,v.namerol="monitor_ps",u=d(v,"practicante"),e("label[for='revisado_monitor_"+f+"']").html(u[0]),e("label[for='norevisado_monitor_"+f+"']").html(u[1]),e("label[for='total_monitor_"+f+"']").html(u[2]),i[0]+=u[0],i[1]+=u[1],i[2]+=u[2]}}return i}if("profesional_ps"==a.namerol){i=[0,0,0];for(var h=e(".panel-heading.profesional").children().length,g=[],b=0;b<h;b++){var k=e(".panel-heading.profesional:eq("+b+")").find("a").attr("href").split("#collapse")[1],y=[];y.id=k,y.namerol="practicante_ps",g=d(y,"practicante"),e("label[for='revisado_practicante_"+k+"']").html(g[0]),e("label[for='norevisado_practicante_"+k+"']").html(g[1]),e("label[for='total_practicante_"+k+"']").html(g[2]),i[0]+=g[0],i[1]+=g[1],i[2]+=g[2]}return i}}function m(a){e("body").on("click","#send_observation",function(){var o=e("form").serializeArray(),i={};e(o).each(function(e,a){i[a.name]=a.value});var r=i.id_registro,n=e("#observation_text");if(""==n.val())swal({title:"Para enviar una observación debe llenar el campo correspondiente",html:!0,type:"error",confirmButtonColor:"#d51b23"});else{var t=o[28].value,s=o[5].value,l=n.val(),c=e("#periodos").val();e.ajax({type:"POST",data:{id_tracking:r,type:"send_email_to_user",form:"new_form",tracking_type:"individual",monitor_code:t,date:s,message_to_send:l,semester:c,instance:a},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(e){console.log(e),"Error"!=e?(swal({title:"Correo enviado",html:!0,type:"success",confirmButtonColor:"#d51b23"}),n.val("")):swal({title:"error al enviar el correo al monitor",html:!0,type:"error",confirmButtonColor:"#d51b23"})},dataType:"text",cache:"false",error:function(e){swal({title:"error al enviar el correo",html:!0,type:"error",confirmButtonColor:"#d51b23"})}})}})}function u(a){e("body").on("click",".btn.btn-info.btn-lg.botonCorreo",function(){var a=e(this).attr("value"),o=e("#textarea_"+a);if(""==o.val())swal({title:"Para enviar una observación debe llenar el campo correspondiente",html:!0,type:"error",confirmButtonColor:"#d51b23"});else{var i=o.attr("name").split("_"),r=i[0],n=i[1],t=i[2],s=i[3],l=i[4],c=o.val();e.ajax({type:"POST",data:{type:"send_email_to_user",tipoSeg:r,codigoEnviarN1:n,codigoEnviarN2:t,fecha:s,nombre:l,message:c},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(e){"Error"!=e?(swal({title:"Correo enviado",html:!0,type:"success",confirmButtonColor:"#d51b23"}),o.val("")):swal({title:"error al enviar el correo al monitor",html:!0,type:"error",confirmButtonColor:"#d51b23"})},dataType:"text",cache:"false",error:function(e){swal({title:"error al enviar el correo",html:!0,type:"error",confirmButtonColor:"#d51b23"})}})}})}function _(a){e("body").on("click","span.btn.btn-info.btn-lg.botonModificarSeguimiento",function(){var o=e(this).attr("value"),i="",r="",n=document.getElementById("h_ini_"+o),t=document.getElementById("h_fin_"+o),s=document.getElementById("m_ini_"+o),l=document.getElementById("m_fin_"+o),c=n.options[n.selectedIndex].text,p=t.options[t.selectedIndex].text,d=s.options[s.selectedIndex].text,m=l.options[l.selectedIndex].text,u=function(e,a,o,i){var r="";e>a?r+="* La hora final debe ser mayor a la inicial<br>":e==a&&(o>i?(isvalid=!1,r+="* La hora final debe ser mayor a la inicial<br>"):o==i&&(r+="* Las horas seleccionadas deben ser diferentes<br>"));return r}(c,p,d,m);if(function(a,o){var i=new Array,r=new Array,n=e("input:radio[name=riesgo_individual_"+a+"]:checked").val(),t=e("input:radio[name=riesgo_familiar_"+a+"]:checked").val(),s=e("input:radio[name=riesgo_academico_"+a+"]:checked").val(),l=e("input:radio[name=riesgo_economico_"+a+"]:checked").val(),c=e("input:radio[name=riesgo_universitario_"+a+"]:checked").val();"3"==n&&(i.push("Individual"),r.push(e("#obindividual_"+a).val()));"3"==t&&(i.push("Familiar"),r.push(e("#obfamiliar_"+a).val()));"3"==s&&(i.push("Académico"),r.push(e("#obacademico_"+a).val()));"3"==l&&(i.push("Económico"),r.push(e("#obeconomico_"+a).val()));"3"==c&&(i.push("Vida universitaria"),r.push(e("#obuniversitario_"+a).val()));var p=new Array;p.push({name:"function",value:"send_email"}),p.push({name:"id_student_moodle",value:o}),p.push({name:"id_student_pilos",value:a}),p.push({name:"risk_array",value:i}),p.push({name:"observations_array",value:r}),p.push({name:"date",value:e("#fecha_"+a).val()}),p.push({name:"url",value:window.location}),0!=i.length&&e.ajax({type:"POST",data:p,url:"../managers/pilos_tracking/send_risk_email.php",success:function(e){console.log(e)},dataType:"text",cache:"false",error:function(e){console.log(e)}})}(o,a),""==u){i=e("#profesional_"+o).is(":checked")?1:0,r=e("#practicante_"+o).is(":checked")?1:0;var _=e(this).parent().parent().parent(),f=e(this).attr("value"),v=_.find("#lugar_"+f).val(),h=_.find("#tema_"+o).val(),g=_.find("#objetivos_"+o).val(),b=_.find("#fecha_"+o).val(),k=c+":"+d,y=p+":"+m,w=_.find("#obindividual_"+o).val(),x=e("input[name='riesgo_individual_"+o+"']:checked").val();void 0==x&&(x="0");var C=_.find("#obfamiliar_"+o).val(),T=e("input[name='riesgo_familiar_"+o+"']:checked").val();void 0==T&&(T="0");var O=_.find("#obacademico_"+o).val(),S=e("input[name='riesgo_academico_"+o+"']:checked").val();void 0==S&&(S="0");var B=_.find("#obeconomico_"+o).val(),j=e("input[name='riesgo_economico_"+o+"']:checked").val();void 0==j&&(j="0");var I=_.find("#obuniversitario_"+o).val(),P=e("input[name='riesgo_universitario_"+o+"']:checked").val();void 0==P&&(P="0");var N=_.find("#observacionesGeneral_"+o).val();if(""==v||""==h||""==g)swal({title:"Debe ingresar los datos completamente",html:!0,type:"warning",confirmButtonColor:"#d51b23"});else if(""!=w&&0==x||""!=C&&0==T||""!=O&&0==S||""!=B&&0==j||""!=I&&0==P||""==w&&x>0||""==C&&T>0||""==O&&S>0||""==B&&j>0||""==I&&P>0)swal({title:"Debe ingresar correctamente los riesgos",html:!0,type:"warning",confirmButtonColor:"#d51b23"});else{var E=new Object;E.id=f,E.lugar=v,E.tema=h,E.objetivos=g,E.individual=w,E.individual_riesgo=x,E.familiar_desc=C,E.familiar_riesgo=T,E.academico=O,E.academico_riesgo=S,E.economico=B,E.economico_riesgo=j,E.vida_uni=I,E.vida_uni_riesgo=P,E.observaciones=N,E.revisado_practicante=r,E.revisado_profesional=i,E.fecha=b,E.hora_ini=k,E.hora_fin=y,e.ajax({type:"POST",data:{seguimiento:E,type:"actualizar_registro"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(e){"0"==e?swal({title:"error al actualizar registro",html:!0,type:"error",confirmButtonColor:"#d51b23"}):"1"==e?swal("¡Hecho!","El registro ha sido actualizado","success"):swal({title:"Debe ingresar correctamente los riesgos",html:!0,type:"warning",confirmButtonColor:"#d51b23"})},error:function(e){}})}}else swal({title:u,html:!0,type:"warning",confirmButtonColor:"#d51b23"})})}function f(a){e("body").on("click","span.btn-info.btn-lg.botonesSeguimiento.botonEditarSeguimiento",function(){var o=e(this).attr("value"),i=e(this).parent().parent().parent(),r=!1;"monitor_ps"==a?r=e("#profesional_"+o).is(":checked"):"practicante_ps"==a?e("input[name=practicante]").prop("disabled",!1):"profesional_ps"==a?e("input[name=profesional]").prop("disabled",!1):"sistemas"==a&&(e("input[name=profesional]").prop("disabled",!1),e("input[name=practicante]").prop("disabled",!1)),0==r?(i.find(".editable").removeAttr("readonly"),i.find(".botonesSeguimiento").toggleClass("ocultar"),i.find(".quitar-ocultar").toggleClass("ocultar"),i.find(".radio-ocultar").toggleClass("ocultar"),function(a){e("#borrar_"+a).hide(),e("#editar_"+a).hide(),e("#enviar_"+a).hide(),e("#hora_final_"+a).hide(),e("#hora_inicial_"+a).hide(),e("#titulo_fecha_"+a).show(),e("#mod_hora_final_"+a).show(),e("#mod_hora_ini_"+a).show();var o=e("#h_inicial_texto_"+a).val(),i=e("#h_final_texto_"+a).val(),r=o.split(":"),n=i.split(":");(function(a){for(var o=new Date,i=o.getMinutes(),r=o.getHours(),n="",t=0;t<24;t++)t==r?(r<10&&(r="0"+r),n+='<option value="'+r+'" selected>'+r+"</option>"):n+=t<10?'<option value="0'+t+'">0'+t+"</option>":'<option value="'+t+'">'+t+"</option>";for(var s="",t=0;t<60;t++)t==i?(i<10&&(i="0"+i),s+='<option value="'+i+'" selected>'+i+"</option>"):s+=t<10?'<option value="0'+t+'">0'+t+"</option>":'<option value="'+t+'">'+t+"</option>";e("#h_ini_"+a).append(n),e("#m_ini_"+a).append(s),e("#h_fin_"+a).append(n),e("#m_fin_"+a).append(s),e("#seguimiento #m_fin").append(s)})(a),e("#h_ini_"+a+" option[value="+r[0]+"]").prop("selected",!0),e("#m_ini_"+a+" option[value="+r[1]+"]").prop("selected",!0),e("#h_fin_"+a+" option[value="+n[0]+"]").prop("selected",!0),e("#m_fin_"+a+" option[value="+n[1]+"]").prop("selected",!0)}(o),function(a){e("#riesgo_individual_"+a).is(".riesgo_bajo")?e("input[name=riesgo_individual_"+a+"][value=1]").prop("checked","checked"):e("#riesgo_individual_"+a).is(".riesgo_medio")?e("input[name=riesgo_individual_"+a+"][value=2]").prop("checked","checked"):e("#riesgo_individual_"+a).is(".riesgo_alto")?e("input[name=riesgo_individual_"+a+"][value=3]").prop("checked","checked"):e("input[name=riesgo_individual_"+a+"][value=0]").prop("checked","checked");e("#riesgo_familiar_"+a).is(".riesgo_bajo")?e("input[name=riesgo_familiar_"+a+"][value=1]").prop("checked","checked"):e("#riesgo_familiar_"+a).is(".riesgo_medio")?e("input[name=riesgo_familiar_"+a+"][value=2]").prop("checked","checked"):e("#riesgo_familiar_"+a).is(".riesgo_alto")?e("input[name=riesgo_familiar_"+a+"][value=3]").prop("checked","checked"):e("input[name=riesgo_familiar_"+a+"][value=0]").prop("checked","checked");e("#riesgo_academico_"+a).is(".riesgo_bajo")?e("input[name=riesgo_academico_"+a+"][value=1]").prop("checked","checked"):e("#riesgo_academico_"+a).is(".riesgo_medio")?e("input[name=riesgo_academico_"+a+"][value=2]").prop("checked","checked"):e("#riesgo_academico_"+a).is(".riesgo_alto")?e("input[name=riesgo_academico_"+a+"][value=3]").prop("checked","checked"):e("input[name=riesgo_academico_"+a+"][value=0]").prop("checked","checked");e("#riesgo_economico_"+a).is(".riesgo_bajo")?e("input[name=riesgo_economico_"+a+"][value=1]").prop("checked","checked"):e("#riesgo_economico_"+a).is(".riesgo_medio")?e("input[name=riesgo_economico_"+a+"][value=2]").prop("checked","checked"):e("#riesgo_economico_"+a).is(".riesgo_alto")?e("input[name=riesgo_economico_"+a+"][value=3]").prop("checked","checked"):e("input[name=riesgo_economico_"+a+"][value=0]").prop("checked","checked");e("#riesgo_universitario_"+a).is(".riesgo_bajo")?e("input[name=riesgo_universitario_"+a+"][value=1]").prop("checked","checked"):e("#riesgo_universitario_"+a).is(".riesgo_medio")?e("input[name=riesgo_universitario_"+a+"][value=2]").prop("checked","checked"):e("#riesgo_universitario_"+a).is(".riesgo_alto")?e("input[name=riesgo_universitario_"+a+"][value=3]").prop("checked","checked"):e("input[name=riesgo_universitario_"+a+"][value=0]").prop("checked","checked")}(o)):swal("¡Advertencia!","No es posible editar el seguimiento, debido a que ya ha sido revisado por un profesional","warning")})}function v(o){e("body").on("click","span.btn.btn-info.btn-lg.botonBorrar",function(){var i=e(this).attr("value"),r=!1;"monitor_ps"==o&&(r=e("#profesional_"+a).is(":checked")),0==r&&swal({title:"¿Seguro que desea eliminar el registro?",text:"No podrás deshacer este paso",type:"warning",showCancelButton:!0,cancelButtonText:"No",confirmButtonColor:"#d51b23",confirmButtonText:"Si",closeOnConfirm:!1},function(){e.ajax({type:"POST",data:{id:i,type:"eliminar_registro"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(e){swal({title:e.title,html:!0,text:e.msg,type:e.type,confirmButtonColor:"#d51b23"}),setTimeout("document.location.reload()",500)},dataType:"json",cache:"false",error:function(e){}})})})}function h(a){e("body").on("click","span.btn.btn-info.btn-lg.botonesSeguimiento.botonCancelarSeguimiento",function(){var o=e(this).attr("value");"monitor_ps"==a||("practicante_ps"==a?e("input[name=practicante]").prop("disabled",!0):"profesional_ps"==a?e("input[name=profesional]").prop("disabled",!0):"sistemas"==a&&(e("input[name=profesional]").prop("disabled",!0),e("input[name=practicante]").prop("disabled",!0)));var i,r=e(this).parent().parent().parent();r.find(".editable").attr("readonly",!0),r.find(".botonesSeguimiento").toggleClass("ocultar"),r.find(".quitar-ocultar").toggleClass("ocultar"),r.find(".radio-ocultar").toggleClass("ocultar"),e("#titulo_fecha_"+(i=o)).hide(),e("#borrar_"+i).show(),e("#editar_"+i).show(),e("#enviar_"+i).show(),e("#hora_final_"+i).show(),e("#mod_hora_final_"+i).hide(),e("#hora_inicial_"+i).show(),e("#mod_hora_ini_"+i).hide()})}function g(){e("body").on("click",".limpiar",function(){var a=e(this).closest("div").attr("id").split("_"),o=a[2].split("div").pop();switch(a[1]){case"individual":e("#obindividual_"+o).val(""),k("riesgo_individual_",o);break;case"familiar":e("#obfamiliar_"+o).val(""),k("riesgo_familiar_",o);break;case"academico":e("#obacademico_"+o).val(""),k("riesgo_academico_",o);break;case"economico":e("#obeconomico_"+o).val(""),k("riesgo_economico_",o);break;case"universitario":e("#obuniversitario_"+o).val(""),k("riesgo_universitario_",o);break;default:e(this).parent().find(".opcionesRadio").find("div").each(function(){e(this).find("label").find("input").prop("checked",!1)})}})}function b(){e(document).ready(function(){e("input:radio").change(function(){var a=e(this).parent().parent().parent().attr("id"),o=e(this).attr("value");1==o?(e("#"+a).removeClass(),e("#"+a).addClass("table-info-pilos col-sm-12 riesgo_bajo")):2==o?(e("#"+a).removeClass(),e("#"+a).addClass("table-info-pilos col-sm-12 riesgo_medio")):3==o&&(e("#"+a).removeClass(),e("#"+a).addClass("table-info-pilos col-sm-12 riesgo_alto"))})})}function k(a,o){e("input:radio[name="+a+o+"]").parent().parent().parent().removeClass("riesgo_bajo"),e("input:radio[name="+a+o+"]").parent().parent().parent().removeClass("riesgo_medio"),e("input:radio[name="+a+o+"]").parent().parent().parent().removeClass("riesgo_alto");var i='"'+a.replace("#","")+o+'"';e("input:radio[name="+i+"]").each(function(e){this.checked=!1})}function y(){for(var e=window.location.search.split("&"),a=0;a<e.length;a++){var o=e[a].split("=");if("?instanceid"==o[0]||"instanceid"==o[0])var i=o[1]}return i}e(document).ready(function(){e(".se-pre-con").fadeOut("slow"),e("#reemplazarToogle").fadeIn("slow");for(var i="",l=window.location.search.split("&"),d=0;d<l.length;d++){var k=l[d].split("=");if("?instanceid"==k[0]||"instanceid"==k[0])var y=k[1]}var w,x,C;e.ajax({type:"POST",data:{type:"getInfo",instance:y},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(i){$data=e.parseJSON(i),o=$data.username,a=$data.id,$data.email,$data.rol,namerol=$data.name_rol},dataType:"text",cache:"false",error:function(e){swal({title:"error al obtener información del usuario, getInfo.",html:!0,type:"error",confirmButtonColor:"#d51b23"})}}),o="","monitor_ps"==namerol?i="monitor":"practicante_ps"==namerol?i="practicante":"profesional_ps"==namerol?i="profesional":"sistemas"==namerol&&(i="sistemas"),(i=[]).id=a,i.name=o,i.namerol=namerol,p(i),"practicante_ps"==namerol?(e("input[name=profesional]").prop("disabled",!0),e("input[name=practicante]").prop("disabled",!0),g(),f(namerol),h(namerol),v(namerol),_(a),b(),u(y),c(y,i),m(y)):"profesional_ps"==namerol?(e("input[name=practicante]").prop("disabled",!0),e("input[name=profesional]").prop("disabled",!0),g(),h(namerol),f(namerol),_(a),v(namerol),b(),u(y),c(y,i),m(y)):"monitor_ps"==namerol?(g(),f(namerol),h(namerol),v(namerol),_(a),b(),c(y,i)):"sistemas"==namerol&&(g(),f(namerol),h(namerol),v(namerol),_(a),b(),u(y),w=y,e("#personas").val("").change(),e("#personas").select2({placeholder:"Seleccionar persona",language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando.."}}}),e("#periodos").select2({language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando.."}}}),x=w,C=namerol,e("#periodos").change(function(){var a=e("#periodos").val();e.ajax({type:"POST",data:{id:a,instance:x,type:"actualizar_personas"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){e("#personas").empty(),e("#personas").select2({placeholder:"Seleccionar persona",language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando.."}}}),"sistemas"==C&&(e("#personas").attr("selectedIndex","-1").find("option:selected").removeAttr("selected"),e("#personas").append('<option value="">Seleccionar persona</option>'+a))},dataType:"text",cache:"false",error:function(e){alert("error al cargar personas")}})}),e("#consultar_persona").on("click",function(){var a=e("#personas").children(":selected").attr("value"),o=e("#periodos").children(":selected").attr("value");void 0==a?swal({title:"Debe escoger una persona para realizar la consulta",html:!0,type:"warning",confirmButtonColor:"#d51b23"}):(e(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").show(),e(".se-pre-con").show(),e("#reemplazarToogle").hide(),e.ajax({type:"POST",data:{id_persona:a,id_semestre:o,instance:w,type:"consulta_sistemas"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function(a){""==a?e("#reemplazarToogle").html("<label> No se encontraron registros </label>"):(e("#reemplazarToogle").html(a),e("input[name=practicante]").prop("disabled",!0),e("input[name=profesional]").prop("disabled",!0)),s(),t(),n(),e(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").slideDown("slow")},dataType:"text",cache:"false",error:function(e){alert("error al consultar seguimientos de personas")},complete:function(){e(".se-pre-con").hide(),e("#reemplazarToogle").fadeIn()}}),r())}),m(y))}),s(),t(),n(),e(document).on("click",".dphpforms > #button",function(a){a.preventDefault();new FormData(this);var o=e(this).parent(),i=o.attr("action");"procesador.php"==o.attr("action")&&(i="../managers/dphpforms/procesador.php"),e.ajax({type:"POST",url:i,data:e("form.dphpforms").serialize(),dataType:"json",success:function(a){var o=a;if(0==o.status){var i="";"Stored"==o.message?i="Almacenado":"Updated"==o.message&&(i="Actualizado"),function(a){var o=l(".puntuacion_riesgo_individual"),i=e(".comentarios_individual").find("textarea").val(),r=l(".puntuacion_riesgo_familiar"),n=e(".comentarios_familiar").find("textarea").val(),t=l(".puntuacion_riesgo_academico"),s=e(".comentarios_academico").find("textarea").val(),c=l(".puntuacion_riesgo_economico"),p=e(".comentarios_economico").find("textarea").val(),d=l(".puntuacion_vida_uni"),m=e(".comentarios_vida_uni").find("textarea").val();if("3"==o||"3"==r||"3"==t||"3"==c||"3"==d){var u={function:"send_email_dphpforms",student_code:get_student_code(),risks:[{name:"Individual",risk_lvl:o,observation:i},{name:"Familiar",risk_lvl:r,observation:n},{name:"Académico",risk_lvl:t,observation:s},{name:"Económico",risk_lvl:c,observation:p},{name:"Vida Universitaria",risk_lvl:d,observation:m}],date:e(".fecha").find("input").val(),url:window.location.href};e.ajax({type:"POST",data:JSON.stringify(u),url:"../managers/pilos_tracking/send_risk_email.php",success:function(e){console.log(e)},dataType:"text",cache:"false",error:function(e){console.log(e)}})}}(),swal({title:"Información",text:i,type:"success"},function(){"Updated"==o.message&&e("#dphpforms-peer-record-"+e("#dphpforms_record_id").val()).stop().animate({backgroundColor:"rgb(175, 255, 173)"},400).animate({backgroundColor:"#f5f5f5"},4e3)}),e(".dphpforms-response").trigger("reset"),e("#modal_v2_edit_peer_tracking").fadeOut(300),e("#modal_v2_peer_tracking").fadeOut(300)}else if(-2==o.status){i="";"Without changes"==o.message?i="No hay cambios que registrar":"Unfulfilled rules"==o.message&&(i="Revise los valores ingresados"),swal("Alerta",i,"warning")}else-1==o.status&&swal("ERROR!","Oops!, informe de este error","error")},error:function(e){swal("Error!","Oops!, informe de este error","error")}})}),e(".mymodal-close").click(function(){e(this).parent().parent().parent().parent().fadeOut(300)})}}});