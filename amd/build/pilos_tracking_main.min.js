define ("block_ases/pilos_tracking_main",["jquery","block_ases/Modernizr-v282","block_ases/bootstrap","block_ases/jquery.dataTables","block_ases/sweetalert","block_ases/select2","block_ases/loading_indicator"],function(a,b,c,d,e,f,g){return{init:function init(){var n=[],o=0,p="",q="",r=parseInt(a("#current_ases_semester").data("info"));a("#msg-cache").click(function(){swal({title:"\xA1Informaci\xF3n!",text:"Est\xE1 observando una versi\xF3n reciente del conteo, m\xE1s no una versi\xF3n en vivo. El conteo se actualizar\xE1 en un intervalo de tiempo no mayor a 30 minutos.",type:"info"})});function b(b,c,d,e){var f="get_tracking_count";if(e){f="get_tracking_count_student"}g.show();a.ajax({type:"POST",data:JSON.stringify({function:f,params:[b,c,d]}),url:"../managers/pilos_tracking/v2/pilos_tracking_api.php",dataType:"json",cache:"false",success:function success(b){g.hide();for(var c=b.data_response,d=0,e=0,f=0,h=0,j=0,k=0,l=0;l<c.length;l++){d=c[l].count.revisado_profesional+c[l].count.not_revisado_profesional;e=c[l].count.not_revisado_profesional;f=c[l].count.not_revisado_practicante;h=c[l].count.in_revisado_profesional+c[l].count.in_not_revisado_profesional;j=c[l].count.in_not_revisado_profesional;k=c[l].count.in_not_revisado_practicante;var m="                                <div class=\"conteo\">                                    <div class=\"row\">                                         <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             Fichas: <strong>"+d+"</strong>                                        </div>                                        <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             <div class=\"pend-prof\">Pendientes Prof: </div>"+e+"                                        </div>                                        <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             <div class=\"pend-pract\">Pendientes pract: </div>"+f+"                                        </div>                                    </div>                                    <div class=\"row\">                                         <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             Inasistencias: <strong>"+h+"</strong>                                        </div>                                        <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             <div class=\"pend-prof\">Pendientes Prof: </div>"+j+"                                        </div>                                        <div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-4\">                                             <div class=\"pend-pract\">Pendientes pract: </div>"+k+"                                        </div>                                    </div>                                </div>                            ";a("#counting_"+c[l].username).find(".loader").html(m)}},error:function error(a){g.hide();console.log(a);swal({title:"Error!",text:"",html:!0,type:"error",confirmButtonColor:"#d51b23"})}})}a(document).on("click",".btn-dphpforms-close",function(){a(this).closest("div[class=\"mymodal\"]").fadeOut(300)});a(".outside").click(function(){var b=a(this);swal({title:"Confirmaci\xF3n de salida",text:"",type:"warning",showCancelButton:!0,confirmButtonText:"Salir"},function(c){if(c){a(b).parent(".mymodal").fadeOut(300)}})});a(document).ready(function(){a(".se-pre-con").fadeOut("slow");a("#reemplazarToogle").fadeIn("slow");var d="";g.show();a.ajax({type:"POST",data:{type:"getInfo",instance:m()},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(b){g.hide();$data=a.parseJSON(b);p=$data.username;d=$data.username;o=$data.id;$data.email;$data.rol;q=$data.name_rol},dataType:"text",cache:"false",error:function error(){g.hide();swal({title:"error al obtener informaci\xF3n del usuario, getInfo.",html:!0,type:"error",confirmButtonColor:"#d51b23"})}});p="";var e=[];e.id=o;e.name=p;e.namerol=q;c(e);if("practicante_ps"==q){b(d,r,parseInt(m()),!1);i(m(),e,d);k(m())}else if("profesional_ps"==q){b(d,r,parseInt(m()),!1);i(m(),e,d);k(m())}else if("monitor_ps"==q){b(d,r,parseInt(m()),!0);i(m(),e,d);k(m())}else if("sistemas"==q){j(m());k(m())}});a(".mymodal-close").click(function(){a(this).parent().parent().parent().parent().fadeOut(300)});function c(b){a("#general_rev_pro").html("*");a("#general_rev_prac").html("*");a("#general_not_rev_pro").html("*");a("#general_not_rev_prac").html("*");a("#general_pro_t").html("*");a("#general_prac_t").html("*");a("#general_in_rev_pro").html("*");a("#general_in_rev_prac").html("*");a("#general_in_not_rev_pro").html("*");a("#general_in_not_rev_prac").html("*");a("#general_in_pro_t").html("*");a("#general_in_prac_t").html("*");g.show();a.ajax({type:"POST",data:{type:"user_specific_counting",user:b,instance:m()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!0,dataType:"json",cache:"false",success:function success(b){g.hide();a("#general_rev_pro").html(b.revisado_profesional);a("#general_rev_prac").html(b.revisado_practicante);a("#general_not_rev_pro").html(b.not_revisado_profesional);a("#general_not_rev_prac").html(b.not_revisado_practicante);a("#general_pro_t").html(b.total_profesional);a("#general_prac_t").html(b.total_practicante);a("#general_in_rev_pro").html(b.in_revisado_profesional);a("#general_in_rev_prac").html(b.in_revisado_practicante);a("#general_in_not_rev_pro").html(b.in_not_revisado_profesional);a("#general_in_not_rev_prac").html(b.in_not_revisado_practicante);a("#general_in_pro_t").html(b.in_total_profesional);a("#general_in_prac_t").html(b.in_total_practicante)},error:function error(){g.hide()}})}h();e();d();f();function d(){a("a[class*=\"practicant\"]").click(function(){var c=a(this).data("username");if(-1==n.indexOf(c)){n.push(c)}else{return}var d=a(this).attr("href").split("#practicant")[1],h=a(this).attr("href");g.show();a.ajax({type:"POST",data:{type:"get_practicants_of_professional",practicant_code:d,instance:m()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!0,dataType:"json",cache:"false",success:function success(c){g.hide();a(h+" > div").empty();a(h+" > div").append(c.render);c.counting;b(d,r,parseInt(m()),!1);e();f()},error:function error(){g.hide();swal({title:"Oops !",text:"Se present\xF3 un inconveniente con el practicante seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function e(){a("a[class*=\"monitor\"]").click(function(){var c=a(this).data("username");if(-1==n.indexOf(c)){n.push(c)}else{return}var d=a(this).attr("href").split("#monitor")[1],e=a(this).attr("href");g.show();a.ajax({type:"POST",data:{type:"get_monitors_of_practicant",monitor_code:d,instance:m()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!0,dataType:"json",cache:"false",success:function success(c){g.hide();a(e+" > div").empty();a(e+" > div").append(c);b(d,r,parseInt(m()),!0);h();f()},error:function error(){g.hide();swal({title:"Oops !",text:"Se present\xF3 un inconveniente con el monitor seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function f(){a("a[class*=\"groupal\"]").click(function(){var b=a(this).attr("href").split("#groupal")[1],c=a(this).attr("href");g.show();a.ajax({type:"POST",data:{type:"get_groupal_trackings",student_code:b,instance:m()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(b){g.hide();a(c+" > div").empty();a(c+" > div").append(b)},dataType:"json",cache:"false",error:function error(){g.hide();swal({title:"Oops !",text:"Se present\xF3 un inconveniente con los seguimientos grupales seleccionados.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function h(){a("a[class*=\"student\"]").click(function(){var b=a(this).data("username");if(-1==n.indexOf(b)){n.push(b)}else{return}var c=a(this).attr("href").split("#student")[1],d=a(this).attr("href");g.show();a.ajax({type:"POST",data:{type:"get_student_trackings",student_code:c,instance:m()},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(b){g.hide();a(d+" > div").empty();a(d+" > div").append(b)},dataType:"json",cache:"false",error:function error(){g.hide();swal({title:"Oops !",text:"Se present\xF3 un inconveniente con el estudiante seleccionado.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})});a(".see_history").unbind().click(function(){var b=a(this).parents().eq(3).attr("href").split("#monitor")[1];g.show();a.ajax({type:"POST",data:{type:"redirect_tracking_time_control",monitor:b},url:"../managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(a){g.hide();var b=window.location.href,c=b.replace("report_trackings","tracking_time_control");try{var d=window.open(c+"&&monitorid="+a,"_blank");if(d){d.focus()}}catch(a){alert("Se ha producido un error al abrir la ventana : "+a)}},dataType:"json",cache:"false",error:function error(){g.hide();swal({title:"Oops !",text:"Se present\xF3 un inconveniente al reedirecionar al reporte de horas.",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}})})}function i(c,i,j){a("#periodos").change(function(){if("sistemas"!=q){var i=a("#periodos").val(),k=o;g.show();a.ajax({type:"POST",data:{id_persona:k,id_semestre:i,instance:c,otro:!0,type:"consulta_sistemas"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",dataType:"text",cache:"false",success:function success(c){g.hide();if(""==c){a("#reemplazarToogle").html("<label> No se encontraron registros </label>")}else{a("#reemplazarToogle").html(c);h();e();d();f()}a(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").slideDown("slow");b(j,i,parseInt(m()),!1)},error:function error(){g.hide();swal("ERROR!","Oops!, Se present\xF3 un error al consultar seguimientos de personas","error")}})}})}function j(i){a("#personas").val("").change();a("#personas").select2({placeholder:"Seleccionar persona",language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando.."}}});a("#periodos").select2({language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando.."}}});l(i,q);a("#consultar_persona").on("click",function(){var i=a("#personas").children(":selected").attr("value"),j=a("#periodos").children(":selected").attr("value"),k=a("#personas").children(":selected").data("username");n=[];if(i==void 0){swal({title:"Debe escoger una persona para realizar la consulta",html:!0,type:"warning",confirmButtonColor:"#d51b23"})}else{a(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").show();a(".se-pre-con").show();a("#reemplazarToogle").hide();g.show();a.ajax({type:"POST",data:{id_persona:i,id_semestre:j,instance:m(),type:"consulta_sistemas"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",dataType:"text",cache:"false",success:function success(l){g.hide();if(""==l){a("#reemplazarToogle").html("<label> No se encontraron registros </label>")}else{a("#reemplazarToogle").html(l);a("input[name=practicante]").prop("disabled",!0);a("input[name=profesional]").prop("disabled",!0)}c(i);h();e();d();f();a(".well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto").slideDown("slow");b(k,j,parseInt(m()),!1)},error:function error(){g.hide();swal("ERROR!","Oops!, Se present\xF3 un error al cargar seguimientos de personas","error")},complete:function complete(){a(".se-pre-con").hide();a("#reemplazarToogle").fadeIn()}})}})}function k(b){a("body").on("click","#send_observation",function(){var c=a("form").serializeArray(),d={};a(c).each(function(a,b){d[b.name]=b.value});var e=d.id_registro,f=a("#observation_text");if(""==f.val()){swal({title:"Para enviar una observaci\xF3n debe llenar el campo correspondiente.",html:!0,type:"error",confirmButtonColor:"#d51b23"})}else{var h="individual",i=a(".id_creado_por").find("input").val();if(i==void 0){i=a(".in_id_creado_por").find("input").val();h="individual_inasistencia"}var j=a(".fecha").find("input").val();if(j==void 0){j=a(".in_fecha").find("input").val()}var k=f.val(),l=a("#periodos").val(),m=a(".lugar").find("input").val();if(m==void 0){m=a(".in_lugar").find("input").val()}var n=a("#dphpforms_block_courseid").data("info");g.show();a.ajax({type:"POST",data:{id_tracking:e,type:"send_email_to_user",form:"new_form",tracking_type:h,monitor_code:i,date:j,message_to_send:k,semester:l,instance:b,place:m,courseid:n},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(a){g.hide();if("Error"!=a){swal({title:"Correo enviado",html:!0,type:"success",confirmButtonColor:"#d51b23"});f.val("")}else{console.log("mensaje error : ");console.log(a);swal({title:"error al enviar el correo al monitor",html:!0,type:"error",confirmButtonColor:"#d51b23"})}},dataType:"text",cache:"false",error:function error(a){g.hide();console.log("mensaje error : ");console.log(a);swal("ERROR!","Oops!, Se present\xF3 un error al enviar el correo","error")}})}})}function l(b,c){a("#periodos").change(function(){var d=a("#periodos").val();g.show();a.ajax({type:"POST",data:{id:d,instance:b,type:"update_people"},url:"../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php",async:!1,success:function success(b){g.hide();a("#personas").empty();a("#personas").select2({placeholder:"Seleccionar persona",language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando.."}}});if("sistemas"==c){a("#personas").attr("selectedIndex","-1").find("option:selected").removeAttr("selected");a("#personas").append("<option value=\"\">Seleccionar persona</option>"+b)}},dataType:"text",cache:"false",error:function error(){g.hide();swal("ERROR!","Oops!, Se present\xF3 un error al cargar personas","error")}})})}function m(){for(var a=window.location.search.split("&"),b=0,c;b<a.length;b++){c=a[b].split("=");if("?instanceid"==c[0]||"instanceid"==c[0]){var d=c[1]}}return d}}}});
//# sourceMappingURL=pilos_tracking_main.min.js.map
