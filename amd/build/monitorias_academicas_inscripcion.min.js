define(["jquery","block_ases/_general_modal_manager","block_ases/loading_indicator","block_ases/sweetalert"],function(a,i,n,e){var o={};return{set_user:(a,i,n)=>o={id:a,email:i,phone:n},p:()=>console.log(o),init:function(){this.p(),n.show(),a(".link_inscripcion_monitoria").click(function(e){e.preventDefault(),o.phone?(n.show(),a.when(a.ajax({type:"POST",data:JSON.stringify({function:"get_proxima_sesion_de_monitoria",params:e.target.id}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",error:function(i){a("#debug").html(i)}})).done(r=>{let t=a("#content-modal-inscripcion").html();i.generate_modal("modal_fomulario_inscripcion","Inscribirse a monitoría",t,null,function(){n.hide(),i.show_modal(".modal_fomulario_inscripcion"),a(".modal_fomulario_inscripcion").find(".general_modal_content").addClass("w-50"),a(".modal_fomulario_inscripcion").find("#monitoria").val(e.target.innerHTML),a(".modal_fomulario_inscripcion").find("#fecha-monitoria").val(r.message.fecha_legible),a(".modal_fomulario_inscripcion").find("#cancelar-inscripcion-btn").click(()=>{a(".general_modal_close").first().click()}),a(".modal_fomulario_inscripcion").find("#form-inscripcion").submit(function(i){i.preventDefault(),n.show();let e=r.message.id,t=o.id,c=a(".modal_fomulario_inscripcion").find("#asignatura").val(),l=a(".modal_fomulario_inscripcion").find("#tematica").val();a.ajax({type:"POST",data:JSON.stringify({function:"anadir_asistente_a_sesion_de_monitoria",params:[e,t,c,l]}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",success:function(i){n.hide(),a(".general_modal_close").first().click(),0==i.status_code?swal({title:"Inscripción correcta!",text:"Gracias por inscribirte. Serás contactado por el monitor encargado el día de la monitoría para concretar los detalles.",icon:"success"},function(a){location.reload()}):(swal("Error!","Oops!: "+i.data_response,"error"),console.log(i))},error:function(i){console.log("Error de inscripción a monitoria en BD"),a("#debug").html(i.responseText)}})})})})):swal({title:"Por favor, ingresa tu número celular",text:'Antes de inscribirte a una monitoría requerimos que ingreses tu número de telefono celular. Puedes hacerlo en la sección "Tus datos de contacto" de abajo.',icon:"warning"})}),a(".eliminar-inscripcion").click(function(i){let n=a(i.target).parent().parent().find("td");swal({title:"Cancelar asistencia",text:"¿Deseas desinscribirte de la monitoría de "+n[3].innerHTML+" programada el "+n[0].innerHTML+" "+n[1].innerHTML+" "+n[2].innerHTML+"?",type:"warning",allowOutsideClick:!0,confirmButtonText:"Cancelar asistencia"},function(n){n&&a.ajax({type:"POST",data:JSON.stringify({function:"eliminar_asistencia",params:i.target.getAttribute("val")}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",success:function(a){location.reload()},error:function(a){swal("Error!",a,"error"),console.log(a)}})})});{function e(i){a("#edicion-celular").hide(),a("#mostrar-celular").show()}a("#editar-celular").click(function(i){a("#mostrar-celular").hide(),a("#edicion-celular").attr("style","display: inline"),a("#campo-celular").attr("placeholder",a("#celular").html())}),a("#cancelar-editar-celular").click(e),a("#guardar-editar-celular").click(function(i){console.log(a("#campo-celular").val()),a.when(a.ajax({type:"POST",data:JSON.stringify({function:"modificar_celular_de_usuario",params:[o.id,a("#campo-celular").val()]}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",error:function(i){a("#debug").html(i)},success:function(i){o.phone=a("#campo-celular").val(),console.log(i)}})).done(e),a("#celular").html(a("#campo-celular").val())})}n.hide()}}});