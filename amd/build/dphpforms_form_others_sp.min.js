'use strict';define(['jquery','block_ases/jszip','block_ases/jquery.dataTables','block_ases/dataTables.autoFill','block_ases/dataTables.buttons','block_ases/buttons.html5','block_ases/buttons.flash','block_ases/buttons.print','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function o(C,D){var E=a('#input_json_economics_saved').val();a.ajax({type:'POST',data:{func:'edit_economics_data',json:C,json_prev:E,instanceid:A(),ases:D},url:'../managers/student_profile/discapacity_tab_api.php',success:function success(F){swal({title:F.title,text:F.msg,type:F.status},function(){a('html, body').animate({scrollTop:700},'slow'),a('#input_economics_saved').attr('value','1'),a('#input_json_economics_saved').attr('value',C)})},dataType:'json',cache:'false',error:function error(F){swal(F.title,F.msg,F.status)}})}function p(C,D){var E=a('#input_json_economics_saved').val();a.ajax({type:'POST',data:{func:'save_economics_data',json:C,json_prev:E,instanceid:A(),ases:D},url:'../managers/student_profile/discapacity_tab_api.php',success:function success(F){swal({title:F.title,text:F.msg,type:F.status},function(){a('html, body').animate({scrollTop:700},'slow'),a('#save_economics_data').parent().hide(),a('#edit_economics_data').parent().show(),a('#input_economics_saved').attr('value','1'),a('#input_json_economics_saved').attr('value',C)})},dataType:'json',cache:'false',error:function error(F){swal(F.title,F.msg,F.status)}})}function q(){var C=[],D={key_input:'#estrato_socioeconomico',val_input:a('#estrato_socioeconomico').val()};C.push(D);var E={};a('#collapse_econo input[type=checkbox]').not('.check_solvencia').each(function(){E.key_input=a(this).attr('id'),a(this).is(':checked')?(E.val_input=1,a(this).parent().next().children().children('input').each(function(){var L=a(this).attr('type');'text'==L&&(E.key_input_text=a(this).attr('id'),E.val_input_text=a(this).val()),'number'==L&&(E.key_input_number=a(this).attr('id'),E.val_input_number=a(this).val())})):E.val_input=0,C.push(E),E={}});var F={key_input:'#check_solvencia'};F.val_input=a('#check_solvencia').is(':checked')?1:0,C.push(F);var G={},H=[],I=[],J=[];for(obj=document.getElementById('div_info_padre'),i=0;ele=obj.getElementsByTagName('select')[i];i++)G.key_select=ele.id,G.val_select=ele.value,'select_nivel_padre'==ele.id&&H.push(G),'select_ocupacion_padre'==ele.id&&('option_ninguna'!=ele.value&&(G.key_input_select='#'+a('#'+ele.id).parent().next().children('input').attr('id'),G.val_input_select=a('#'+ele.id).parent().next().children('input').val(),G.title_select=ele.title),I.push(G)),'select_situa_padre'==ele.id&&J.push(G),G={};for(obj=document.getElementById('div_info_madre'),i=0;ele=obj.getElementsByTagName('select')[i];i++)G.key_select=ele.id,G.val_select=ele.value,'select_nivel_madre'==ele.id&&H.push(G),'select_ocupacion_madre'==ele.id&&('option_ninguna'!=ele.value&&(G.key_input_select='#'+a('#'+ele.id).parent().next().children('input').attr('id'),G.val_input_select=a('#'+ele.id).parent().next().children('input').val(),G.title_select=ele.title),I.push(G)),'select_situa_madre'==ele.id&&J.push(G),G={};C.push(I),C.push(H),C.push(J);var K={key_input:'#textarea_expectativas',val_input:a('#textarea_expectativas').val()};return C.push(K),C}function r(){var C={};if(C.title='\xC9xito',C.msg='El formulario fue validado con \xE9xito',C.status='success',a('#collapse_econo input[type=checkbox]').not('.check_solvencia').each(function(){a(this).is(':checked')&&a(this).parent().next().children().children('input').each(function(){var K=a(this).val(),L=a(this).attr('id'),M=a(this).attr('type');if(''==K)return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+L+' es obligatorio',C;if('text'==M&&z(K))return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+L+' no debe contener n\xFAmeros',C;if('number'==M){if(Number.isNaN(K))return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+L+' debe ser num\xE9rico',C;if(0>K)return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+L+' no debe ser negativo',C}})}),''==a('#estrato_socioeconomico').val()){return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+'estrato_socioeconomico'+' es obligatorio y debe ser n\xFAmero entero',C}var E=a('#estrato_socioeconomico').val();if(1>E||6<E||0!=E%1)return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+'estrato_socioeconomico'+' corresponde a estratos sociales (Del 1 al 6)',C;if('option_ninguna'!=a('#select_ocupacion_madre').val()){var G=a('#input_ocupacion_madre').val();if(''==G)return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+'input_ocupacion_madre'+' es obligatorio',C}if('option_ninguna'!=a('#select_ocupacion_padre').val()){var I=a('#input_ocupacion_padre').val();if(''==I)return C.title='Datos econ\xF3micos',C.status='error',C.msg='El campo '+'input_ocupacion_padre'+' es obligatorio',C}return C}function t(C,D){var E=a('#input_json_health_saved').val();a.ajax({type:'POST',data:{func:'edit_health_data',json:C,json_prev:E,instanceid:A(),ases:D},url:'../managers/student_profile/discapacity_tab_api.php',success:function success(F){swal({title:F.title,text:F.msg,type:F.status},function(){a('html, body').animate({scrollTop:820},'slow'),a('#input_health_saved').attr('value','1'),a('#input_json_health_saved').attr('value',C)})},dataType:'json',cache:'false',error:function error(F){swal(F.title,F.msg,F.status)}})}function u(C,D){var E=a('#input_json_health_saved').val();a.ajax({type:'POST',data:{func:'save_health_data',json:C,json_prev:E,instanceid:A(),ases:D},url:'../managers/student_profile/discapacity_tab_api.php',success:function success(F){swal({title:F.title,text:F.msg,type:F.status},function(){a('html, body').animate({scrollTop:820},'slow'),a('#save_health_data').parent().hide(),a('#edit_health_data').parent().show(),a('#input_health_saved').attr('value','1'),a('#input_json_health_saved').attr('value',C)})},dataType:'json',cache:'false',error:function error(F){swal(F.title,F.msg,F.status)}})}function v(){var C=[],D=a('#opciones_regimen_salud').find(':input[type=radio]:checked').val(),E=a('#opciones_regimen_salud').find(':input[type=radio]:checked').attr('id'),G=a('#opciones_servicio_salud').find(':input[type=radio]:checked').val(),H=a('#opciones_servicio_salud').find(':input[type=radio]:checked').attr('id'),I=a('#input_detalle_servicio').val(),L=[],M={};return a('#options_services input[type=checkbox]').each(function(){M.key_input=a(this).attr('id'),a(this).is(':checked')?(M.val_input=1,'check_servicio_otro'==M.key_input&&(M.key_input_text='servicio_otro_cual',M.val_input_text=a('#servicio_otro_cual').val())):M.val_input=0,L.push(M),M={}}),C.push({key_input:E,val_input:D}),C.push({key_input:H,val_input:G,val_input_text:I,key_input_text:'input_detalle_servicio'}),C.push(L),C}function w(){var C={};if(C.title='\xC9xito',C.msg='El formulario fue validado con \xE9xito',C.status='success',a('#check_servicio_otro').is(':checked')){var D=a('#servicio_otro_cual').val(),E='Otro servicio';if(''==D)return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+E+' es obligatorio',C;if(z(D))return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+E+' no debe contener n\xFAmeros',C}var F=a('#opciones_regimen_salud').find(':input[type=radio]:checked').val();if(void 0==F){return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+'R\xE9gimen de salud'+' es obligatorio',C}var H=a('#opciones_servicio_salud').find(':input[type=radio]:checked').val();if(void 0!=H){var J,I=a('#input_detalle_servicio').val();switch(H){case'input_radio_eps':if(J='\xBFCu\xE1l EPS?',''==I)return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' es obligatorio',C;if(z(I))return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' no debe contener n\xFAmeros',C;break;case'input_radio_sisben':if(J='\xBFCu\xE1l Nivel?',''==I)return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' es obligatorio y num\xE9rico',C;if(1>I||3<I)return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' corresponde a niveles v\xE1lidos de SISBEN (1,2,3)',C;break;case'input_radio_otro_servicio':if(J='\xBFCu\xE1l servicio de salud?',''==I)return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' es obligatorio',C;if(z(I))return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+J+' no debe contener n\xFAmeros',C;}}else{return C.title='Datos de servicios de salud',C.status='error',C.msg='El campo '+'Servicio de salud'+' es obligatorio',C}return C}function y(C,D,E,F,G,H){1==D?(a('#'+C).prop('checked',!0),a('#'+E).val(F),a('#'+E).parent().parent().show(),a('#'+G).val(H)):(a('#'+C).prop('checked',!1),a('#'+E).val(''),a('#'+E).parent().parent().hide(),a('#'+G).val(''))}function z(C){for(i=0;i<C.length;i++)if(-1!='0123456789'.indexOf(C.charAt(i),0))return 1;return 0}function A(){var C=location.search.split('&');for(x in C)if(0<=C[x].indexOf('instanceid')){var D=C[x].split('=');return D[1]}return 0}var B=a('#id_ases').val();a('#edit_health_data').click(function(){var C=w();if('error'==C.status)swal(C.title,C.msg,C.status);else{var D=v();D=JSON.stringify(D),t(D,B)}}),a('#save_health_data').click(function(){var C=w();if('error'==C.status)swal(C.title,C.msg,C.status);else{var D=v();D=JSON.stringify(D),u(D,B)}}),'0'==a('#input_health_saved').val()&&a('#save_health_data').parent().show(),'1'==a('#input_health_saved').val()&&(a('#save_health_data').parent().hide(),a('#edit_health_data').parent().show(),function(){var C,E,F,G,H=JSON.parse(a('#input_json_health_saved').val());for(i in H)switch(i){case'regimen_salud':G=JSON.parse(H[i]),a('#'+G.key_input).prop('checked',!0);;break;case'servicio_salud_vinculado':G=JSON.parse(H[i]),C=G.key_input,E=G.key_input_text,F=G.val_input_text,a('#'+C).prop('checked',!0),a('#'+E).val(F),a('#'+E).parent().show(),'input_radio_sisben'==C&&(a('#'+E).attr('title','Escriba Nivel'),a('#'+E).attr('type','number'),a('#'+E).attr('min','1'),a('#'+E).attr('max','3')),'input_radio_eps'==C?(a('#'+E).attr('title','Escriba EPS'),a('#'+E).attr('placeholder','\xBFCu\xE1l EPS?'),a('#'+E).attr('type','text')):'input_radio_otro_servicio'==C&&(a('#'+E).attr('title','Escriba otro servicio'),a('#'+E).attr('placeholder','\xBFCu\xE1l servicio de salud?'),a('#'+E).attr('type','text'));break;case'servicios_usados':for(objeto in G=JSON.parse(H[i]),G)1==G[objeto].val_input?(a('#'+G[objeto].key_input).prop('checked',!0),'check_servicio_otro'==G[objeto].key_input&&(a('#'+G[objeto].key_input_text).val(G[objeto].val_input_text),a('#'+G[objeto].key_input_text).parent().show())):(a('#'+G[objeto].key_input).prop('checked',!1),'check_servicio_otro'==G[objeto].key_input&&(a('#servicio_otro_cual').val(''),a('#servicio_otro_cual').parent().hide()));}}()),a('#check_servicio_otro').click(function(){a(this).is(':checked')?(a('#servicio_otro_cual').parent().show(),a('#servicio_otro_cual').prop('required',!0)):(a('#servicio_otro_cual').parent().hide(),a('#servicio_otro_cual').prop('required',!1),a('#servicio_otro_cual').val(''))}),a('.servicio_salud').click(function(){'input_radio_eps'==a(this).val()?(a('#input_detalle_servicio').attr('title','Escriba EPS'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l EPS?'),a('#input_detalle_servicio').attr('type','text')):'input_radio_sisben'==a(this).val()?(a('#input_detalle_servicio').attr('title','Escriba Nivel'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l Nivel?'),a('#input_detalle_servicio').attr('type','number'),a('#input_detalle_servicio').attr('min','1'),a('#input_detalle_servicio').attr('max','3')):'input_radio_otro_servicio'==a(this).val()&&(a('#input_detalle_servicio').attr('title','Escriba otro servicio'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l servicio de salud?'),a('#input_detalle_servicio').attr('type','text')),a('#input_detalle_servicio').parent().show(),a('#input_detalle_servicio').attr('required',!0),a('#input_detalle_servicio').val('')}),'0'==a('#input_economics_saved').val()&&a('#save_economics_data').parent().show(),'1'==a('#input_economics_saved').val()&&(a('#save_economics_data').parent().hide(),a('#edit_economics_data').parent().show(),function(){var C,D,E,F,G,H,I,J=JSON.parse(a('#input_json_economics_saved').val());for(i in J)switch(i){case'estrato':a('#estrato_socioeconomico').val(J[i]);break;case'prestacion_economica':I=JSON.parse(J[i]),C=I.key_input,D=I.val_input,E=I.key_input_text,F=I.val_input_text,G=I.key_input_number,H=I.val_input_number,y(C,D,E,F,G,H);break;case'beca':I=JSON.parse(J[i]),C=I.key_input,D=I.val_input,E=I.key_input_text,F=I.val_input_text,G=I.key_input_number,H=I.val_input_number,y(C,D,E,F,G,H);break;case'ayuda_transporte':I=JSON.parse(J[i]),C=I.key_input,D=I.val_input,E=I.key_input_text,F=I.val_input_text,G=I.key_input_number,H=I.val_input_number,y(C,D,E,F,G,H);break;case'ayuda_materiales':I=JSON.parse(J[i]),C=I.key_input,D=I.val_input,E=I.key_input_text,F=I.val_input_text,G=I.key_input_number,H=I.val_input_number,y(C,D,E,F,G,H);break;case'solvencia_econo':D=J[i],1==D?a('#check_solvencia').prop('checked',!0):a('#check_solvencia').prop('checked',!1);break;case'ocupacion_padres':for(objeto in I=JSON.parse(J[i]),I)'option_ninguna'==I[objeto].val_select?a('#'+I[objeto].key_select).val(I[objeto].val_select):(a('#'+I[objeto].key_select).val(I[objeto].val_select),a('#'+I[objeto].key_select).attr('title',I[objeto].title_select),a(I[objeto].key_input_select).val(I[objeto].val_input_select),a(I[objeto].key_input_select).parent().show());break;case'nivel_educ_padres':for(objeto in I=JSON.parse(J[i]),I)a('#'+I[objeto].key_select).val(I[objeto].val_select);break;case'situa_laboral_padres':for(objeto in I=JSON.parse(J[i]),I)a('#'+I[objeto].key_select).val(I[objeto].val_select);break;case'expectativas_laborales':I=JSON.parse(J[i]),a(I.key_input).val(I.val_input);}}()),a('#collapse_econo input[type=checkbox]').not('.check_solvencia').on('change',function(){a(this).is(':checked')?(a(this).parent().next().show(),a(this).parent().next().children().children('input').prop('required',!0)):(a(this).parent().next().hide(),a(this).parent().next().children().children('input').prop('required',!1),a(this).parent().next().children().children('input').val(''))}),a('.select_ocupacion').on('change',function(){if('option_ninguna'==a(this).val())a(this).parent().next().hide(),a(this).parent().next().children('input').prop('required',!1),a(this).parent().next().children('input').val('');else{a(this).parent().next().show(),a(this).parent().next().children('input').prop('required',!0);var C=document.getElementById(a(this).attr('id'));a(this).attr('title',C.options[C.selectedIndex].title)}}),a('#save_economics_data').click(function(){var C=r();if('error'==C.status)swal(C.title,C.msg,C.status);else{var D=q();D=JSON.stringify(D),p(D,B)}}),a('#edit_economics_data').click(function(){var C=r();if('error'==C.status)swal(C.title,C.msg,C.status);else{var D=q();D=JSON.stringify(D),o(D,B)}})}}});