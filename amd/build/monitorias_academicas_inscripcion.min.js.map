{"version":3,"sources":["../src/monitorias_academicas_inscripcion.js"],"names":["define","$","gmm","loading_indicator","USER","set_user","id","email","phone","p","console","log","init","show","click","e","preventDefault","when","ajax","type","data","JSON","stringify","target","url","dataType","error","msg","html","done","sesion","html_to_load","generate_modal","hide","show_modal","find","addClass","val","innerHTML","message","fecha_legible","first","submit","id_sesion","id_asistente","asignatura_a_consultar","tematica_a_consultar","success","status_code","swal","title","text","icon","location","reload","data_response","responseText","monitoria","parent","allowOutsideClick","confirmButtonText","isConfirmed","getAttribute","attr","terminarDeEditar"],"mappings":"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","sourcesContent":["// Standard license block omitted.\r\n/*\r\n * @package    block_ases\r\n * @copyright  ASES\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n/**\r\n * @module block_ases/monitorias_academicas_inscripcion\r\n */\r\n\r\n define(['jquery','block_ases/_general_modal_manager','block_ases/loading_indicator','block_ases/sweetalert'], function($, gmm, loading_indicator, sweetalert){\r\n     var USER = {};\r\n    return {\r\n        set_user : (id, email, phone) => USER = {id, email, phone},\r\n        p : () => console.log(USER),\r\n        init : function(){\r\n            loading_indicator.show();\r\n            // Setup: Modal de inscripción a monitoría\r\n            $(\".link_inscripcion_monitoria\").click(function(e){\r\n                e.preventDefault();\r\n                loading_indicator.show();\r\n                // cargar cuándo es la próxima monitoría\r\n                $.when($.ajax({\r\n                    type: \"POST\",\r\n                    data: JSON.stringify({\r\n                            \"function\": 'get_proxima_sesion_de_monitoria',\r\n                            \"params\": e.target.id,\r\n                        }),\r\n                    url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n                    dataType: \"json\",\r\n                    error: function(msg) {\r\n                        $(\"#debug\").html(msg);\r\n                    }\r\n                })).done((sesion) =>{\r\n                // mostrar modal\r\n                let html_to_load = $(\"#content-modal-inscripcion\").html();\r\n                gmm.generate_modal(\"modal_fomulario_inscripcion\", \"Inscribirse a monitoría\", html_to_load, null, \r\n                // setup después de mostrar el modal de inscripción\r\n                function() {\r\n                    loading_indicator.hide();\r\n                    gmm.show_modal(\".modal_fomulario_inscripcion\");\r\n                    $(\".modal_fomulario_inscripcion\").find(\".general_modal_content\").addClass(\"w-50\");\r\n                    $(\".modal_fomulario_inscripcion\").find(\"#monitoria\").val(e.target.innerHTML);\r\n                    $(\".modal_fomulario_inscripcion\").find(\"#fecha-monitoria\").val(sesion.message.fecha_legible);\r\n                    // setup de listeners\r\n                    // cancelar\r\n                    $(\".modal_fomulario_inscripcion\").find(\"#cancelar-inscripcion-btn\").click(() => {$(\".general_modal_close\").first().click()});\r\n                    // inscribirse\r\n                    $(\".modal_fomulario_inscripcion\").find(\"#form-inscripcion\").submit(function(e){\r\n                        e.preventDefault();\r\n                        loading_indicator.show();\r\n\r\n                        let id_sesion = sesion.message.id;\r\n                        let id_asistente = USER.id;\r\n                        let asignatura_a_consultar = $(\".modal_fomulario_inscripcion\").find(\"#asignatura\").val();\r\n                        let tematica_a_consultar = $(\".modal_fomulario_inscripcion\").find(\"#tematica\").val();\r\n\r\n                        $.ajax({\r\n                            type: \"POST\",\r\n                            data: JSON.stringify({\r\n                                \"function\": 'anadir_asistente_a_sesion_de_monitoria',\r\n                                \"params\": [id_sesion, id_asistente, asignatura_a_consultar, tematica_a_consultar],\r\n                            }),\r\n                            url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n                            dataType: \"json\",\r\n                            success: function(msg) {\r\n                                loading_indicator.hide();\r\n                                $(\".general_modal_close\").first().click();\r\n                                if(msg.status_code == 0) {\r\n                                    swal(\r\n                                        {title:\"Inscripción correcta!\",\r\n                                        text: \"Gracias por inscribirte. Serás contactado por el monitor encargado el día de la monitoría para concretar los detalles.\",\r\n                                        icon: \"success\"},\r\n                                        function (isConfirmed) {\r\n                                            location.reload()\r\n                                        });\r\n                                        \r\n                                } else {\r\n                                    swal(\r\n                                            'Error!',\r\n                                            'Oops!: ' + msg.data_response,\r\n                                            'error'\r\n                                        );\r\n                                    console.log(msg);\r\n                                }\r\n                            },\r\n                            error: function(msg) {\r\n                                console.log(\"Error de inscripción a monitoria en BD\");\r\n                                $(\"#debug\").html(msg.responseText);\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                });\r\n\r\n            });\r\n\r\n            });\r\n            // Setup: eliminar inscripcion\r\n            $(\".eliminar-inscripcion\").click(function (e) {\r\n                let monitoria = $(e.target).parent().parent().find(\"td\");\r\n                swal({\r\n                    title: 'Cancelar asistencia',\r\n                    text: \"¿Deseas desinscribirte de la monitoría de \"+monitoria[3].innerHTML+\" programada el \"+monitoria[0].innerHTML+\" \"+monitoria[1].innerHTML+\" \"+monitoria[2].innerHTML+\"?\",\r\n                    type: 'warning',\r\n                    allowOutsideClick: true,\r\n                    confirmButtonText: 'Cancelar asistencia'\r\n                }, function (isConfirmed) {\r\n                    if (isConfirmed) {\r\n                        $.ajax({\r\n                            type: \"POST\",\r\n                            data: JSON.stringify({\r\n                                \"function\": 'eliminar_asistencia',\r\n                                \"params\": e.target.getAttribute(\"val\"),\r\n                            }),\r\n                            url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n                            dataType: \"json\",\r\n                            success: function(msg) {\r\n                                location.reload(); \r\n                            },\r\n                            error : function(msg) {\r\n                                swal('Error!', msg, 'error')\r\n                                console.log(msg)\r\n                            },\r\n                        });\r\n                    }\r\n                });\r\n                                });\r\n            // Setup: editar numero de telefono celular\r\n            $(\"#editar-celular\").click(function (e) {\r\n                $(\"#mostrar-celular\").hide();\r\n                $(\"#edicion-celular\").attr( \"style\", \"display: inline\");\r\n                $(\"#campo-celular\").attr(\"placeholder\", $(\"#celular\").html());\r\n            });\r\n            function terminarDeEditar(e){\r\n                $(\"#edicion-celular\").hide();\r\n                $(\"#mostrar-celular\").show();\r\n            }\r\n            $(\"#cancelar-editar-celular\").click(terminarDeEditar);\r\n            $(\"#guardar-editar-celular\").click(function (e) {\r\n                // guardar el numero celular en la bd\r\n                console.log($(\"#campo-celular\").val());\r\n                $.when($.ajax({\r\n                    type: \"POST\",\r\n                    data: JSON.stringify({\r\n                            \"function\": 'modificar_celular_de_usuario',\r\n                            \"params\": [USER.id, $(\"#campo-celular\").val()],\r\n                        }),\r\n                    url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n                    dataType: \"json\",\r\n                    error: function(msg) {\r\n                        $(\"#debug\").html(msg);\r\n                    },\r\n                    success: function(msg) {\r\n                        console.log(msg)\r\n                    }})).done(terminarDeEditar);\r\n                    $(\"#celular\").html($(\"#campo-celular\").val());\r\n            });\r\n            loading_indicator.hide();\r\n        }\r\n    }\r\n });"],"file":"monitorias_academicas_inscripcion.min.js"}