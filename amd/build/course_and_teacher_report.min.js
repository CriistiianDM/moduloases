define ("block_ases/course_and_teacher_report",["jquery","core/notification","block_ases/global_grade_book","core/templates","block_ases/jquery.dataTables"],function(a,b,c,d){return{init:function init(){a(document).ready(function(){})},load_report:function load_report(e){a("#tableFinalgradesReport").html("<img class=\"icon-loading\" src=\"../icon/loading.gif\"/>");var k=function(){function a(a,b,c){this.cursos_al_un_est_ases=a?a:0;this.cursos_al_item_calif=b?b:0;this.cursos_al_un_item=c?c:0}a.return_critic_and_no_critic_report=function(b){for(var c=new a,d=new a,e=new a,f=0,g=b,h;f<g.length;f++){h=g[f];if(0<h.items_con_almenos_una_nota){switch(h.critica){case"SI":d.cursos_al_item_calif++;break;case"NO":c.cursos_al_item_calif++;break;}}if(0<h.cantidad_items){switch(h.critica){case"SI":d.cursos_al_un_item++;break;case"NO":c.cursos_al_un_item++;break;}}if(0<h.cantidad_estudiantes_ases){switch(h.critica){case"SI":d.cursos_al_un_est_ases++;break;case"NO":c.cursos_al_un_est_ases++;break;}}}e=a.return_total_report(d,c);return{critic_report:d,no_critic_report:c,total_report:e}};a.return_total_report=function(b,c){var d=new a;d.cursos_al_item_calif=b.cursos_al_item_calif+c.cursos_al_item_calif;d.cursos_al_un_est_ases=b.cursos_al_un_est_ases+c.cursos_al_un_est_ases;d.cursos_al_un_item=b.cursos_al_un_item+c.cursos_al_un_item;return d};return a}(),l={},m=e.course_id,n=e.instance_id,o=["critica","nombre_profesor"],p=null;function f(){a(".gradeparent").parent().css("background","#cccccc")}function g(a,b){var c=[],d;for(d=0;d<b.length;d++){if(a.includes(b[d])){c.push(d)}}return c}function h(b){a("#tableFinalgradesReport th").each(function(c){a(this).attr("title",b[c].description)})}function i(){a("#tableFinalgradesReport tbody").on("click","td.details-control",function(){var b=a(this).closest("tr"),d=p.row(b);if(d.child.isShown()){d.child.hide();b.removeClass("shown")}else{d.child("<img class=\"icon-loading\" src=\"../icon/loading.gif\"/>").show();var e=function(a,b){a.child(b).show();c.read_only_view_styles();f()};j(d,e,b);b.addClass("shown")}})}(function(){a.ajax({method:"GET",url:"../managers/course_and_teacher_report/course_and_teacher_report_api.php/"+n,dataType:"json"}).done(function(b){a("#tableFinalgradesReport").html("");l=k.return_critic_and_no_critic_report(b.data);d.render("block_ases/course_and_teacher_report_summary",{resume_report:l}).then(function(a,b){d.appendNodeContents(".course_and_teacher_report .summary",a,b)}).fail(function(){});p=a("#tableFinalgradesReport").DataTable({data:b.data,bsort:b.bsort,columns:b.columns,language:b.language,order:b.order,initComplete:function initComplete(){var c=b.columns.map(function(a){return a.name?a.name:null}),d=g(o,c);this.api().columns(d).every(function(){var b=this,c=a("<select><option value=\"\"></option></select>").appendTo(a(b.header())).on("change",function(){var c=a.fn.dataTable.util.escapeRegex(a(this).val());b.search(c?"^"+c+"$":"",!0,!1).draw()});b.data().unique().sort().each(function(a){c.append("<option value=\""+a+"\">"+a+"</option>")})})}});h(b.columns);i()}).fail(function(a){console.log(a)})})();function j(c,d,e){var f=c.data(),g={function:"grade_table",params:{course_id:f.curso_id,course_caller_id:m,instance_id:n}};a.ajax({method:"POST",url:"../managers/grades/grades_api.php",data:g,dataType:"html"}).fail(function(a){b.alert("Error, debe informar a un programador, adjunte esta informaci\xF3n",a.responseText,"Aceptar");e.removeClass("shown")}).done(function(a){d(c,a)})}}}});
//# sourceMappingURL=course_and_teacher_report.min.js.map
