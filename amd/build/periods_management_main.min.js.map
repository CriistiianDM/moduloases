{"version":3,"sources":["../src/periods_management_main.js"],"names":["define","$","init","select2","language","noResults","searching","dropDownAutoWidth","document","ready","css","display","datepicker","dateFormat","on","prop","searchPeriod","slideToggle","updatePeriod","addClass","val","trigger","createPeriod","loadPeriods","semester","callback","dataString","ajax","type","data","dat","url","success","msg","error","nombre","swal","removeClass","fecha_inicio","fecha_fin","dataType","semesterId","semesterName","beginningDate","endingDate","result_validation","validateSemesterFields","title","text","html","id","name","beginning","ending","confirmButtonColor","confirmButtonText","closeOnConfirm","cache","load","empty","append","DataTable","alert","newSemesterName","newBeginningDate","newEndingDate","op","beginningDateString","endingDateString","regexp","begin_regexp_date","exec","end_regexp_date","Date"],"mappings":"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","sourcesContent":[" /**\r\n * Management - Create, update and load periods\r\n * @module amd/src/periods_management_main\r\n * @author Juan Pablo Moreno Muñoz\r\n * @copyright 2018 Juan Pablo Moreno Muñoz <moreno.juan@correounivalle.edu.co>\r\n * @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/jquery.dataTables','block_ases/sweetalert','block_ases/select2', 'block_ases/jqueryui'], function($, bootstrap, datatables, sweetalert, select2, jqueryui) {\r\n\r\n\treturn {\r\n\r\n\t\tinit: function() {\r\n\t\t\t$(\"#periods\").select2({\r\n\t\t\tlanguage: {\r\n\r\n\t\t\t\tnoResults: function(){\r\n\t\t\t\treturn 'No se encontraron resultados';\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsearching: function(){\r\n\t\t\t\treturn 'Buscando...';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdropDownAutoWidth: true,\r\n\r\n\t\t\t});\r\n\r\n\t\t\t$(document).ready(function() {\r\n\t\t\t\t$(\".assignment_li\").css({ display: 'none' });\r\n\t\t\t\t$(\".period_date\").datepicker({dateFormat: \"yy-mm-dd\"});\r\n\t\t\t\t$(\"#search_button\").on('click', function() {\r\n\t\t\t\t$(\"#search_button\").prop(\"disabled\", true);\r\n\t\t\t\tsearchPeriod();\r\n\t\t\t\t$('#periods').prop('disabled', true);\r\n\t\t\t\t$(\".assignment_li\").slideToggle(\"fast\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#ok-button\").on('click', function(){\t\t\r\n\t\t\t\tupdatePeriod();\r\n\t\t\t\t$(\".assignment_li\").addClass('hidden');\r\n\t\t\t\t$(\"#periods\").val('').trigger('change.select2');\r\n\t\t\t\t$(\"#periods\").prop(\"disabled\", false);\r\n\t\t\t\t$(\"#search_button\").prop(\"disabled\", false);\r\n\t\t\t\t$(\"#semester_name\").val(\" \");\r\n\t\t\t\t$(\"#beginning_date\").val(\" \");\r\n\t\t\t\t$(\"#ending_date\").val(\" \");\t\t\r\n\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#cancel-button\").on('click', function() {\t\t\r\n\t\t\t\t$(\".assignment_li\").addClass('hidden');\r\n\t\t\t\t$(\"#periods\").val('').trigger('change.select2');\r\n\t\t\t\t$(\"#periods\").prop(\"disabled\", false);\r\n\t\t\t\t$(\"#search_button\").prop(\"disabled\", false);\r\n\t\t\t\t$(\"#semester_name\").val(\" \");\r\n\t\t\t\t$(\"#beginning_date\").val(\" \");\r\n\t\t\t\t$(\"#ending_date\").val(\" \");\t\t\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#save-button\").on('click', function() {\r\n\t\t\t\tcreatePeriod();\r\n\t\t\t\t$(\"#new_semester_name\").val(\" \");\r\n\t\t\t\t$(\"#new_beginning_date\").val(\" \");\r\n\t\t\t\t$(\"#new_ending_date\").val(\" \");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#cancel-save-button\").on('click', function(){\t\t\t\t\r\n\t\t\t\t$(\"#new_semester_name\").val(\" \");\r\n\t\t\t\t$(\"#new_beginning_date\").val(\" \");\r\n\t\t\t\t$(\"#new_ending_date\").val(\" \");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#list-periods-panel\").on('click', function(){\r\n\t\t\t\tloadPeriods();\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t/**\r\n\t * @method searchPeriod\r\n\t * @desc Search a period information given a semester. Current processing on search_period_processing.php\r\n\t * @param {object} semester We'd like to get certain information\r\n\t * @param {function} callback \r\n\t * @return {void}\r\n\t */\r\n\tfunction searchPeriod(semester, callback){\r\n\t\tvar dataString = semester;\r\n\t\tif(!dataString){\r\n\t\t\tdataString = $(\"#periods\").val();\r\n\t\t}\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: {dat: dataString},\r\n\t\t\turl: \"../managers/periods_management/search_period_processing.php\",\r\n\t\t\tsuccess: function(msg){\r\n\r\n\t\t\t\tif(callback){\r\n\t\t\t\t\tcallback(msg);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(!msg.error){\r\n\r\n\t\t\t\t\t\tif(msg.nombre == \"\"){\r\n\t\t\t\t\t\t\tswal(\"Error\", \"El semestre no existe en la base de datos\", \"error\");\r\n\t\t\t\t\t\t\t$('#periods').prop('disabled', false);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t$('.assignment_li').removeClass('hidden');\r\n\t\t\t\t\t\t\t$('#semester_name').val(msg.nombre);\r\n\t\t\t\t\t\t\t$('#beginning_date').val(msg.fecha_inicio);\r\n\t\t\t\t\t\t\t$('#ending_date').val(msg.fecha_fin);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tswal(\"Error\", msg.error, \"error\");\r\n\t\t\t\t\t\t$(\".assignment_li\").addClass('hidden');\r\n\t\t\t\t\t\t$(\"#periods\").val('').trigger('change.select2');\r\n\t\t\t\t\t\t$(\"#periods\").prop('disabled', false);\r\n\t\t\t\t\t\t$(\"#semester_name\").val(\"\");\r\n\t\t\t\t\t\t$(\"#search_button\").prop(\"disabled\", false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tdataType: \"json\",\r\n\t\t\terror: function(msg){\r\n\t\t\t\tswal(\"Error\", \"Hay un error con la conexión\", \"error\");\r\n\t\t\t\t$(\".assignment_li\").addClass('hidden');\r\n\t\t\t\t$(\"#periods\").val('').trigger('change.select2');\r\n\t\t\t\t$(\"#periods\").prop('disabled', false);\r\n\t\t\t\t$(\"#semester_name\").val(\" \");\r\n\t\t\t\t$(\"#search_button\").prop(\"disabled\", false);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @method updatePeriod\r\n\t * @desc Updates a period values (id, name, beginning date and ending date). Current processing on update_period_processing.php\r\n\t * @return {void}\r\n\t */\r\n\tfunction updatePeriod(){\r\n\r\n\t\tvar semesterId = $(\"#periods\").val();\r\n\t\tvar semesterName = $(\"#semester_name\").val();\r\n\t\tvar beginningDate = $(\"#beginning_date\").val();\r\n\t\tvar endingDate = $(\"#ending_date\").val();\r\n\r\n\t\tvar result_validation = validateSemesterFields(semesterName, beginningDate, endingDate, semesterId);\r\n\r\n\t\tif(result_validation != \"success\"){\r\n\t\t\tswal({\r\n\t\t\t\ttitle: \"Advertencia\",\r\n\t\t\t\ttext: result_validation,\r\n\t\t\t\ttype: \"warning\",\r\n\t\t\t\thtml: true\r\n\t\t\t});\r\n\t\t}\r\n\t\telse{\t\t\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: {id: semesterId, name: semesterName, beginning: beginningDate, ending: endingDate},\r\n\t\t\t\turl: \"../managers/periods_management/update_period_processing.php\",\r\n\t\t\t\tsuccess: function(msg){\r\n\r\n\t\t\t\t\tswal({\r\n\t\t\t\t\t\ttitle: \"Información\",\r\n\t\t\t\t\t\ttext: msg,\r\n\t\t\t\t\t\ttype: \"info\",\r\n\t\t\t\t\t\thtml: true,\r\n\t\t\t\t\t\tconfirmButtonColor: \"#d51b23\",\r\n\t\t\t\t\t\tconfirmButtonText: \"OK\",\r\n\t\t\t\t\t\tcloseOnConfirm: true\r\n\t\t\t\t\t});\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tdataType: \"text\",\r\n\t\t\t\tcache: \"false\",\r\n\t\t\t\terror: function(msg){\r\n\t\t\t\t\tswal(\"Error\", \"Ha ocurrido un error\", \"error\")\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @method loadPeriods\r\n\t * @desc Loads a period values on a table. Current processing on load_periods_processing.php\r\n\t * @return {void}\r\n\t */\r\n\tfunction loadPeriods(){\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: {load: 'loadSemester'},\r\n\t\t\turl: \"../managers/periods_management/load_periods_processing.php\",\r\n\t\t\tsuccess: function(msg){\r\n\t\t\t\t$(\"#div_periods\").empty();\r\n\t\t\t\t$(\"#div_periods\").append('<table id=\"tablePeriods\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead><thead></table>');\r\n\t\t\t\tvar table = $(\"#tablePeriods\").DataTable(msg);\r\n\t\t\t\t$('#div_periods').css('cursor', 'pointer');\r\n\t\t\t},\r\n\t\t\tdataType: \"json\",\r\n\t\t\tcache: false,\r\n\t\t\terror: function(msg){\r\n\t\t\t\talert(\"Error al cargar períodos\")\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @method createPeriod\r\n\t * @desc Creates a period obtaining values from html. Current processing on load_periods_processing.php\r\n\t * @return {void}\r\n\t */\r\n\tfunction createPeriod(){\r\n\t\tvar newSemesterName = $(\"#new_semester_name\").val();\r\n\t\tvar newBeginningDate = $(\"#new_beginning_date\").val();\r\n\t\tvar newEndingDate = $(\"#new_ending_date\").val();\r\n\r\n\t\t//Validates if every field is correct\r\n\t\tvar result_validation = validateSemesterFields(newSemesterName, newBeginningDate, newEndingDate);\r\n\r\n\t\t//If error\r\n\t\tif(result_validation != \"success\"){\r\n\t\t\tswal({\r\n\t\t\t\ttitle: \"Advertencia\",\r\n\t\t\t\ttext: result_validation,\r\n\t\t\t\ttype: \"warning\",\r\n\t\t\t\thtml: true\r\n\t\t\t});\r\n\r\n\t\t//Refresh with ajax \r\n\t\t}else{\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: {op: 'createSemester' , name: newSemesterName, beginning: newBeginningDate, ending: newEndingDate},\r\n\t\t\t\turl: \"../managers/periods_management/create_period_processing.php\",\r\n\t\t\t\tsuccess: function(msg){\r\n\r\n\t\t\t\t\tswal({\r\n\t\t\t\t\t\ttitle: \"Información\",\r\n\t\t\t\t\t\ttext: msg,\r\n\t\t\t\t\t\ttype: \"info\",\r\n\t\t\t\t\t\thtml: true,\r\n\t\t\t\t\t\tconfirmButtonColor: \"#d51b23\",\r\n\t\t\t\t\t\tconfirmButtonText: \"OK\",\r\n\t\t\t\t\t\tcloseOnConfirm: true\r\n\t\t\t\t\t});\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tdataType: \"text\",\r\n\t\t\t\tcache: \"false\",\r\n\t\t\t\terror: function(msg){\r\n\t\t\t\t\tswal(\"Error\", \"Ha ocurrido un error\", \"error\")\r\n\t\t\t\t}\t\t\t\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @method validateSemesterFields\r\n\t * @desc Validates if each field to create or update is correct (not empty field, date format correct)\r\n\t * @param {string} semesterName semester name\r\n\t * @param {string} beginningDateString Beginning period date\r\n\t * @param {string} endingDateString Ending period date\r\n\t * @param {id} semesterId semester id\r\n\t */\r\n\tfunction validateSemesterFields(semesterName, beginningDateString, endingDateString, semesterId){\r\n\r\n\t\tvar regexp = /^\\d{4}\\-(0?[1-9]|1[012])\\-(0?[1-9]|[12][0-9]|3[01])$/;\r\n\r\n\t\tvar begin_regexp_date = regexp.exec(beginningDateString);\r\n\t\tvar end_regexp_date = regexp.exec(endingDateString);\r\n\r\n\t\tif(semesterName == \"\" || beginningDateString == \"\" || endingDateString == \"\"){\r\n\t\t\treturn \"Debe llenar todos los campos\";\r\n\t\t}\r\n\t\telse if(begin_regexp_date === null){\r\n\t\t\treturn \"La fecha de inicio no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20\";\r\n\t\t}\r\n\t\telse if(end_regexp_date === null){\r\n\t\t\treturn \"La fecha de fin no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20\";\r\n\t\t}\r\n\t\telse if(!semesterId===undefined){\r\n\t\t\tif(semesterId == \"\"){\r\n\t\t\t\treturn \"Se encontró un problema con el identificador del semestre, vuelva a seleccionar el semestre\";\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn \"success\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\tconst beginningDate = new Date(beginningDateString);\r\n\t\t\tconst endingDate = new Date(endingDateString);\r\n\t\t\t\r\n\t\t\tif(beginningDate >= endingDate){\r\n\t\t\t\treturn \"La fecha de inicio de semestre debe ser menor a la de finalización\";\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn \"success\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n};\r\n});"],"file":"periods_management_main.min.js"}