'use strict';define(['jquery','block_ases/loading_indicator','block_ases/sweetalert','block_ases/jscookie'],function(a,b,c,d){function e(m){a.ajax({type:'POST',url:'../managers/incident_manager/incident_api.php',data:JSON.stringify({'function':'get_ids_open_incidents',params:[]}),contentType:'application/json; charset=utf-8',dataType:'json',async:!1,success:function success(n){'function'==typeof m&&m(n.data_response)},failure:function failure(){}})}function f(m){0<m?a('title').text('('+m+') '+j):a('title').text(j)}function g(){var m='notification_sound';document.getElementById('notification_sound').innerHTML='<audio autoplay="autoplay">'+('<source src="../resources/'+m+'.mp3" type="audio/mpeg">')+('<source src="../resources/'+m+'.ogg" type="audio/ogg">')+('<embed hidden="true" autostart="true" loop="false" src="../resources/'+m+'.mp3">')+'</audio>'}var h=!1,i=[],j=a('title').text(),k=!1;return 0<d.get('tabs')?k=!0:(d.set('tabs',0),k=!1),d.set('tabs',+d.get('tabs')+1),window.onunload=function(){d.set('tabs',d.get('tabs')-1)},a('html').append('<div id="notification_sound" style="display:none;"></div>'),console.log('Incident notifier initialised'),{init:function init(){e(function(m){var n=m.length;if(f(n),0<n){h=!0,m.forEach(function(p){i.push(p.id)});var o=a('#menu_incidents_manager').find('.menu_a');o.append(' <span id="incidents_counter" class="badge badge-secondary">'+m.length+'</span>')}}),setInterval(function(){e(function(m){var n=m.length;if(f(n),0<n&&!h){h=!0,g();var o=a('#menu_incidents_manager').find('.menu_a');o.append(' <span id="incidents_counter" class="badge badge-secondary">'+m.length+'</span>')}else if(0<n&&h){var p=!1,q=[];m.forEach(function(r){q.push(r.id),-1===i.indexOf(r.id)&&(p=!0)}),p&&(i=q,g(),a('#incidents_counter').text(m.length))}else 0===n&&a('#incidents_counter').remove()})},3e3)}}});