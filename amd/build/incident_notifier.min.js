'use strict';define(['jquery','block_ases/loading_indicator','block_ases/sweetalert'],function(a){function d(j){a.ajax({type:'POST',url:'../managers/incident_manager/incident_api.php',data:JSON.stringify({'function':'get_ids_open_incidents',params:[]}),contentType:'application/json; charset=utf-8',dataType:'json',async:!1,success:function success(k){'function'==typeof j&&j(k.data_response)},failure:function failure(){}})}function e(j){0<j?a('title').text('('+j+') '+i):a('title').text(i)}function f(){var j='notification_sound';document.getElementById('notification_sound').innerHTML='<audio autoplay="autoplay">'+('<source src="../resources/'+j+'.mp3" type="audio/mpeg">')+('<source src="../resources/'+j+'.ogg" type="audio/ogg">')+('<embed hidden="true" autostart="true" loop="false" src="../resources/'+j+'.mp3">')+'</audio>'}var g=!1,h=[],i=a('title').text();return a('html').append('<div id="notification_sound" style="display:none;"></div>'),console.log('Incident notifier initialised'),{init:function init(){d(function(j){var k=j.length;if(e(k),0<k){g=!0,j.forEach(function(m){h.push(m.id)});var l=a('#menu_incidents_manager').find('.menu_a');l.append(' <span id="incidents_counter" class="badge badge-secondary">'+j.length+'</span>')}}),setInterval(function(){d(function(j){var k=j.length;if(e(k),0<k&&!g){g=!0,f();var l=a('#menu_incidents_manager').find('.menu_a');l.append(' <span id="incidents_counter" class="badge badge-secondary">'+j.length+'</span>')}else if(0<k&&g){var m=!1,n=[];j.forEach(function(o){n.push(o.id),-1===h.indexOf(o.id)&&(m=!0)}),m&&(h=n,f(),a('#incidents_counter').text(j.length))}else 0===k&&a('#incidents_counter').remove()})},9e3)}}});