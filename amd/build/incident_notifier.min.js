define ("block_ases/incident_notifier",["jquery","block_ases/jscookie"],function(a,b){var f=!1,g=[],h=a("title").text();a("html").append("<div id=\"notification_sound\" style=\"display:none;\"></div>");function c(b){a.ajax({type:"POST",url:"../managers/incident_manager/incident_api.php",data:JSON.stringify({function:"get_ids_open_incidents",params:[]}),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function success(a){if("function"==typeof b){b(a.data_response)}},failure:function failure(){}})}function d(b){if(0<b){a("title").text("("+b+") "+h)}else{a("title").text(h)}}function e(){if("true"==b.get("beep")){document.getElementById("notification_sound").innerHTML="<audio autoplay=\"autoplay\">"+"<source src=\"../resources/notification_sound.mp3\" type=\"audio/mpeg\">"+"<source src=\"../resources/notification_sound.ogg\" type=\"audio/ogg\">"+"<embed hidden=\"true\" autostart=\"true\" loop=\"false\" src=\"../resources/notification_sound.mp3\">"+"</audio>";b.set("beep","false")}}var i=a("#menu_incidents_manager").find(".menu_a");console.log("Incident notifier initialised");return{init:function init(){if(i.length){c(function(a){var b=a.length;d(b);if(0<b){f=!0;a.forEach(function(a){g.push(a.id)});i.append(" <span id=\"incidents_counter\" class=\"badge badge-secondary\">"+a.length+"</span>")}});setInterval(function(){c(function(c){var h=!1,j=c.length;d(j);if(0<j&&!f){f=!0;h=!0;b.set("beep",h);i.append(" <span id=\"incidents_counter\" class=\"badge badge-secondary\">"+c.length+"</span>")}else if(0<j&&f){var k=!1,l=[];c.forEach(function(a){l.push(a.id);if(-1===g.indexOf(a.id)){k=!0}});if(k){g=l;h=!0;b.set("beep",h);a("#incidents_counter").text(c.length)}}else if(0===j){a("#incidents_counter").remove()}if(h){e();h=!1}})},3e3)}}}});
//# sourceMappingURL=incident_notifier.min.js.map
