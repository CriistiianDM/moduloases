'use strict';define(['jquery','block_ases/loading_indicator','block_ases/sweetalert','block_ases/jscookie'],function(a,b,c,d){function e(m){a.ajax({type:'POST',url:'../managers/incident_manager/incident_api.php',data:JSON.stringify({'function':'get_ids_open_incidents',params:[]}),contentType:'application/json; charset=utf-8',dataType:'json',async:!1,success:function success(n){'function'==typeof m&&m(n.data_response)},failure:function failure(){}})}function f(m){0<m?a('title').text('('+m+') '+j):a('title').text(j)}function g(){if('true'==d.get('beep')){var m='notification_sound';document.getElementById('notification_sound').innerHTML='<audio autoplay="autoplay">'+('<source src="../resources/'+m+'.mp3" type="audio/mpeg">')+('<source src="../resources/'+m+'.ogg" type="audio/ogg">')+('<embed hidden="true" autostart="true" loop="false" src="../resources/'+m+'.mp3">')+'</audio>',d.set('beep','false')}}var h=!1,i=[],j=a('title').text();return a('html').append('<div id="notification_sound" style="display:none;"></div>'),console.log('Incident notifier initialised'),{init:function init(){e(function(m){var n=m.length;if(f(n),0<n){h=!0,m.forEach(function(p){i.push(p.id)});var o=a('#menu_incidents_manager').find('.menu_a');o.append(' <span id="incidents_counter" class="badge badge-secondary">'+m.length+'</span>')}}),setInterval(function(){e(function(m){var n=!1,o=m.length;if(f(o),0<o&&!h){h=!0,n=!0,d.set('beep',n);var p=a('#menu_incidents_manager').find('.menu_a');p.append(' <span id="incidents_counter" class="badge badge-secondary">'+m.length+'</span>')}else if(0<o&&h){var q=!1,r=[];m.forEach(function(s){r.push(s.id),-1===i.indexOf(s.id)&&(q=!0)}),q&&(i=r,n=!0,d.set('beep',n),a('#incidents_counter').text(m.length))}else 0===o&&a('#incidents_counter').remove();n&&(g(),n=!1)})},3e3)}}});