{"version":3,"sources":["../src/monitorias_academicas_detalle.js"],"names":["define","$","dataTables","buttons","html5","flash","print","gmm","select2","jqueryui","loading_indicator","construir_tabla","data","html","fadeIn","append","DataTable","monitoria_id","URLSearchParams","window","location","search","get","init","datepicker","setDefaults","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","firstDay","isRTL","showMonthAfterYear","yearSuffix","showWeek","dateFormat","Date","click","toggleClass","toggle","submit","consultar_sesiones_por_fecha","init_despues_de_tabla","e","fecha","target","parent","find","innerHTML","swal","title","text","type","showCancelButton","confirmButtonText","isConfirmed","console","log","id","ajax","JSON","stringify","url","dataType","success","error","msg","formatear_date_a_int","date","appendLeading0","a","toString","parseInt","getFullYear","getMonth","getDate","preventDefault","show","desde","hasta","hide","data_response","responseText"],"mappings":"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","sourcesContent":["// Standard license block omitted.\r\n/*\r\n * @package    block_ases\r\n * @copyright  ASES\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n/**\r\n * @module block_ases/monitorias_academicas_detalle\r\n */\r\ndefine(['jquery',\r\n    'block_ases/jquery.dataTables',\r\n    'block_ases/dataTables.buttons',\r\n    'block_ases/buttons.html5',\r\n    'block_ases/buttons.flash',\r\n    'block_ases/buttons.print',\r\n    'block_ases/_general_modal_manager',\r\n    'block_ases/select2',\r\n    'block_ases/jqueryui',\r\n    'block_ases/loading_indicator',\r\n    'block_ases/sweetalert',\r\n],\r\n    function ($, dataTables, buttons, html5, flash, print,  gmm, select2, jqueryui, loading_indicator, sweetalert) {\r\n        function construir_tabla(data){\r\n            $(\"#div_table\").html('');\r\n            $(\"#div_table\").fadeIn(500).append('<table id=\"tableResult\" class=\"stripe row-border order-column\" cellspacing=\"0\" width=\"100%\"><thead> </thead></table>');\r\n            $(\"#tableResult\").DataTable(data);\r\n        }\r\n        const monitoria_id = (new URLSearchParams(window.location.search)).get(\"monitoriaid\");\r\n        return {\r\n            init: function () {\r\n                 // datepickers\r\n                $.datepicker.setDefaults({\r\n                    closeText: \"Cerrar\",\r\n                    prevText: \"&#x3C;Ant\",\r\n                    nextText: \"Sig&#x3E;\",\r\n                    currentText: \"Hoy\",\r\n                    monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\r\n                    \"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],\r\n                    monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\r\n                    \"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],\r\n                    dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],\r\n                    dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],\r\n                    dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],\r\n                    weekHeader: \"Sm\",\r\n                    firstDay: 1,\r\n                    isRTL: false,\r\n                    showMonthAfterYear: false,\r\n                    yearSuffix: \"\" });\r\n                $(\"#fecha_hasta\").datepicker({\r\n                    showWeek: true,\r\n                    dateFormat: \"dd/M/y\",\r\n                });\r\n                $(\"#fecha_desde\").datepicker({\r\n                    showWeek: true,\r\n                    dateFormat: \"dd/M/y\",\r\n                });\r\n                $(\"#fecha_desde\").datepicker(\"setDate\", new Date());\r\n                // filtrar\r\n                $(\"#desplegar-filtrar\").click(() => {\r\n                    $(\"#flecha\").toggleClass(\"abajo\");\r\n                    $(\"#rango-fechas-sesiones\").toggle(300);\r\n                });\r\n                $(\"#rango-fechas-sesiones\").submit(consultar_sesiones_por_fecha);\r\n            },\r\n            construir_tabla: construir_tabla,\r\n            init_despues_de_tabla: function (){\r\n                // cancelar sesion\r\n                $(\".dt-button.buttons-print.eliminar\").click(function (e) {\r\n                    let fecha = $(e.target).parent().parent().parent().find(\"td\")[0].innerHTML;\r\n                    swal({\r\n                        title: 'Cancelar sesión',\r\n                        text: \"¿Deseas cancelar la sesión programada el \"+fecha+\"?\",\r\n                        type: 'warning',\r\n                        showCancelButton: true,\r\n                        confirmButtonText: 'Eliminar'\r\n                    }, function (isConfirmed) {\r\n                        if (isConfirmed) {\r\n                            console.log(e.target.id)\r\n                            $.ajax({\r\n                                type: \"POST\",\r\n                                data: JSON.stringify({\r\n                                    \"function\": 'eliminar_sesion',\r\n                                    \"params\": e.target.id,\r\n                                }),\r\n                                url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n                                dataType: \"json\",\r\n                                success: function(msg) {\r\n                                    consultar_sesiones_por_fecha();    \r\n                                },\r\n                                error : function(msg) {\r\n                                    swal('Error!', msg, 'error')\r\n                                    console.log(msg)\r\n                                },\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    function formatear_date_a_int(date){\r\n        function appendLeading0(a){ return a < 10 ? \"0\"+a.toString() : a.toString()};\r\n        return parseInt(date.getFullYear().toString()+appendLeading0(date.getMonth()+1)+appendLeading0(date.getDate()))\r\n    }\r\n    // TODO: poner como fechas iniciales hoy y 9999999\r\n    function consultar_sesiones_por_fecha(e){\r\n        e.preventDefault();\r\n        loading_indicator.show();\r\n        var desde = formatear_date_a_int($(\"#fecha_desde\").datepicker(\"getDate\"));\r\n        var hasta = formatear_date_a_int($(\"#fecha_hasta\").datepicker(\"getDate\"));\r\n        console.log(desde+\" \"+hasta);\r\n        console.log(monitoria_id);\r\n        $.ajax({\r\n            type: \"POST\",\r\n            data: JSON.stringify({\r\n                \"function\": \"get_tabla_sesiones\",\r\n                \"params\": [monitoria_id, desde, hasta],\r\n            }),\r\n            url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\r\n            dataType: \"json\",\r\n            success: function(msg) {\r\n                loading_indicator.hide();\r\n                construir_tabla(msg.data_response);\r\n            },\r\n            error: function(msg) {\r\n                console.log(\"Error insercion bd de monitoria en backend\");\r\n                $(\"#debug\").html(msg.responseText);\r\n            }\r\n        });\r\n    }\r\n    }\r\n);"],"file":"monitorias_academicas_detalle.min.js"}