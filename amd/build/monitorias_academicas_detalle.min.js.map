{"version":3,"sources":["../src/monitorias_academicas_detalle.js"],"names":["define","$","dataTables","buttons","html5","flash","print","gmm","select2","jqueryui","loading_indicator","construir_tabla","data","html","fadeIn","append","DataTable","monitoria_id","URLSearchParams","window","location","search","get","init","datepicker","setDefaults","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","firstDay","isRTL","showMonthAfterYear","yearSuffix","showWeek","dateFormat","click","toggleClass","toggle","submit","consultar_sesiones_por_fecha","init_despues_de_tabla","e","fecha","target","parent","find","innerHTML","swal","title","text","type","showCancelButton","confirmButtonText","isConfirmed","console","log","id","ajax","JSON","stringify","url","dataType","success","error","msg","formatear_date_a_int","date","appendLeading0","a","toString","parseInt","getFullYear","getMonth","getDate","preventDefault","show","desde","hasta","hide","data_response","responseText"],"mappings":"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","sourcesContent":["// Standard license block omitted.\n/*\n * @package    block_ases\n * @copyright  ASES\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n/**\n * @module block_ases/asistencia_monitorias_detalle\n */\ndefine(['jquery',\n    'block_ases/jquery.dataTables',\n    'block_ases/dataTables.buttons',\n    'block_ases/buttons.html5',\n    'block_ases/buttons.flash',\n    'block_ases/buttons.print',\n    'block_ases/_general_modal_manager',\n    'block_ases/select2',\n    'block_ases/jqueryui',\n    'block_ases/loading_indicator',\n    'block_ases/sweetalert',\n],\n    function ($, dataTables, buttons, html5, flash, print,  gmm, select2, jqueryui, loading_indicator, sweetalert) {\n        function construir_tabla(data){\n            $(\"#div_table\").html('');\n            $(\"#div_table\").fadeIn(500).append('<table id=\"tableResult\" class=\"stripe row-border order-column\" cellspacing=\"0\" width=\"100%\"><thead> </thead></table>');\n            $(\"#tableResult\").DataTable(data);\n        }\n        const monitoria_id = (new URLSearchParams(window.location.search)).get(\"monitoriaid\");\n        return {\n            init: function () {\n                 // datepickers\n                $.datepicker.setDefaults({\n                    closeText: \"Cerrar\",\n                    prevText: \"&#x3C;Ant\",\n                    nextText: \"Sig&#x3E;\",\n                    currentText: \"Hoy\",\n                    monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\n                    \"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],\n                    monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\n                    \"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],\n                    dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],\n                    dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],\n                    dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],\n                    weekHeader: \"Sm\",\n                    firstDay: 1,\n                    isRTL: false,\n                    showMonthAfterYear: false,\n                    yearSuffix: \"\" });\n                $(\"#fecha_hasta\").datepicker({\n                    showWeek: true,\n                    dateFormat: \"dd/M/y\",\n                });\n                $(\"#fecha_desde\").datepicker({\n                    showWeek: true,\n                    dateFormat: \"dd/M/y\",\n                });\n                // filtrar\n                $(\"#desplegar-filtrar\").click(() => {\n                    $(\"#flecha\").toggleClass(\"abajo\");\n                    $(\"#rango-fechas-sesiones\").toggle(300);\n                });\n                $(\"#rango-fechas-sesiones\").submit(consultar_sesiones_por_fecha);\n            },\n            construir_tabla: construir_tabla,\n            init_despues_de_tabla: function (){\n                // cancelar sesion\n                $(\".dt-button.buttons-print.eliminar\").click(function (e) {\n                    let fecha = $(e.target).parent().parent().parent().find(\"td\")[0].innerHTML;\n                    swal({\n                        title: 'Cancelar sesión',\n                        text: \"¿Deseas cancelar la sesión programada el \"+fecha+\"?\",\n                        type: 'warning',\n                        showCancelButton: true,\n                        confirmButtonText: 'Eliminar'\n                    }, function (isConfirmed) {\n                        if (isConfirmed) {\n                            console.log(e.target.id)\n                            $.ajax({\n                                type: \"POST\",\n                                data: JSON.stringify({\n                                    \"function\": 'eliminar_sesion',\n                                    \"params\": e.target.id,\n                                }),\n                                url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\n                                dataType: \"json\",\n                                success: function(msg) {\n                                    consultar_sesiones_por_fecha();    \n                                },\n                                error : function(msg) {\n                                    swal('Error!', msg, 'error')\n                                    console.log(msg)\n                                },\n                            });\n                        }\n                    });\n                });\n            }\n        }\n    function formatear_date_a_int(date){\n        function appendLeading0(a){ return a < 10 ? \"0\"+a.toString() : a.toString()};\n        return parseInt(date.getFullYear().toString()+appendLeading0(date.getMonth()+1)+appendLeading0(date.getDate()))\n    }\n    // TODO: poner como fechas iniciales hoy y 9999999\n    function consultar_sesiones_por_fecha(e){\n        e.preventDefault();\n        loading_indicator.show();\n        var desde = formatear_date_a_int($(\"#fecha_desde\").datepicker(\"getDate\"));\n        var hasta = formatear_date_a_int($(\"#fecha_hasta\").datepicker(\"getDate\"));\n        console.log(desde+\" \"+hasta);\n        console.log(monitoria_id);\n        $.ajax({\n            type: \"POST\",\n            data: JSON.stringify({\n                \"function\": \"get_tabla_sesiones\",\n                \"params\": [monitoria_id, desde, hasta],\n            }),\n            url: \"../managers/asistencia_monitorias/asistencia_monitorias_api.php\",\n            dataType: \"json\",\n            success: function(msg) {\n                loading_indicator.hide();\n                construir_tabla(msg.data_response);\n            },\n            error: function(msg) {\n                console.log(\"Error insercion bd de monitoria en backend\");\n                $(\"#debug\").html(msg.responseText);\n            }\n        });\n    }\n    }\n);"],"file":"monitorias_academicas_detalle.min.js"}