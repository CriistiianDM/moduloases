define(["jquery","block_ases/bootstrap","block_ases/datatables.net","block_ases/datatables.net-buttons","block_ases/buttons.flash","block_ases/jszip","block_ases/pdfmake","block_ases/buttons.html5","block_ases/buttons.print","block_ases/sweetalert","block_ases/select2","block_ases/jqueryui"],function(e,n,a,s,r,t,o,i,d,l,c,p){return{init:function(){function n(n,a){var s=n;s||(s=e("#periods").val()),e.ajax({type:"POST",data:{dat:s},url:"../managers/periods_management/search_period_processing.php",success:function(n){a?a(n):n.error?(swal("Error",n.error,"error"),e(".assignment_li").addClass("hidden"),e("#periods").val("").trigger("change.select2"),e("#periods").prop("disabled",!1),e("#semester_name").val(""),e("#search_button").prop("disabled",!1)):""==n.nombre?(swal("Error","El semestre no existe en la base de datos","error"),e("#periods").prop("disabled",!1)):(e(".assignment_li").removeClass("hidden"),e("#semester_name").val(n.nombre),e("#beginning_date").val(n.fecha_inicio),e("#ending_date").val(n.fecha_fin))},dataType:"json",error:function(n){swal("Error","Hay un error con la conexión","error"),e(".assignment_li").addClass("hidden"),e("#periods").val("").trigger("change.select2"),e("#periods").prop("disabled",!1),e("#semester_name").val(" "),e("#search_button").prop("disabled",!1)}})}function a(){var n=e("#periods").val(),a=e("#semester_name").val(),s=e("#beginning_date").val(),r=e("#ending_date").val(),o=t(n,a,s,r);"success"!=o?swal({title:"Advertencia",text:o,type:"warning",html:!0}):e.ajax({type:"POST",data:{id:n,name:a,beginning:s,ending:r},url:"../managers/periods_management/update_period_processing.php",success:function(e){swal({title:"Información",text:e,type:"info",html:!0,confirmButtonColor:"#d51b23",confirmButtonText:"OK",closeOnConfirm:!0})},dataType:"text",cache:"false",error:function(e){swal("Error","Ha ocurrido un error","error")}})}function s(){e.ajax({type:"POST",data:{load:"loadSemester"},url:"../managers/periods_management/load_periods_processing.php",success:function(n){e("#div_periods").empty(),e("#div_periods").append('<table id="tablePeriods" class="display" cellspacing="0" width="100%"><thead><thead></table>');e("#tablePeriods").DataTable(n);e("#div_periods").css("cursor","pointer")},dataType:"json",cache:!1,error:function(e){alert("Error al cargar períodos")}})}function r(){var n=e("#new_semester_name").val(),a=e("#new_beginning_date").val(),s=e("#new_ending_date").val(),r=o(n,a,s);"success"!=r?swal({title:"Advertencia",text:r,type:"warning",html:!0}):e.ajax({type:"POST",data:{op:"createSemester",name:n,beginning:a,ending:s},url:"../managers/periods_management/create_period_processing.php",success:function(e){swal({title:"Información",text:e,type:"info",html:!0,confirmButtonColor:"#d51b23",confirmButtonText:"OK",closeOnConfirm:!0})},dataType:"text",cache:"false",error:function(e){swal("Error","Ha ocurrido un error","error")}})}function t(e,n,a,s){var r=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,t=r.exec(a),o=r.exec(s);return""==n&&""==a&&""==s?"Debe llenar todos los campos":""==a||""==s?"Debe introducir la fecha de inicio y fin del período":null===t?"La fecha de inicio no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":null===o?"La fecha de fin no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":a==s?"La fecha de inicio y de fin deben ser diferentes":""==e?"Se encontró un problema con el identificador del semestre, vuelva a seleccionar el semestre":""==n?"Debe ingresar el nombre del semestre":"success"}function o(e,n,a){var s=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,r=s.exec(n),t=s.exec(a);return""==e&&""==n&&""==a?"Debe llenar todos los campos":""==n||""==a?"Debe introducir la fecha de inicio y fin del período":null===r?"La fecha de inicio no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":null===t?"La fecha de fin no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":n==a?"La fecha de inicio y de fin deben ser diferentes":""==e?"Debe ingresar el nombre del semestre":"success"}e("#periods").select2({language:{noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando..."}},dropDownAutoWidth:!0}),e(document).ready(function(){e(".assignment_li").css({display:"none"}),e(".period_date").datepicker({dateFormat:"yy-mm-dd"}),e("#search_button").on("click",function(){e("#search_button").prop("disabled",!0),n(),e("#periods").prop("disabled",!0),e(".assignment_li").slideToggle("fast")}),e("#ok-button").on("click",function(){a(),e(".assignment_li").addClass("hidden"),e("#periods").val("").trigger("change.select2"),e("#periods").prop("disabled",!1),e("#search_button").prop("disabled",!1),e("#semester_name").val(" "),e("#beginning_date").val(" "),e("#ending_date").val(" ")}),e("#cancel-button").on("click",function(){e(".assignment_li").addClass("hidden"),e("#periods").val("").trigger("change.select2"),e("#periods").prop("disabled",!1),e("#search_button").prop("disabled",!1),e("#semester_name").val(" "),e("#beginning_date").val(" "),e("#ending_date").val(" ")}),e("#save-button").on("click",function(){r(),e("#new_semester_name").val(" "),e("#new_beginning_date").val(" "),e("#new_ending_date").val(" ")}),e("#cancel-save-button").on("click",function(){e("#new_semester_name").val(" "),e("#new_beginning_date").val(" "),e("#new_ending_date").val(" ")}),e("#list-periods-panel").on("click",function(){s()})})}}});