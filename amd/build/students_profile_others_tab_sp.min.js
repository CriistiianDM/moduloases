define(["jquery","block_ases/jszip","block_ases/jquery.dataTables","block_ases/dataTables.autoFill","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(t,e,a,s,o,n,c,l,r,u,_,p){return{init:function(){var e=t("#id_ases").val();function a(){let e={},i=[],a={},s=0;return t(".table_aspectos_instituciones tr").find(":input").each(function(){s++,"name_institucion"==t(this).attr("name")&&(a.name_institution=t(this).val()),"nivel_academico_institucion"==t(this).attr("name")&&(a.academic_level=t(this).val()),"apoyos_institucion"==t(this).attr("name")&&(a.supports=t(this).val()),4==s&&(i.push(a),a={},s=0)}),e.current_resolution=t("#current_resolution").val(),e.total_time=t("#total_time").val(),e.previous_academic_title=t("#titulo_academico").val(),e.others_institutions=i,e.academics_observations=t("#textarea_academics_observaciones").val(),e.academics_dificults=t("#textarea_academics_dificultades").val(),e}function s(){var e=new Object;return e.title="Éxito",e.msg="El formulario fue validado con éxito",e.status="success",t("#collapse_add_academics input[type=number]").each(function(){let i=t(this).val(),a=t(this).attr("placeholder");if("total_time"==t(this).attr("id")&&(i<0||i>999))return e.title="Datos académicos (créditos totales)",e.status="error",e.msg="El campo "+a+" es obligatorio",e}),e}function o(){let e=[],a={key_input:"#estrato_socioeconomico",val_input:t("#estrato_socioeconomico").val()};e.push(a);let s={};t("#collapse_econo input[type=checkbox]").not(".check_solvencia").each(function(){s.key_input=t(this).attr("id"),t(this).is(":checked")?(s.val_input=1,t(this).parent().next().children().children("input").each(function(){let e=t(this).attr("type");"text"==e&&(s.key_input_text=t(this).attr("id"),s.val_input_text=t(this).val()),"number"==e&&(s.key_input_number=t(this).attr("id"),s.val_input_number=t(this).val())})):s.val_input=0,e.push(s),s={}});let o={key_input:"#check_solvencia"};t("#check_solvencia").is(":checked")?o.val_input=1:o.val_input=0,e.push(o);let n={},c=[],l=[],r=[];for(obj=document.getElementById("div_info_padre"),i=0;ele=obj.getElementsByTagName("select")[i];i++)n.key_select=ele.id,n.val_select=ele.value,"select_nivel_padre"==ele.id&&c.push(n),"select_ocupacion_padre"==ele.id&&("option_ninguna"!=ele.value&&(n.key_input_select="#"+t("#"+ele.id).parent().next().children("input").attr("id"),n.val_input_select=t("#"+ele.id).parent().next().children("input").val(),n.title_select=ele.title),l.push(n)),"select_situa_padre"==ele.id&&r.push(n),n={};for(obj=document.getElementById("div_info_madre"),i=0;ele=obj.getElementsByTagName("select")[i];i++)n.key_select=ele.id,n.val_select=ele.value,"select_nivel_madre"==ele.id&&c.push(n),"select_ocupacion_madre"==ele.id&&("option_ninguna"!=ele.value&&(n.key_input_select="#"+t("#"+ele.id).parent().next().children("input").attr("id"),n.val_input_select=t("#"+ele.id).parent().next().children("input").val(),n.title_select=ele.title),l.push(n)),"select_situa_madre"==ele.id&&r.push(n),n={};e.push(l),e.push(c),e.push(r);let u={key_input:"#textarea_expectativas",val_input:t("#textarea_expectativas").val()};return e.push(u),e}function n(){var e=new Object;if(e.title="Éxito",e.msg="El formulario fue validado con éxito",e.status="success",t("#collapse_econo input[type=checkbox]").not(".check_solvencia").each(function(){t(this).is(":checked")&&t(this).parent().next().children().children("input").each(function(){let i=t(this).val(),a=t(this).attr("id"),s=t(this).attr("type");if(""==i)return e.title="Datos económicos",e.status="error",e.msg="El campo "+a+" es obligatorio",e;if("number"==s){if(Number.isNaN(i))return e.title="Datos económicos",e.status="error",e.msg="El campo "+a+" debe ser numérico",e;if(i<0)return e.title="Datos económicos",e.status="error",e.msg="El campo "+a+" no debe ser negativo",e}})}),""==t("#estrato_socioeconomico").val()){let t="estrato_socioeconomico";return e.title="Datos económicos",e.status="error",e.msg="El campo "+t+" es obligatorio y debe ser número entero",e}{let i=t("#estrato_socioeconomico").val(),a="estrato_socioeconomico";if(i<1||i>6||i%1!=0)return e.title="Datos económicos",e.status="error",e.msg="El campo "+a+" corresponde a estratos sociales (Del 1 al 6)",e}if("option_ninguna"!=t("#select_ocupacion_madre").val()){let i="input_ocupacion_madre";if(""==t("#input_ocupacion_madre").val())return e.title="Datos económicos",e.status="error",e.msg="El campo "+i+" es obligatorio",e}if("option_ninguna"!=t("#select_ocupacion_padre").val()){let i="input_ocupacion_padre";if(""==t("#input_ocupacion_padre").val())return e.title="Datos económicos",e.status="error",e.msg="El campo "+i+" es obligatorio",e}return e}function c(){let e=[],i=t("#opciones_regimen_salud").find(":input[type=radio]:checked").val(),a={key_input:t("#opciones_regimen_salud").find(":input[type=radio]:checked").attr("id"),val_input:i},s=t("#opciones_servicio_salud").find(":input[type=radio]:checked").val(),o={key_input:t("#opciones_servicio_salud").find(":input[type=radio]:checked").attr("id"),val_input:s,val_input_text:t("#input_detalle_servicio").val(),key_input_text:"input_detalle_servicio"},n=[],c={};return t("#options_services input[type=checkbox]").each(function(){c.key_input=t(this).attr("id"),t(this).is(":checked")?(c.val_input=1,"check_servicio_otro"==c.key_input&&(c.key_input_text="servicio_otro_cual",c.val_input_text=t("#servicio_otro_cual").val())):c.val_input=0,n.push(c),c={}}),e.push(a),e.push(o),e.push(n),e}function l(){var e=new Object;if(e.title="Éxito",e.msg="El formulario fue validado con éxito",e.status="success",t("#check_servicio_otro").is(":checked")){let i=t("#servicio_otro_cual").val(),a="Otro servicio";if(""==i)return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" es obligatorio",e;if(u(i))return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" no debe contener números",e}if(null==t("#opciones_regimen_salud").find(":input[type=radio]:checked").val()){let t="Régimen de salud";return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+t+" es obligatorio",e}let i=t("#opciones_servicio_salud").find(":input[type=radio]:checked").val();if(null==i){let t="Servicio de salud";return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+t+" es obligatorio",e}{let a,s=t("#input_detalle_servicio").val();switch(i){case"input_radio_eps":if(a="¿Cuál EPS?",""==s)return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" es obligatorio",e;if(u(s))return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" no debe contener números",e;break;case"input_radio_sisben":if(a="¿Cuál Nivel?",""==s)return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" es obligatorio y numérico",e;if(s<1||s>3)return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" corresponde a niveles válidos de SISBEN (1,2,3)",e;break;case"input_radio_otro_servicio":if(a="¿Cuál servicio de salud?",""==s)return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" es obligatorio",e;if(u(s))return e.title="Datos de servicios de salud",e.status="error",e.msg="El campo "+a+" no debe contener números",e}}return e}function r(e,i,a,s,o,n){1==i?(t("#"+e).prop("checked",!0),t("#"+a).val(s),t("#"+a).parent().parent().show(),t("#"+o).val(n)):(t("#"+e).prop("checked",!1),t("#"+a).val(""),t("#"+a).parent().parent().hide(),t("#"+o).val(""))}function u(t){for(i=0;i<t.length;i++)if(-1!="0123456789".indexOf(t.charAt(i),0))return 1;return 0}function _(){var t=location.search.split("&");for(x in t){if(t[x].indexOf("instanceid")>=0)return t[x].split("=")[1]}return 0}function p(){var t=location.search.split("&");for(x in t){if(t[x].indexOf("courseid")>=0)return t[x].split("=")[1]}return 0}t("#edit_health_data").click(function(){let i=l();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=c();(function(e,i){let a=t("#input_json_health_saved").val();t.ajax({type:"POST",data:{func:"edit_health_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:820},"slow"),t("#input_health_saved").attr("value","1"),t("#input_json_health_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})})(i=JSON.stringify(i),e)}}),t("#save_health_data").click(function(){let i=l();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=c();(function(e,i){let a=t("#input_json_health_saved").val();t.ajax({type:"POST",data:{func:"save_health_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:820},"slow"),t("#save_health_data").parent().hide(),t("#edit_health_data").parent().show(),t("#input_health_saved").attr("value","1"),t("#input_json_health_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})})(i=JSON.stringify(i),e)}}),"0"==t("#input_health_saved").val()&&t("#save_health_data").parent().show(),"1"==t("#input_health_saved").val()&&(t("#save_health_data").parent().hide(),t("#edit_health_data").parent().show(),function(){let e,a,s,o,n=JSON.parse(t("#input_json_health_saved").val());for(i in n)switch(i){case"regimen_salud":o=JSON.parse(n[i]),t("#"+o.key_input).prop("checked",!0);break;case"servicio_salud_vinculado":o=JSON.parse(n[i]),e=o.key_input,a=o.key_input_text,s=o.val_input_text,t("#"+e).prop("checked",!0),t("#"+a).val(s),t("#"+a).parent().show(),"input_radio_sisben"==e&&(t("#"+a).attr("title","Escriba Nivel"),t("#"+a).attr("type","number"),t("#"+a).attr("min","1"),t("#"+a).attr("max","3")),"input_radio_eps"==e?(t("#"+a).attr("title","Escriba EPS"),t("#"+a).attr("placeholder","¿Cuál EPS?"),t("#"+a).attr("type","text")):"input_radio_otro_servicio"==e&&(t("#"+a).attr("title","Escriba otro servicio"),t("#"+a).attr("placeholder","¿Cuál servicio de salud?"),t("#"+a).attr("type","text"));break;case"servicios_usados":for(objeto in o=JSON.parse(n[i]))1==o[objeto].val_input?(t("#"+o[objeto].key_input).prop("checked",!0),"check_servicio_otro"==o[objeto].key_input&&(t("#"+o[objeto].key_input_text).val(o[objeto].val_input_text),t("#"+o[objeto].key_input_text).parent().show())):(t("#"+o[objeto].key_input).prop("checked",!1),"check_servicio_otro"==o[objeto].key_input&&(t("#servicio_otro_cual").val(""),t("#servicio_otro_cual").parent().hide()))}}()),t("#check_servicio_otro").click(function(){t(this).is(":checked")?(t("#servicio_otro_cual").parent().show(),t("#servicio_otro_cual").prop("required",!0)):(t("#servicio_otro_cual").parent().hide(),t("#servicio_otro_cual").prop("required",!1),t("#servicio_otro_cual").val(""))}),t(".servicio_salud").click(function(){"input_radio_eps"==t(this).val()?(t("#input_detalle_servicio").attr("title","Escriba EPS"),t("#input_detalle_servicio").attr("placeholder","¿Cuál EPS?"),t("#input_detalle_servicio").attr("type","text")):"input_radio_sisben"==t(this).val()?(t("#input_detalle_servicio").attr("title","Escriba Nivel"),t("#input_detalle_servicio").attr("placeholder","¿Cuál Nivel?"),t("#input_detalle_servicio").attr("type","number"),t("#input_detalle_servicio").attr("min","1"),t("#input_detalle_servicio").attr("max","3")):"input_radio_otro_servicio"==t(this).val()&&(t("#input_detalle_servicio").attr("title","Escriba otro servicio"),t("#input_detalle_servicio").attr("placeholder","¿Cuál servicio de salud?"),t("#input_detalle_servicio").attr("type","text")),t("#input_detalle_servicio").parent().show(),t("#input_detalle_servicio").attr("required",!0),t("#input_detalle_servicio").val("")}),"0"==t("#input_economics_saved").val()&&t("#save_economics_data").parent().show(),"1"==t("#input_economics_saved").val()&&(t("#save_economics_data").parent().hide(),t("#edit_economics_data").parent().show(),function(){let e,a,s,o,n,c,l,u=JSON.parse(t("#input_json_economics_saved").val());for(i in u)switch(i){case"estrato":t("#estrato_socioeconomico").val(u[i]);break;case"prestacion_economica":case"beca":case"ayuda_transporte":case"ayuda_materiales":l=JSON.parse(u[i]),e=l.key_input,a=l.val_input,s=l.key_input_text,o=l.val_input_text,n=l.key_input_number,c=l.val_input_number,r(e,a,s,o,n,c);break;case"solvencia_econo":1==(a=u[i])?t("#check_solvencia").prop("checked",!0):t("#check_solvencia").prop("checked",!1);break;case"ocupacion_padres":for(objeto in l=JSON.parse(u[i]))"option_ninguna"==l[objeto].val_select?t("#"+l[objeto].key_select).val(l[objeto].val_select):(t("#"+l[objeto].key_select).val(l[objeto].val_select),t("#"+l[objeto].key_select).attr("title",l[objeto].title_select),t(l[objeto].key_input_select).val(l[objeto].val_input_select),t(l[objeto].key_input_select).parent().show());break;case"nivel_educ_padres":case"situa_laboral_padres":for(objeto in l=JSON.parse(u[i]))t("#"+l[objeto].key_select).val(l[objeto].val_select);break;case"expectativas_laborales":l=JSON.parse(u[i]),t(l.key_input).val(l.val_input)}}()),t("#collapse_econo input[type=checkbox]").not(".check_solvencia").on("change",function(){t(this).is(":checked")?(t(this).parent().next().show(),t(this).parent().next().children().children("input").prop("required",!0)):(t(this).parent().next().hide(),t(this).parent().next().children().children("input").prop("required",!1),t(this).parent().next().children().children("input").val(""))}),t(".select_ocupacion").on("change",function(){if("option_ninguna"==t(this).val())t(this).parent().next().hide(),t(this).parent().next().children("input").prop("required",!1),t(this).parent().next().children("input").val("");else{t(this).parent().next().show(),t(this).parent().next().children("input").prop("required",!0);let e=document.getElementById(t(this).attr("id"));t(this).attr("title",e.options[e.selectedIndex].title)}}),t("#save_economics_data").click(function(){let i=n();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=o();(function(e,i){let a=t("#input_json_economics_saved").val();t.ajax({type:"POST",data:{func:"save_economics_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:700},"slow"),t("#save_economics_data").parent().hide(),t("#edit_economics_data").parent().show(),t("#input_economics_saved").attr("value","1"),t("#input_json_economics_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})})(i=JSON.stringify(i),e)}}),t("#edit_economics_data").click(function(){let i=n();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=o();(function(e,i){let a=t("#input_json_economics_saved").val();t.ajax({type:"POST",data:{func:"edit_economics_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:700},"slow"),t("#input_economics_saved").attr("value","1"),t("#input_json_economics_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})})(i=JSON.stringify(i),e)}}),"0"==t("#input_academics_saved").val()&&t("#save_academics_data").parent().show(),"1"==t("#input_academics_saved").val()&&(t("#save_academics_data").parent().hide(),t("#edit_academics_data").parent().show()),t("#save_academics_data").click(function(){let i=s();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=a();console.log(i),function(e,i){let a=t("#input_json_academics_saved").val();t.ajax({type:"POST",data:{func:"save_academics_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:700},"slow"),t("#save_academics_data").parent().hide(),t("#edit_academics_data").parent().show(),t("#input_academics_saved").attr("value","1"),t("#input_json_academics_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})}(i=JSON.stringify(i),e)}}),t("#edit_academics_data").click(function(){let i=s();if("error"==i.status)swal(i.title,i.msg,i.status);else{let i=a();(function(e,i){let a=t("#input_json_academics_saved").val();t.ajax({type:"POST",data:{func:"edit_academics_data",json:e,json_prev:a,instanceid:_(),courseid:p(),ases:i},url:"../managers/student_profile/others_tab_api.php",success:function(i){swal({title:i.title,text:i.msg,type:i.status},function(){t("html, body").animate({scrollTop:820},"slow"),t("#input_academics_saved").attr("value","1"),t("#input_json_academics_saved").attr("value",e)})},dataType:"json",cache:"false",error:function(t){swal(t.title,t.msg,t.status)}})})(i=JSON.stringify(i),e)}}),t(document).on("click","#table_aspectos_instituciones tbody tr td button",function(){t(this).parent().parent().remove()}),t("#bt_add_institucion").click(function(){let e="";e+='<tr><td> <input name="name_institucion" class="input_fields_general_tab"  type="text"/></td>',e+='<td> <input name="nivel_academico_institucion" class="input_fields_general_tab"  type="text" /></td>',e+='<td> <input name="apoyos_institucion" class="input_fields_general_tab"  type="text" /></td>',e+='<td> <button type ="button" id="bt_delete_institucion" title="Eliminar institución" name="btn_delete_person" style="visibility:visible;"> </button></td> </tr>',t("#table_aspectos_instituciones").find("tbody").append('<tr><td> <input name="name_institucion" class="input_fields_general_tab"  type="text"/></td><td> <input name="nivel_academico_institucion" class="input_fields_general_tab"  type="text" /></td><td> <input name="apoyos_institucion" class="input_fields_general_tab"  type="text" /></td><td> <button type ="button" id="bt_delete_institucion" title="Eliminar institución" name="btn_delete_person" style="visibility:visible;"> </button></td> </tr>')})}}});