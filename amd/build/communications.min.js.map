{"version":3,"sources":["../src/communications.js"],"names":["define","$","init","on","send_email","attr","select2","language","noResults","searching","dropdownAutoWidth","getIdcourse","urlParameters","location","search","split","x","indexOf","intanceparameter","to_users","document","getElementById","value","cohortes","val","subject","message","course_id","console","log","ajax","type","data","JSON","stringify","url","dataType","cache","success","msg","status_code","swal","title","error"],"mappings":"AASAA,OAAM,6BAAC,CAAC,QAAD,CAAW,oBAAX,CAAD,CAAoC,SAASC,CAAT,CAAoB,CAE1D,MAAO,CACHC,IAAI,CAAE,eAAY,CACdD,CAAC,CAAC,cAAD,CAAD,CAAkBE,EAAlB,CAAqB,OAArB,CAA8BC,CAA9B,EACAH,CAAC,CAAC,aAAD,CAAD,CAAiBI,IAAjB,CAAsB,UAAtB,KAEAJ,CAAC,CAAC,aAAD,CAAD,CAAiBK,OAAjB,CAAyB,CAErBC,QAAQ,CAAE,CAENC,SAAS,CAAE,oBAAW,CAElB,MAAO,kBACV,CALK,CAMNC,SAAS,CAAE,oBAAW,CAElB,MAAO,YACV,CATK,CAFW,CAarBC,iBAAiB,GAbI,CAAzB,CAeH,CApBE,CAAP,CAuBA,QAASC,CAAAA,CAAT,EAAuB,CACnB,GAAIC,CAAAA,CAAa,CAAGC,QAAQ,CAACC,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,CAApB,CAEA,IAAKC,CAAL,GAAUJ,CAAAA,CAAV,CAAyB,CACrB,GAA4C,CAAxC,EAAAA,CAAa,CAACI,CAAD,CAAb,CAAiBC,OAAjB,CAAyB,UAAzB,CAAJ,CAA+C,CAC3C,GAAIC,CAAAA,CAAgB,CAAGN,CAAa,CAACI,CAAD,CAAb,CAAiBD,KAAjB,CAAuB,GAAvB,CAAvB,CACA,MAAOG,CAAAA,CAAgB,CAAC,CAAD,CAC1B,CACJ,CACD,MAAO,EACV,CAED,QAASd,CAAAA,CAAT,EAAsB,IAEde,CAAAA,CAAQ,CAAGC,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4CC,KAFzC,CAGdC,CAAQ,CAAGtB,CAAC,CAAC,aAAD,CAAD,CAAiBuB,GAAjB,EAHG,CAIdC,CAAO,CAAGL,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCC,KAJ/B,CAKdI,CAAO,CAAGN,QAAQ,CAACC,cAAT,CAAwB,cAAxB,EAAwCC,KALpC,CAMdK,CAAS,CAAGhB,CAAW,EANT,CAQlBiB,OAAO,CAACC,GAAR,CAAYN,CAAZ,EACAK,OAAO,CAACC,GAAR,CAAYJ,CAAZ,EACAG,OAAO,CAACC,GAAR,CAAYV,CAAZ,EACAS,OAAO,CAACC,GAAR,CAAYH,CAAZ,EAEAzB,CAAC,CAAC6B,IAAF,CAAO,CACHC,IAAI,CAAE,MADH,CAEHC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjB,SAAY,YADK,CAEjB,OAAU,CAACf,CAAD,CAAWI,CAAX,CAAqBE,CAArB,CAA8BC,CAA9B,CAAuCC,CAAvC,CAFO,CAAf,CAFH,CAMHQ,GAAG,CAAE,mDANF,CAOHC,QAAQ,CAAE,MAPP,CAQHC,KAAK,CAAE,OARJ,CASHC,OAAO,CAAE,iBAASC,CAAT,CAAc,CACnB,GAAsB,CAAnB,EAAAA,CAAG,CAACC,WAAP,CAAyB,CACrBC,IAAI,CACAF,CAAG,CAACG,KADJ,CAEAH,CAAG,CAACb,OAFJ,CAGAa,CAAG,CAACR,IAHJ,CAIP,CALD,IAKO,CACHH,OAAO,CAACC,GAAR,CAAYU,CAAZ,CACH,CACJ,CAlBE,CAmBHI,KAAK,CAAE,eAASJ,CAAT,CAAc,CACjBX,OAAO,CAACC,GAAR,CAAYU,CAAZ,CACH,CArBE,CAAP,CAuBH,CACJ,CA1EK,CAAN","sourcesContent":["/**\r\n * Send e-mails to different groups of students or stuff of ASES.\r\n *\r\n * @module amd/src/communications\r\n * @author Jorge Eduardo Mayor Fern√°ndez\r\n * @copyright  2020 Jorge Eduardo Mayor <mayor.jorge@correounivalle.edu.co>\r\n * @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'block_ases/select2',], function($, select2){\r\n\r\n    return {\r\n        init: function () {\r\n            $(\"#send-button\").on('click', send_email);\r\n            $('#conditions').attr('multiple', true);\r\n\r\n            $(\"#conditions\").select2({\r\n\r\n                language: {\r\n\r\n                    noResults: function() {\r\n\r\n                        return \"No hay resultado\";\r\n                    },\r\n                    searching: function() {\r\n\r\n                        return \"Buscando..\";\r\n                    }\r\n                },\r\n                dropdownAutoWidth: true,\r\n            });\r\n        }\r\n    }\r\n\r\n    function getIdcourse() {\r\n        var urlParameters = location.search.split('&');\r\n\r\n        for (x in urlParameters) {\r\n            if (urlParameters[x].indexOf('courseid') >= 0) {\r\n                var intanceparameter = urlParameters[x].split('=');\r\n                return intanceparameter[1];\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    function send_email() {\r\n\r\n        var to_users = document.getElementById('additional_email').value;\r\n        var cohortes = $('#conditions').val();\r\n        var subject = document.getElementById('subject').value;\r\n        var message = document.getElementById('full_message').value;\r\n        var course_id = getIdcourse();\r\n\r\n        console.log(cohortes);\r\n        console.log(subject);\r\n        console.log(to_users);\r\n        console.log(message);\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            data: JSON.stringify({\r\n                \"function\": 'send_email',\r\n                \"params\": [to_users, cohortes, subject, message, course_id],\r\n            }),\r\n            url: \"../managers/communications/communications_api.php\",\r\n            dataType: \"json\",\r\n            cache: \"false\",\r\n            success: function(msg) {\r\n                if(msg.status_code == 0) {\r\n                    swal(\r\n                        msg.title,\r\n                        msg.message,\r\n                        msg.type);\r\n                } else {\r\n                    console.log(msg);\r\n                }\r\n            },\r\n            error: function(msg) {\r\n                console.log(msg);\r\n            }\r\n        });\r\n    }\r\n});"],"file":"communications.min.js"}