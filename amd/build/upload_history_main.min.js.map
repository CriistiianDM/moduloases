{"version":3,"sources":["../src/upload_history_main.js"],"names":["define","$","init","addHelpMessage","on","empty","uploadFile","formData","FormData","files","swal","title","text","html","type","confirmButtonColor","append","controler","val","ajax","url","data","dataType","cache","contentType","processData","beforeSend","success","msj","showCancelButton","showConfirmButton","timer","warning","error","urlzip","console","log","selector"],"mappings":"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","sourcesContent":["// Standard license block omitted.\r\n/** @autor      Camilo José Cruz Rivera\r\n * @package    block_ases\r\n * @copyright  ASES\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n/**\r\n * @module block_ases/upload_history_main\r\n */\r\n\r\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert'], function ($, bootstrap, sweetalert) {\r\n\r\n\r\n    return {\r\n        init: function () {\r\n\r\n\r\n            addHelpMessage();\r\n            $('#selector').on('change', function () {\r\n                addHelpMessage();\r\n            });\r\n\r\n            $('#boton_subir').on('click', function () {\r\n                $('#informacion').empty();\r\n                uploadFile();\r\n            });\r\n\r\n\r\n            function uploadFile() {\r\n\r\n                var formData = new FormData();\r\n\r\n                if ($('#archivo')[0].files[0] == undefined) {\r\n                    swal({\r\n                        title: \"Archivo no registrado.\",\r\n                        text: \"Seleccione el archivo a subir\",\r\n                        html: true,\r\n                        type: \"error\",\r\n                        confirmButtonColor: \"#d51b23\"\r\n                    });\r\n                    addHelpMessage();\r\n                    return;\r\n                }\r\n\r\n                formData.append('file', $('#archivo')[0].files[0]);\r\n\r\n                var controler = $('#selector').val() + '_processing.php';\r\n\r\n                $.ajax({\r\n                    url: '../managers/historic_management/' + controler,\r\n                    data: formData,\r\n                    type: 'POST',\r\n                    dataType: 'json',\r\n                    cache: false,\r\n                    //parametros necesarios para la carga de archivos\r\n                    contentType: false,\r\n                    processData: false,\r\n                    beforeSend: function () {\r\n                        $('#response').html(\"<img src='../icon/facebook.gif' />\");\r\n                    },\r\n                    success: function (msj) {\r\n                        swal({\r\n                            title: \"Exito\",\r\n                            text: \"Archivo Cargado. Por favor consulte los detalles\",\r\n                            html: true,\r\n                            type: \"warning\",\r\n                            showCancelButton: false,\r\n                            showConfirmButton: false,\r\n                            timer: 1300\r\n                        });\r\n                        \r\n                        $('#response').empty();\r\n\r\n                        $('#informacion').empty();\r\n\r\n                        if (msj.success) {\r\n                            $('#informacion').append('<div class=\"alert alert-success\"><h4 align=\"center\">Información</h4><strong>Exito!</strong> <br><p>' + msj.success + '</p></div>');\r\n                        } else if (msj.warning) {\r\n                            $('#informacion').append('<div class=\"alert alert-warning\"><h4 align=\"center\">Información</h4><strong>Cargado con inconsitencias!</strong> <br>' + msj.warning + '</div>');\r\n                        } else if (msj.error) {\r\n                            $('#informacion').append('<div class=\"alert alert-danger\"><h4 align=\"center\">Información</h4><strong>Error!</strong> <br>' + msj.error + '</div>');\r\n                        }\r\n                        \r\n                        $('#informacion').append(msj.urlzip);\r\n                        \r\n                    },\r\n                    error: function (msj) {\r\n                        console.log(msj);\r\n                        swal({\r\n                            title: \"Error en conexion al servidor.\",\r\n                            text: \"No se ha podido establecer conexion al servidor\",\r\n                            html: true,\r\n                            type: \"error\",\r\n                            confirmButtonColor: \"#d51b23\"\r\n                        });\r\n                        $('#response').html(\"\");\r\n                        addHelpMessage();\r\n                    }\r\n                    //... Other options like success and etc\r\n                });\r\n\r\n            }\r\n            function addHelpMessage() {\r\n                var selector = $('#selector').val();\r\n                $('#informacion').empty();\r\n                switch (selector) {\r\n                    case 'matricula':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga histórico académico</h4><br><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>codigo_estudiante</li> <li>codigo_programa</li> <li>codigo_asignatura</li> <li>nombre_asignatura</li> <li>semestre</li> </ul> </div>');\r\n                        break;\r\n                    case 'academic':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga histórico académico</h4><br><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>codigo_estudiante</li> <li>semestre</li> <li>programa</li> <li>promedio_semestre</li> <li>promedio_acumulado</li> </ul> </p><p>Columnas extras aceptadas: <ul> <li>numero_bajo</li> <li>puesto_estimulo</li> <li>fecha_cancelacion</li> </ul> </p></div>');\r\n                        break;\r\n                    case 'materias':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga materias</h4><br><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>codigo_estudiante</li> <li>semestre</li> <li>programa</li> <li>nombre_materia</li> <li>codigo_materia</li> <li>creditos</li> <li>nota</li> <li>fecha_cancelacion_materia</li> </ul> </p></div>');\r\n                        break;\r\n                    case 'icetex':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga histórico ICETEX</h4><br> <strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul><li>cedula_estudiante</li><li>programa</li><li>codigo_resolucion</li> <li>monto_estudiante</li></ul> </p></div>');\r\n                        break;\r\n                    case 'resolution':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga resolución ICETEX</h4><br> <strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul><li>codigo_resolucion</li><li>nombre_semestre</li><li>fecha</li><li>total_girado</li></ul></p> <p>Columnas extras aceptadas: <ul> <li>nota_credito</li> <li>cantidad_estudiantes</li></div>');\r\n                        break;\r\n                    case 'historic_icetex_status':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga histórico de estados ICETEX</h4><br> <strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul><li>cedula_estudiante</li><li>semestre</li><li>estado_icetex</li></ul> </p></div>');\r\n                        break;\r\n                    case 'student_status':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información de carga de estado de estudiantes</h4><br> <strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul><li>codigo_estudiante</li><li>codigo_programa</li><li>semestre</li></ul> </p><p>Columnas extras aceptadas: <ul><li>estado_grado</li> <li>cancelo_semestre</li></ul> </p></div>');\r\n                        break;\r\n                    default:\r\n                    // code\r\n                }\r\n            }\r\n\r\n\r\n        }\r\n    };\r\n});"],"file":"upload_history_main.min.js"}