{"version":3,"sources":["../src/dphpforms_form_builder.js"],"names":["define","$","init","document","ready","text","JSON","stringify","click","campoA","val","campoB","regla","registrarRegla","fadeIn","hide","generadorFormJSON","json","parse","store_form","on","parent","remove","actualizarCamposReglas","find","adicionarAlFormulario","html","id_","console","log","append","children","each","attr","obtenerIdTemporal","Math","floor","random","alert","regla_entendible","seleccion","contador","preguntas","identificadores","pregunta","push","nuevo_id","opciones","atributos","permisos","reglas","k","id_temporal","id_nuevo","disparadores","x","replaceAll","formulario","form","ajax","method","url","contentType","dataType","data","success","msg","error","XMLHttpRequest","textStatus","errorThrown","prop","String","prototype","search","replace","toString","split","join"],"mappings":"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","sourcesContent":["// Standard license block omitted.\r\n/*\r\n * @package    block_ases\r\n * @copyright  ASES\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n \r\n /**\r\n  * @module block_ases/dphpforms_form_builder\r\n  */\r\n\r\n  define(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert', 'block_ases/jqueryui','block_ases/select2'], function($, bootstrap, sweetalert, jqueryui, select2) {\r\n    \r\n    return {\r\n        init: function() {\r\n\r\n            $(document).ready(function(){\r\n                var JSONCondiciones = [\r\n                                        {\r\n                                            \"disparador\":\"cam_xxx\",\r\n                                            \"condiciones\":[\r\n                                                {\r\n                                                    \"condicion\":\"marcado\",\r\n                                                    \"comportamiento_condicion_cumplida\":[\r\n                                                        {\r\n                                                            \"campo\":\"cam_xxx\",\r\n                                                            \"permisos\": [{\"rol\":0, \"permisos\":[\"lectura\", \"escritura\"]}]\r\n                                                        },\r\n                                                        {\r\n                                                            \"campo\":\"cam_xxx+1\",\r\n                                                            \"permisos\": [\r\n                                                                {\"rol\":0, \"permisos\":[\"lectura\"]},\r\n                                                                {\"rol\":1, \"permisos\":[\"lectura\"]},\r\n                                                                {\"rol\":2, \"permisos\":[\"lectura\", \"escritura\"]}\r\n                                                            ]\r\n                                                        }\r\n                                                    ],\r\n                                                    \"comportamiento_condicion_no_cumplida\":[\r\n                                                        {\r\n                                                            \"campo\":\"cam_xxx+1\",\r\n                                                            \"permisos\": [\r\n                                                                {\"rol\":0, \"permisos\":[\"lectura\", \"escritura\"]},\r\n                                                                {\"rol\":1, \"permisos\":[\"lectura\", \"escritura\"]},\r\n                                                                {\"rol\":2, \"permisos\":[\"lectura\"]}\r\n                                                            ]\r\n                                                        }\r\n                                                    ]\r\n                                                }\r\n                                            ]\r\n                                        }\r\n                                    ];\r\n\r\n                $(\"#JSON-condiciones\").text(JSON.stringify(JSONCondiciones, undefined, 2)) ;\r\n                \r\n            });\r\n            \r\n            $('#btn-registro-regla').click(function(){\r\n                var campoA = $(\"#campoA option:selected\").val();\r\n                var campoB = $(\"#campoB option:selected\").val();\r\n                var regla = $(\"#selector-reglas option:selected\").val();\r\n                registrarRegla(campoA, campoB, regla);\r\n            });\r\n            \r\n            $('#verOpcionesAvanzadas').click(function(){\r\n                $('#opcionesAvanzadas').fadeIn(400);\r\n                $(this).hide();\r\n            });\r\n            \r\n            $('#generarFormulario').click(function(){\r\n                generadorFormJSON();\r\n            });\r\n\r\n            $('#json-store-form').click(function(){\r\n                var json = JSON.parse($('#opt1-textarea-json').val());\r\n                store_form(json);\r\n            });\r\n            \r\n            $('#titulo-formulario').on('keyup',function(){\r\n                $('#form-preview > h2').text($('#titulo-formulario').val());\r\n            });\r\n            \r\n            $(document).on('click', '.btn-eliminar-campo' , function() {\r\n                $(this).parent().remove();\r\n                actualizarCamposReglas();\r\n             });\r\n            \r\n             $(document).on('click', '.eliminar-regla' , function() {\r\n                $(this).parent().remove();\r\n                actualizarCamposReglas();\r\n             });\r\n            \r\n             $(document).on('keyup', '.enunciado' , function() {\r\n                $(this).parent().find('.label-text').text($(this).val());\r\n             });\r\n            \r\n            function adicionarAlFormulario(html, id_){\r\n                console.log('Adicionando: ' + html);\r\n                console.log('Identificador temporal cam_' + id_);\r\n                $('#form-preview').append(html);\r\n                actualizarCamposReglas();\r\n            };\r\n            \r\n            function actualizarCamposReglas(){\r\n                $('#campoA').children('option').remove();\r\n                $('#campoB').children('option').remove();\r\n                $('#form-preview').children('div').each(function(index){\r\n                    $('#campoA').append('<option value=\"'+ $(this).attr('id') +'\">'+ $(this).attr('id') +'</option>');\r\n                    $('#campoB').append('<option value=\"'+ $(this).attr('id') +'\">'+ $(this).attr('id') +'</option>');\r\n                });\r\n            };\r\n            \r\n            function obtenerIdTemporal(){\r\n                return Math.floor((Math.random() * 100) + 900);\r\n            }\r\n            \r\n            function registrarRegla(campoA, campoB, regla){\r\n                if( !(campoA) || !(campoB) ){\r\n                    alert('Seleccione primero un par de campos.');\r\n                    return;\r\n                }\r\n                var regla_entendible = null;\r\n                switch (regla) {\r\n                    case '>':\r\n                        regla_entendible = 'Mayor que';\r\n                        break;\r\n                    case '<':\r\n                        regla_entendible = 'Menor que';\r\n                        break;\r\n                    case 'EQUAL':\r\n                        regla_entendible = 'Igual que';\r\n                        break;\r\n                    case 'DIFFERENT':\r\n                        regla_entendible = 'Diferente que';\r\n                        break;\r\n                    case 'BOUND':\r\n                        regla_entendible = 'Depende de';\r\n                    break;\r\n                }\r\n                var html = '<div class=\"regla\" data-campo-a=\"'+campoA+'\" data-campo-b=\"'+campoB+'\" data-regla=\"'+regla+'\">\\\r\n                                '+campoA+' - <i>'+regla_entendible+'</i> - '+campoB+' \\\r\n                                <div class=\"btn btn-danger btn-xs eliminar-regla\">\\\r\n                                    eliminar\\\r\n                                </div>\\\r\n                            </div>';\r\n            \r\n                $('#contenedor-reglas').append(html);\r\n            }\r\n            \r\n            $('li').click(function(){\r\n                \r\n               var seleccion = $(this);\r\n               console.log(seleccion.attr('id'));\r\n               if(seleccion.attr('id') == 'caja-texto'){\r\n                   var id_ = obtenerIdTemporal();\r\n                   var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-Campo=\"TEXTFIELD\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <label for=\"\" class=\"label-text\">Previsualización del enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control\" name=\"TEXTFIELD\">\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            \r\n               if(seleccion.attr('id') == 'caja-parrafo'){\r\n                    var id_ = obtenerIdTemporal();\r\n                    var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-campo=\"TEXTAREA\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <label for=\"\" class=\"label-text\">Previsualización del enunciado</label>\\\r\n                                    <textarea class=\"form-control\" name=\"TEXTAREA\"></textarea>\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            \r\n               if(seleccion.attr('id') == 'caja-fecha'){\r\n                    var id_ = obtenerIdTemporal();\r\n                    var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-campo=\"DATE\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <label for=\"\" class=\"label-text\">Previsualización del enunciado</label>\\\r\n                                    <input type=\"date\" class=\"form-control\" name=\"DATE\">\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            \r\n               if(seleccion.attr('id') == 'caja-hora'){\r\n                    var id_ = obtenerIdTemporal();\r\n                    var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-campo=\"TIME\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <label for=\"\" class=\"label-text\">Previsualización del enunciado</label>\\\r\n                                    <input type=\"time\" class=\"form-control\" name=\"TIME\">\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            \r\n               if(seleccion.attr('id') == 'caja-radio'){\r\n                    var id_ = obtenerIdTemporal();\r\n                    var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-campo=\"RADIOBUTTON\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea rows=\"5\" class=\"form-control opcionesCampo\" placeholder=\"Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;posicion&#34;: &#34;número&#34;}] \\n\\nejemplo: [{ &#34;enunciado&#34;:&#34;Sí&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]\"></textarea>\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            \r\n               if(seleccion.attr('id') == 'caja-checkbox'){\r\n                    var id_ = obtenerIdTemporal();\r\n                    var html = '<div id=\"cam_' + id_ + '\" class=\"form-group div-box-preview\" data-tipo-campo=\"CHECKBOX\">\\\r\n                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_' + id_ + '</div>\\\r\n                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>\\\r\n                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"¿......?\">\\\r\n                                    <br>\\\r\n                                    <textarea rows=\"5\" class=\"form-control opcionesCampo\" placeholder=\"Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;checked&#34;:&#34;true&#34;, &#34;posicion&#34;: &#34;número&#34;}] \\n\\nejemplo: [{ &#34;enunciado&#34;:&#34;Sí&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]\"></textarea>\\\r\n                                    <br>\\\r\n                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>\\\r\n                                    <br>\\\r\n                                    <strong>Permisos sobre el campo [RF]:</strong>\\\r\n                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>\\\r\n                                    <hr>\\\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>\\\r\n                                </div>';\r\n                   adicionarAlFormulario(html, id_);\r\n               }\r\n            });\r\n            \r\n            \r\n            function generadorFormJSON(){\r\n                \r\n                var contador = 0;\r\n                var preguntas = JSON.parse('[]');\r\n                var identificadores = JSON.parse('[]');\r\n                $('#form-preview').children('div').each(function(index){\r\n            \r\n                    var pregunta = '';\r\n                    \r\n                    identificadores.push(JSON.parse('{ \"id_temporal\":\"' + $(this).attr('id') + '\", \"id_nuevo\":\"cam_' + contador + '\" }'));\r\n                    var nuevo_id = 'cam_' + contador;\r\n            \r\n                    var opciones = \"null\";\r\n                    if($(this).find('.opcionesCampo').val()){\r\n                        opciones = $(this).find('.opcionesCampo').val();\r\n                    };\r\n                    var atributos = \"null\";\r\n                    if($(this).find('.atributosCampo').val()){\r\n                        atributos = $(this).find('.atributosCampo').val();\r\n                    };\r\n                    var permisos = \"null\";\r\n                    if($(this).find('.permisosCampo').val()){\r\n                        permisos = $(this).find('.permisosCampo').val();\r\n                    };\r\n            \r\n                    pregunta =  '\\\r\n                    {\\\r\n                            \"id_temporal\":\"'+ nuevo_id +'\",\\\r\n                            \"enunciado\":\"'+$(this).find('.enunciado').val()+'\",\\\r\n                            \"tipo_campo\":\"'+$(this).attr('data-tipo-campo')+'\",\\\r\n                            \"opciones_campo\":'+ opciones +',\\\r\n                            \"atributos_campo\":'+ atributos +',\\\r\n                            \"permisos_campo\":'+ permisos +'\\\r\n                        }\\\r\n                    ';\r\n            \r\n                    preguntas.push(JSON.parse(pregunta));\r\n                    pregunta = \"\";\r\n                    contador = contador + 1;                \r\n                });\r\n            \r\n                var reglas = JSON.parse('[]');\r\n                $('#contenedor-reglas').children('.regla').each(function(index){\r\n                    var campoA = $(this).attr('data-campo-a');\r\n                    var campoB = $(this).attr('data-campo-b');\r\n                    var regla = $(this).attr('data-regla');\r\n            \r\n                    for(var k in identificadores) {\r\n                        if(identificadores[k].id_temporal == campoA){\r\n                            campoA = identificadores[k].id_nuevo;\r\n                        }\r\n                        if(identificadores[k].id_temporal == campoB){\r\n                            campoB = identificadores[k].id_nuevo;\r\n                        }\r\n                    };\r\n            \r\n                    reglas.push(JSON.parse('{\\\r\n                            \"id_temporal_campo_a\":\"' + campoA + '\",\\\r\n                            \"id_temporal_campo_b\":\"' + campoB + '\",\\\r\n                            \"regla\":\"' + regla + '\"\\\r\n                        }'));\r\n                });\r\n            \r\n                var disparadores = JSON.parse('[]');;\r\n                if($('#disparadores').val()){\r\n                    disparadores = $('#disparadores').val();\r\n                    for(var x in identificadores) {\r\n                        disparadores = disparadores.replaceAll(identificadores[x].id_temporal, identificadores[x].id_nuevo);\r\n                    };\r\n                    \r\n                    disparadores = JSON.parse(disparadores);\r\n                };\r\n            \r\n                var formulario = {\r\n                    \"datos_formulario\":{\r\n                        \"nombre\": $('#titulo-formulario').val(),\r\n                        \"descripcion\": $('#desc-formulario').val(),\r\n                        \"method\": $('#metodo-formulario').val(),\r\n                        \"action\": $('#procesador-formulario').val(),\r\n                        \"enctype\": $('#enctype-formulario').val()\r\n                    },\r\n                    \"preguntas\":preguntas,\r\n                    \"disparadores\": disparadores,\r\n                    \"reglas\":reglas\r\n                };\r\n                store_form(formulario);\r\n            };\r\n\r\n            function store_form(form){\r\n                console.log(form);\r\n                $.ajax({\r\n                    method: \"POST\",\r\n                    url: \"../managers/dphpforms/dphpforms_forms_processor.php\",\r\n                    contentType: \"application/json\",\r\n                    dataType: \"text\",\r\n                    data: JSON.stringify(form) ,\r\n                    success: function( msg ){\r\n                            alert( msg );\r\n                            console.log(msg);\r\n                    },\r\n                    error: function( XMLHttpRequest, textStatus, errorThrown ) {\r\n                        alert( \"some error \" + textStatus + \" \" + errorThrown );\r\n                        console.log( \"some error \" + textStatus + \" \" + errorThrown );\r\n                        console.log( XMLHttpRequest );\r\n                    }\r\n                });\r\n            }\r\n\r\n            $(\".limpiar\").click(function(){\r\n                $(this).parent().find(\"div\").each(function(){\r\n                    $(this).find(\"label\").find(\"input\").prop(\"checked\", false);\r\n                });\r\n            });\r\n            \r\n            String.prototype.replaceAll = function(search, replace) {\r\n                if (replace === undefined) {\r\n                    return this.toString();\r\n                }\r\n                return this.split(search).join(replace);\r\n            };\r\n                \r\n            }\r\n\r\n  }\r\n      \r\n});"],"file":"dphpforms_form_builder.min.js"}