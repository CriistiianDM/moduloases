define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(a,o,e,r,t){return{init:function(){function o(o,r){console.log("Adicionando: "+o),console.log("Identificador temporal cam_"+r),a("#form-preview").append(o),e()}function e(){a("#campoA").children("option").remove(),a("#campoB").children("option").remove(),a("#form-preview").children("div").each(function(o){a("#campoA").append('<option value="'+a(this).attr("id")+'">'+a(this).attr("id")+"</option>"),a("#campoB").append('<option value="'+a(this).attr("id")+'">'+a(this).attr("id")+"</option>")})}function r(){return Math.floor(100*Math.random()+900)}function t(o){console.log(o),a.ajax({method:"POST",url:"../managers/dphpforms/dphpforms_forms_processor.php",contentType:"application/json",dataType:"text",data:JSON.stringify(o),success:function(a){alert(a),console.log(a)},error:function(a,o,e){alert("some error "+o+" "+e),console.log("some error "+o+" "+e),console.log(a)}})}a(document).ready(function(){a("#JSON-condiciones").text(JSON.stringify([{disparador:"cam_xxx",condiciones:[{condicion:"marcado",comportamiento_condicion_cumplida:[{campo:"cam_xxx",permisos:[{rol:0,permisos:["lectura","escritura"]}]},{campo:"cam_xxx+1",permisos:[{rol:0,permisos:["lectura"]},{rol:1,permisos:["lectura"]},{rol:2,permisos:["lectura","escritura"]}]}],comportamiento_condicion_no_cumplida:[{campo:"cam_xxx+1",permisos:[{rol:0,permisos:["lectura","escritura"]},{rol:1,permisos:["lectura","escritura"]},{rol:2,permisos:["lectura"]}]}]}]}],void 0,2))}),a("#btn-registro-regla").click(function(){!function(o,e,r){if(!o||!e)return void alert("Seleccione primero un par de campos.");var t=null;switch(r){case">":t="Mayor que";break;case"<":t="Menor que";break;case"EQUAL":t="Igual que";break;case"DIFFERENT":t="Diferente que";break;case"BOUND":t="Depende de"}var i='<div class="regla" data-campo-a="'+o+'" data-campo-b="'+e+'" data-regla="'+r+'">                                '+o+" - <i>"+t+"</i> - "+e+'                                 <div class="btn btn-danger btn-xs eliminar-regla">                                    eliminar                                </div>                            </div>';a("#contenedor-reglas").append(i)}(a("#campoA option:selected").val(),a("#campoB option:selected").val(),a("#selector-reglas option:selected").val())}),a("#verOpcionesAvanzadas").click(function(){a("#opcionesAvanzadas").fadeIn(400),a(this).hide()}),a("#generarFormulario").click(function(){!function(){var o=0,e=JSON.parse("[]"),r=JSON.parse("[]");a("#form-preview").children("div").each(function(t){var i="";r.push(JSON.parse('{ "id_temporal":"'+a(this).attr("id")+'", "id_nuevo":"cam_'+o+'" }'));var l="cam_"+o,n="null";a(this).find(".opcionesCampo").val()&&(n=a(this).find(".opcionesCampo").val());var s="null";a(this).find(".atributosCampo").val()&&(s=a(this).find(".atributosCampo").val());var c="null";a(this).find(".permisosCampo").val()&&(c=a(this).find(".permisosCampo").val()),i='                    {                            "id_temporal":"'+l+'",                            "enunciado":"'+a(this).find(".enunciado").val()+'",                            "tipo_campo":"'+a(this).attr("data-tipo-campo")+'",                            "opciones_campo":'+n+',                            "atributos_campo":'+s+',                            "permisos_campo":'+c+"                        }                    ",e.push(JSON.parse(i)),i="",o+=1});var i=JSON.parse("[]");a("#contenedor-reglas").children(".regla").each(function(o){var e=a(this).attr("data-campo-a"),t=a(this).attr("data-campo-b"),l=a(this).attr("data-regla");for(var n in r)r[n].id_temporal==e&&(e=r[n].id_nuevo),r[n].id_temporal==t&&(t=r[n].id_nuevo);i.push(JSON.parse('{                            "id_temporal_campo_a":"'+e+'",                            "id_temporal_campo_b":"'+t+'",                            "regla":"'+l+'"                        }'))});var l=JSON.parse("[]");if(a("#disparadores").val()){for(var n in l=a("#disparadores").val(),r)l=l.replaceAll(r[n].id_temporal,r[n].id_nuevo);l=JSON.parse(l)}t({datos_formulario:{nombre:a("#titulo-formulario").val(),descripcion:a("#desc-formulario").val(),method:a("#metodo-formulario").val(),action:a("#procesador-formulario").val(),enctype:a("#enctype-formulario").val()},preguntas:e,disparadores:l,reglas:i})}()}),a("#json-store-form").click(function(){t(JSON.parse(a("#opt1-textarea-json").val()))}),a("#titulo-formulario").on("keyup",function(){a("#form-preview > h2").text(a("#titulo-formulario").val())}),a(document).on("click",".btn-eliminar-campo",function(){a(this).parent().remove(),e()}),a(document).on("click",".eliminar-regla",function(){a(this).parent().remove(),e()}),a(document).on("keyup",".enunciado",function(){a(this).parent().find(".label-text").text(a(this).val())}),a("li").click(function(){var e,t=a(this);(console.log(t.attr("id")),"caja-texto"==t.attr("id"))&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-Campo="TEXTFIELD">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualización del enunciado</label>                                    <input type="text" class="form-control" name="TEXTFIELD">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e);"caja-parrafo"==t.attr("id")&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-campo="TEXTAREA">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualización del enunciado</label>                                    <textarea class="form-control" name="TEXTAREA"></textarea>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e);"caja-fecha"==t.attr("id")&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-campo="DATE">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualización del enunciado</label>                                    <input type="date" class="form-control" name="DATE">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e);"caja-hora"==t.attr("id")&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-campo="TIME">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualización del enunciado</label>                                    <input type="time" class="form-control" name="TIME">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e);"caja-radio"==t.attr("id")&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-campo="RADIOBUTTON">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;posicion&#34;: &#34;número&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;Sí&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e);"caja-checkbox"==t.attr("id")&&o('<div id="cam_'+(e=r())+'" class="form-group div-box-preview" data-tipo-campo="CHECKBOX">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+e+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="¿......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;checked&#34;:&#34;true&#34;, &#34;posicion&#34;: &#34;número&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;Sí&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>',e)}),a(".limpiar").click(function(){a(this).parent().find("div").each(function(){a(this).find("label").find("input").prop("checked",!1)})}),String.prototype.replaceAll=function(a,o){return void 0===o?this.toString():this.split(a).join(o)}}}});