define ("block_ases/dphpforms_form_builder",["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(a){return{init:function init(){a(document).ready(function(){a("#JSON-condiciones").text(JSON.stringify([{disparador:"cam_xxx",condiciones:[{condicion:"marcado",comportamiento_condicion_cumplida:[{campo:"cam_xxx",permisos:[{rol:0,permisos:["lectura","escritura"]}]},{campo:"cam_xxx+1",permisos:[{rol:0,permisos:["lectura"]},{rol:1,permisos:["lectura"]},{rol:2,permisos:["lectura","escritura"]}]}],comportamiento_condicion_no_cumplida:[{campo:"cam_xxx+1",permisos:[{rol:0,permisos:["lectura","escritura"]},{rol:1,permisos:["lectura","escritura"]},{rol:2,permisos:["lectura"]}]}]}]}],void 0,2))});a("#btn-registro-regla").click(function(){var b=a("#campoA option:selected").val(),c=a("#campoB option:selected").val(),d=a("#selector-reglas option:selected").val();e(b,c,d)});a("#verOpcionesAvanzadas").click(function(){a("#opcionesAvanzadas").fadeIn(400);a(this).hide()});a("#generarFormulario").click(function(){f()});a("#json-store-form").click(function(){var b=JSON.parse(a("#opt1-textarea-json").val());g(b)});a("#titulo-formulario").on("keyup",function(){a("#form-preview > h2").text(a("#titulo-formulario").val())});a(document).on("click",".btn-eliminar-campo",function(){a(this).parent().remove();c()});a(document).on("click",".eliminar-regla",function(){a(this).parent().remove();c()});a(document).on("keyup",".enunciado",function(){a(this).parent().find(".label-text").text(a(this).val())});function b(b,d){console.log("Adicionando: "+b);console.log("Identificador temporal cam_"+d);a("#form-preview").append(b);c()}function c(){a("#campoA").children("option").remove();a("#campoB").children("option").remove();a("#form-preview").children("div").each(function(){a("#campoA").append("<option value=\""+a(this).attr("id")+"\">"+a(this).attr("id")+"</option>");a("#campoB").append("<option value=\""+a(this).attr("id")+"\">"+a(this).attr("id")+"</option>")})}function d(){return Math.floor(100*Math.random()+900)}function e(b,c,d){if(!b||!c){alert("Seleccione primero un par de campos.");return}var e=null;switch(d){case">":e="Mayor que";break;case"<":e="Menor que";break;case"EQUAL":e="Igual que";break;case"DIFFERENT":e="Diferente que";break;case"BOUND":e="Depende de";break;}var f="<div class=\"regla\" data-campo-a=\""+b+"\" data-campo-b=\""+c+"\" data-regla=\""+d+"\">                                "+b+" - <i>"+e+"</i> - "+c+"                                 <div class=\"btn btn-danger btn-xs eliminar-regla\">                                    eliminar                                </div>                            </div>";a("#contenedor-reglas").append(f)}a("li").click(function(){var c=a(this);console.log(c.attr("id"));if("caja-texto"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-Campo=\"TEXTFIELD\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <label for=\"\" class=\"label-text\">Previsualizaci\xF3n del enunciado</label>                                    <input type=\"text\" class=\"form-control\" name=\"TEXTFIELD\">                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}if("caja-parrafo"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-campo=\"TEXTAREA\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <label for=\"\" class=\"label-text\">Previsualizaci\xF3n del enunciado</label>                                    <textarea class=\"form-control\" name=\"TEXTAREA\"></textarea>                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}if("caja-fecha"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-campo=\"DATE\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <label for=\"\" class=\"label-text\">Previsualizaci\xF3n del enunciado</label>                                    <input type=\"date\" class=\"form-control\" name=\"DATE\">                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}if("caja-hora"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-campo=\"TIME\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <label for=\"\" class=\"label-text\">Previsualizaci\xF3n del enunciado</label>                                    <input type=\"time\" class=\"form-control\" name=\"TIME\">                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}if("caja-radio"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-campo=\"RADIOBUTTON\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea rows=\"5\" class=\"form-control opcionesCampo\" placeholder=\"Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]\"></textarea>                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}if("caja-checkbox"==c.attr("id")){var e=d(),f="<div id=\"cam_"+e+"\" class=\"form-group div-box-preview\" data-tipo-campo=\"CHECKBOX\">                                    <div  class=\"identificador-temporal\">Identificador temporal: cam_"+e+"</div>                                    <label for=\"\" class=\"label-enunciado\">Enunciado</label>                                    <input type=\"text\" class=\"form-control enunciado\" name=\"textfield\" placeholder=\"\xBF......?\">                                    <br>                                    <textarea rows=\"5\" class=\"form-control opcionesCampo\" placeholder=\"Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;checked&#34;:&#34;true&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]\"></textarea>                                    <br>                                    <textarea name=\"atributosCampo\" class=\"form-control atributosCampo\"  placeholder=\"Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}\"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name=\"permisosCampo\" class=\"form-control permisosCampo\" >[{ \"rol\":0, \"permisos\":[\"lectura\", \"escritura\"] }]</textarea>                                    <hr>                                    <a href=\"javascript:void(0);\" class=\"btn btn-danger btn-xs btn-eliminar-campo\">Eliminar</a>                                </div>";b(f,e)}});function f(){var b=0,c=JSON.parse("[]"),d=JSON.parse("[]");a("#form-preview").children("div").each(function(){var e="";d.push(JSON.parse("{ \"id_temporal\":\""+a(this).attr("id")+"\", \"id_nuevo\":\"cam_"+b+"\" }"));var f="cam_"+b,g="null";if(a(this).find(".opcionesCampo").val()){g=a(this).find(".opcionesCampo").val()}var h="null";if(a(this).find(".atributosCampo").val()){h=a(this).find(".atributosCampo").val()}var i="null";if(a(this).find(".permisosCampo").val()){i=a(this).find(".permisosCampo").val()}e="                    {                            \"id_temporal\":\""+f+"\",                            \"enunciado\":\""+a(this).find(".enunciado").val()+"\",                            \"tipo_campo\":\""+a(this).attr("data-tipo-campo")+"\",                            \"opciones_campo\":"+g+",                            \"atributos_campo\":"+h+",                            \"permisos_campo\":"+i+"                        }                    ";c.push(JSON.parse(e));e="";b=b+1});var e=JSON.parse("[]");a("#contenedor-reglas").children(".regla").each(function(){var b=a(this).attr("data-campo-a"),c=a(this).attr("data-campo-b"),f=a(this).attr("data-regla");for(var g in d){if(d[g].id_temporal==b){b=d[g].id_nuevo}if(d[g].id_temporal==c){c=d[g].id_nuevo}}e.push(JSON.parse("{                            \"id_temporal_campo_a\":\""+b+"\",                            \"id_temporal_campo_b\":\""+c+"\",                            \"regla\":\""+f+"\"                        }"))});var f=JSON.parse("[]");if(a("#disparadores").val()){f=a("#disparadores").val();for(var h in d){f=f.replaceAll(d[h].id_temporal,d[h].id_nuevo)}f=JSON.parse(f)}var i={datos_formulario:{nombre:a("#titulo-formulario").val(),descripcion:a("#desc-formulario").val(),method:a("#metodo-formulario").val(),action:a("#procesador-formulario").val(),enctype:a("#enctype-formulario").val()},preguntas:c,disparadores:f,reglas:e};g(i)}function g(b){console.log(b);a.ajax({method:"POST",url:"../managers/dphpforms/dphpforms_forms_processor.php",contentType:"application/json",dataType:"text",data:JSON.stringify(b),success:function success(a){alert(a);console.log(a)},error:function error(a,b,c){alert("some error "+b+" "+c);console.log("some error "+b+" "+c);console.log(a)}})}a(".limpiar").click(function(){a(this).parent().find("div").each(function(){a(this).find("label").find("input").prop("checked",!1)})});String.prototype.replaceAll=function(a,b){if(b===void 0){return this.toString()}return this.split(a).join(b)}}}});
//# sourceMappingURL=dphpforms_form_builder.min.js.map
