'use strict';define(['jquery','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function f(l,m){console.log('Adicionando: '+l),console.log('Identificador temporal cam_'+m),a('#form-preview').append(l),g()}function g(){a('#campoA').children('option').remove(),a('#campoB').children('option').remove(),a('#form-preview').children('div').each(function(){a('#campoA').append('<option value="'+a(this).attr('id')+'">'+a(this).attr('id')+'</option>'),a('#campoB').append('<option value="'+a(this).attr('id')+'">'+a(this).attr('id')+'</option>')})}function h(){return Math.floor(100*Math.random()+900)}function i(l,m,n){if(!l||!m)return void alert('Seleccione primero un par de campos.');var o=null;'>'===n?o='Mayor que':'<'===n?o='Menor que':'EQUAL'===n?o='Igual que':'DIFFERENT'===n?o='Diferente que':'BOUND'===n?o='Depende de':void 0;var p='<div class="regla" data-campo-a="'+l+'" data-campo-b="'+m+'" data-regla="'+n+'">                                '+l+' - <i>'+o+'</i> - '+m+'                                 <div class="btn btn-danger btn-xs eliminar-regla">                                    eliminar                                </div>                            </div>';a('#contenedor-reglas').append(p)}function j(){var l=0,m=JSON.parse('[]'),n=JSON.parse('[]');a('#form-preview').children('div').each(function(){var t='';n.push(JSON.parse('{ "id_temporal":"'+a(this).attr('id')+'", "id_nuevo":"cam_'+l+'" }'));var u='cam_'+l,v='null';a(this).find('.opcionesCampo').val()&&(v=a(this).find('.opcionesCampo').val());var w='null';a(this).find('.atributosCampo').val()&&(w=a(this).find('.atributosCampo').val());var y='null';a(this).find('.permisosCampo').val()&&(y=a(this).find('.permisosCampo').val());t='                    {                            "id_temporal":"'+u+'",                            "enunciado":"'+a(this).find('.enunciado').val()+'",                            "tipo_campo":"'+a(this).attr('data-tipo-campo')+'",                            "opciones_campo":'+v+',                            "atributos_campo":'+w+',                            "permisos_campo":'+y+'                        }                    ',m.push(JSON.parse(t)),t='',++l});var o=JSON.parse('[]');a('#contenedor-reglas').children('.regla').each(function(){var t=a(this).attr('data-campo-a'),u=a(this).attr('data-campo-b'),v=a(this).attr('data-regla');for(var w in n)n[w].id_temporal==t&&(t=n[w].id_nuevo),n[w].id_temporal==u&&(u=n[w].id_nuevo);o.push(JSON.parse('{                            "id_temporal_campo_a":"'+t+'",                            "id_temporal_campo_b":"'+u+'",                            "regla":"'+v+'"                        }'))});var p='null';if(a('#disparadores').val()){for(var q in p=a('#disparadores').val(),n)p=p.replaceAll(n[q].id_temporal,n[q].id_nuevo);p=JSON.parse(p)}var r={datos_formulario:{nombre:a('#titulo-formulario').val(),descripcion:a('#desc-formulario').val(),method:a('#metodo-formulario').val(),action:a('#procesador-formulario').val(),enctype:a('#enctype-formulario').val(),disparadores:p},preguntas:m,reglas:o};console.log(r),a.ajax({method:'POST',url:'../managers/dphpforms/dphpforms_forms_processor.php',data:{data:r}}).done(function(s){alert('Data Saved: '+s),console.log(s)})}a(document).ready(function(){a('#JSON-condiciones').text(JSON.stringify([{disparador:'cam_xxx',condiciones:[{condicion:'marcado',comportamiento_condicion_cumplida:[{campo:'cam_xxx',permisos:[{rol:0,permisos:['lectura','escritura']}]},{campo:'cam_xxx+1',permisos:[{rol:0,permisos:['lectura']},{rol:1,permisos:['lectura']},{rol:2,permisos:['lectura','escritura']}]}],comportamiento_condicion_no_cumplida:[{campo:'cam_xxx+1',permisos:[{rol:0,permisos:['lectura','escritura']},{rol:1,permisos:['lectura','escritura']},{rol:2,permisos:['lectura']}]}]}]}],void 0,2))}),a('#btn-registro-regla').click(function(){var l=a('#campoA option:selected').val(),m=a('#campoB option:selected').val(),n=a('#selector-reglas option:selected').val();i(l,m,n)}),a('#verOpcionesAvanzadas').click(function(){a('#opcionesAvanzadas').fadeIn(400),a(this).hide()}),a('#generarFormulario').click(function(){j()}),a('#titulo-formulario').on('keyup',function(){a('#form-preview > h2').text(a('#titulo-formulario').val())}),a(document).on('click','.btn-eliminar-campo',function(){a(this).parent().remove(),g()}),a(document).on('click','.eliminar-regla',function(){a(this).parent().remove(),g()}),a(document).on('keyup','.enunciado',function(){a(this).parent().find('.label-text').text(a(this).val())});a('li').click(function(){var l=a(this);if(console.log(l.attr('id')),'caja-texto'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-Campo="TEXTFIELD">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="text" class="form-control" name="TEXTFIELD">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}if('caja-parrafo'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-campo="TEXTAREA">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <textarea class="form-control" name="TEXTAREA"></textarea>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}if('caja-fecha'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-campo="DATE">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="date" class="form-control" name="DATE">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}if('caja-hora'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-campo="TIME">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <label for="" class="label-text">Previsualizaci\xF3n del enunciado</label>                                    <input type="time" class="form-control" name="TIME">                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}if('caja-radio'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-campo="RADIOBUTTON">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}if('caja-checkbox'==l.attr('id')){var m=h(),n='<div id="cam_'+m+'" class="form-group div-box-preview" data-tipo-campo="CHECKBOX">                                    <div  class="identificador-temporal">Identificador temporal: cam_'+m+'</div>                                    <label for="" class="label-enunciado">Enunciado</label>                                    <input type="text" class="form-control enunciado" name="textfield" placeholder="\xBF......?">                                    <br>                                    <textarea rows="5" class="form-control opcionesCampo" placeholder="Elementos: [{ &#34;enunciado&#34;:&#34;texto&#34;, &#34;valor&#34;:&#34;valor&#34;, &#34;checked&#34;:&#34;true&#34;, &#34;posicion&#34;: &#34;n\xFAmero&#34;}] \n\nejemplo: [{ &#34;enunciado&#34;:&#34;S\xED&#34;, &#34;valor&#34;:&#34;1&#34;, &#34;posicion&#34;: &#34;0&#34;}, { &#34;enunciado&#34;:&#34;No&#34;, &#34;valor&#34;:&#34;0&#34;, &#34;posicion&#34;: &#34;1&#34;}]"></textarea>                                    <br>                                    <textarea name="atributosCampo" class="form-control atributosCampo"  placeholder="Atributos: { &#34;atributo&#34;:&#34;valor&#34;, &#34;atributo&#34;:&#34;valor&#34; },\nejemplo: {&#34;type&#34;:&#34;text&#34;, &#34;placeholder&#34;:&#34;Name&#34;}"></textarea>                                    <br>                                    <strong>Permisos sobre el campo [RF]:</strong>                                    <textarea name="permisosCampo" class="form-control permisosCampo" >[{ "rol":0, "permisos":["lectura", "escritura"] }]</textarea>                                    <hr>                                    <a href="javascript:void(0);" class="btn btn-danger btn-xs btn-eliminar-campo">Eliminar</a>                                </div>';f(n,m)}});a('.limpiar').click(function(){a(this).parent().find('div').each(function(){a(this).find('label').find('input').prop('checked',!1)})}),String.prototype.replaceAll=function(l,m){return void 0===m?this.toString():this.split(l).join(m)}}}});