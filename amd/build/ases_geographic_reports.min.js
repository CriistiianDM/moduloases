define(["jquery","block_ases/jszip"],function(a,e){return{init:function(){window.JSZip=e,n(),a("#heat_map").on("change",function(){window.heatmap?window.heatmap.setMap(heatmap.getMap()?null:window.map):o()}),a("#markers_map").on("change",function(){if(window.markers)for(var a in window.markers)window.markers[a].setMap(window.markers[a].getMap()?null:window.map);else i()}),a("#conditions").on("change",function(){n()})}};function n(){a.ajax({type:"POST",data:{type:"mapa",cohort:a("#conditions").val(),instance_id:r()},url:"../managers/ases_report/asesreport_graphics_processing.php",success:function(a){!function(a){if(!window.map){var e=new google.maps.LatLng(3.4247198,-76.5259052);window.map=new google.maps.Map(document.getElementById("map-canvas"),{center:e,zoom:12})}var n,r,t=[],s=[];for(var p in a)n=Number(a[p].latitude),r=Number(a[p].longitude),t.push(new google.maps.LatLng(n,r)),s.push(a[p].cohorte);window.puntosMapa=t,window.cohortes=s,o(),i()}(a)},dataType:"json",cache:!1,async:!0,failure:function(a){}})}function o(){window.heatmap&&window.heatmap.setMap(null),a("#heat_map").is(":checked")&&(window.heatmap=new google.maps.visualization.HeatmapLayer({data:window.puntosMapa,map:map,opacity:1,maxIntensity:10}))}function i(){if(window.markers)for(var e in window.markers)window.markers[e].setMap(null);var n,o;if(a("#markers_map").is(":checked"))for(var e in window.markers=[],window.puntosMapa){switch(window.cohortes[e]){case"SPP":o="blue";break;case"SPE":o="green";break;case"SPT":o="red";break;case"3740":o="purple";break;case"Otros":o="orange"}n={url:"https://raw.githubusercontent.com/Concept211/Google-Maps-Markers/master/images/marker_"+o+".png",scaledSize:new google.maps.Size(11,20)},window.markers.push(new google.maps.Marker({position:window.puntosMapa[e],map:map,icon:n,title:window.cohortes[e]}))}}function r(){var a=location.search.split("&");for(x in a){if(a[x].indexOf("instanceid")>=0)return a[x].split("=")[1]}return 0}});