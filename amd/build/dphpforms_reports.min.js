<<<<<<< HEAD
define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(a,b,c,d,e){return{init:function(){function b(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function c(a){var b,c,d,e,f,g;return g=a.data||null,null!=g&&g.length?(e=a.columnDelimiter||",",f=a.lineDelimiter||"\n",d=Object.keys(g[0]),b="",b+=d.join(e),b+=f,g.forEach(function(a){c=0,d.forEach(function(d){c>0&&(b+=e),b+='"'+a[d].respuesta+'"',c++}),b+=f}),b):null}function d(a){var b,d,e=c({data:a});if(null!=e){b="reporte.csv",csvData=new Blob([e],{type:"text/csv"});var d=document.createElement("a");if(void 0!==d.download){var f=URL.createObjectURL(csvData);d.setAttribute("href",f),d.setAttribute("download",b),d.style="visibility:hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)}}}a("#btn-generar-reporte").click(function(){var c=a("#start_date").val(),e=a("#end_date").val();c>=e?swal({title:"Información",text:"Intervalo de fechas inválido",type:"warning"},function(){}):(a("#progress_group").css("display","block"),a("#progress").text("Espere, esto puede tardar un par de minutos dependiendo de su red y ordenador..."),a.get('../managers/dphpforms/dphpforms_reverse_filter.php?id_pregunta=seguimiento_pares_fecha&cast=date&criterio={"criteria":[{"operator":">=","value":"'+c+'"},{"operator":"<=","value":"'+e+'"}]}',function(c){for(var e=Object.keys(c.results).length,f=[],g=0,h=[],i=0;i<e;i++)a.get("../managers/dphpforms/dphpforms_reverse_finder.php?respuesta_id="+c.results[i].id,function(c){a.get("../managers/dphpforms/dphpforms_get_record.php?record_id="+c.result.id_registro,function(c){var i=[];if(Object.keys(c.record).length>0){for(var j=0;j<Object.keys(c.record.campos).length;j++)i[parseInt(c.record.campos[j].id_pregunta)]={enunciado:c.record.campos[j].enunciado,respuesta:c.record.campos[j].respuesta},b(h,parseInt(c.record.campos[j].id_pregunta))||h.push(parseInt(c.record.campos[j].id_pregunta));f.push(i)}g++,a("#progress").text((100/e*g).toFixed(2)+"%"),g==e&&d(f)}).fail(function(a){console.log(a)})}),a("#progress").text(Math.round(g));0==e&&a("#progress").text(100)}))})}}});
=======
'use strict';define(['jquery','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function f(j,k){for(var l=0;l<j.length;l++)if(j[l]==k)return!0;return!1}function g(j){var k,l,m,n,o,p;return(p=j.data||null,null==p||!p.length)?null:(n=j.columnDelimiter||',',o=j.lineDelimiter||'\n',m=Object.keys(p[0]),k='',k+=m.join(n),k+=o,p.forEach(function(q){l=0,m.forEach(function(r){0<l&&(k+=n),k+='"'+q[r].respuesta+'"',l++}),k+=o}),k)}function h(j){var k,l,m=g({data:j});if(null!=m){k='reporte.csv',csvData=new Blob([m],{type:'text/csv'});var l=document.createElement('a');if(void 0!==l.download){var n=URL.createObjectURL(csvData);l.setAttribute('href',n),l.setAttribute('download',k),l.style='visibility:hidden',document.body.appendChild(l),l.click(),document.body.removeChild(l)}}}a('#btn-generar-reporte').click(function(){var j=a('#start_date').val(),k=a('#end_date').val();j>=k?swal({title:'Informaci\xF3n',text:'Intervalo de fechas inv\xE1lido',type:'warning'},function(){}):(a('#progress_group').css('display','block'),a('#progress').text('Espere, esto puede tardar un par de minutos dependiendo de su red y ordenador...'),a.get('../managers/dphpforms/dphpforms_reverse_filter.php?id_pregunta=seguimiento_pares_fecha&cast=date&criterio={"criteria":[{"operator":">=","value":"'+j+'"},{"operator":"<=","value":"'+k+'"}]}',function(l){for(var m=Object.keys(l.results).length,n=[],o=0,p=[],q=0;q<m;q++)a.get('../managers/dphpforms/dphpforms_reverse_finder.php?respuesta_id='+l.results[q].id,function(r){a.get('../managers/dphpforms/dphpforms_get_record.php?record_id='+r.result.id_registro,function(s){var t=[];if(0<Object.keys(s.record).length){for(var u=0;u<Object.keys(s.record.campos).length;u++)t[parseInt(s.record.campos[u].id_pregunta)]={enunciado:s.record.campos[u].enunciado,respuesta:s.record.campos[u].respuesta},f(p,parseInt(s.record.campos[u].id_pregunta))||p.push(parseInt(s.record.campos[u].id_pregunta));n.push(t)}o++,a('#progress').text((100/m*o).toFixed(2)+'%'),o==m&&h(n)}).fail(function(s){console.log(s)})}),a('#progress').text(Math.round(o));0==m&&a('#progress').text(100)}))})}}});
>>>>>>> e6e18b8a8db46eb6ad1655264fcd65b39fb8ecbb
