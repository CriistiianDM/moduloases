define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(a,b,c,d,e){return{init:function(){function b(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function c(a){var b,c,d,e,f,g;return g=a.data||null,null!=g&&g.length?(e=a.columnDelimiter||",",f=a.lineDelimiter||"\n",d=Object.keys(g[0]),b="",b+=d.join(e),b+=f,g.forEach(function(a){c=0,d.forEach(function(d){c>0&&(b+=e),b+='"'+a[d].respuesra+'"',c++}),b+=f}),b):null}function d(a){var b,d,e=c({data:a});if(null!=e){b="export.csv",csvData=new Blob([e],{type:"text/csv"});var f=URL.createObjectURL(csvData);d=document.createElement("a"),d.href=f,d.setAttribute("download",b),d.click()}}a("#btn-generar-reporte").click(function(){var c=a("#start_date").val(),e=a("#end_date").val();c>=e?swal({title:"Información",text:"Intervalo de fechas inválido",type:"warning"},function(){}):(a("#progress_group").css("display","block"),a("#progress").text("Espere, puede tardar un par de minutos ..."),a.get('../managers/dphpforms/dphpforms_reverse_filter.php?id_pregunta=seguimiento_pares_fecha&cast=date&criterio={"criteria":[{"operator":">=","value":"'+c+'"},{"operator":"<=","value":"'+e+'"}]}',function(c){var e=Object.keys(c.results).length;console.log(e);var f=[],g=0,h=[];a.each(c.results,function(){a.get("../managers/dphpforms/dphpforms_reverse_finder.php?respuesta_id="+this.id,function(c){a.get("../managers/dphpforms/dphpforms_get_record.php?record_id="+c.result.id_registro,function(c){var i=[];console.log(c.record.campos);for(var j=0;j<Object.keys(c.record.campos).length;j++)i[parseInt(c.record.campos[j].id_pregunta)]={enunciado:c.record.campos[j].enunciado,respuesra:c.record.campos[j].respuesta},f.push(i),b(h,parseInt(c.record.campos[j].id_pregunta))||h.push(parseInt(c.record.campos[j].id_pregunta));g++,a("#progress").text((100/e*g).toFixed(2)+"%"),console.log("Procesado"),console.log(i),console.log(h),console.log(g+" === "+e),g==e&&(console.log("CSV!!!!!!!!"),d(f))})}),a("#progress").text(Math.round(g))}),0==e&&a("#progress").text(100)}))})}}});