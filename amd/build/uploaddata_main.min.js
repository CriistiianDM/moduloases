define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/validator"],function(e,s,a,n){return{init:function(){function s(){e.ajax({url:"../managers/upload_files_form/mostrar_archivos.php",dataType:"JSON",success:function(s){if(s){for(var a="",n=0;n<s.length;n++)null!=s[n]&&(a+='<div class="row"> <span class="col-md-3"> '+s[n]+' </span> <div class="col-md-2"> <a class="eliminar_archivo btn btn-danger " id="btn_eliminar" name="elim" href="javascript:void(0);"> Eliminar </a> </div> </div> <hr />');e("#archivos_subidos").html(a)}}})}function a(s,a){(e("#respuesta").removeClass("alert-success").removeClass("alert-danger").html(s),a)?(e("#respuesta").addClass("alert-success"),setTimeout("document.location.reload()",500)):(e("#respuesta").addClass("alert-danger"),e('<br> <div class="row"><div class="col-md-2 col-md-offset-5"><a class="continue btn btn-danger" href="javascript:void(0);"> Continuar </a></div></div>').appendTo(e("#respuesta")))}e(document).ready(function(){s();var n=document.getElementById("upload_data_form");e("#load_button").on("click",function(){!function(e){var s=e.children[2].children[0].children[0],a=s.children[0],n=e.children[4].children[1];response_div=document.getElementById("response_div"),response_span=document.getElementById("response_span"),response_span.innerHTML="",response_div.setAttribute("hidden","hidden"),s.classList.remove("green_bar","red_bar");var r=new XMLHttpRequest;r.upload.addEventListener("progress",e=>{let n=Math.round(e.loaded/e.total*100);s.style.width=n+"%",a.innerHTML=n+"%"}),r.addEventListener("load",()=>{"1"==r.response?(s.classList.add("green_bar"),a.innerHTML="Éxito",response_div.removeAttribute("hidden"),response_span.classList.add("response_success"),response_span.innerHTML+="El contenido del archivo ha sido cargado con éxito en la base de datos."):(s.classList.add("red_bar"),a.innerHTML="Error",response_div.removeAttribute("hidden"),response_span.classList.add("response_error"),response_span.innerHTML=r.response)}),r.open("post","../managers/upload_files_form/subir_archivo.php"),r.send(new FormData(e)),n.addEventListener("click",()=>{r.abort(),s.classList.remove("green_bar"),s.classList.add("red_bar"),a.innerHTML="Proceso cancelado"})}(n)}),e("#archivos_subidos").on("click",".eliminar_archivo",function(){var n=e(this).parents(".row").eq(0).find("span").text();!function(n){e.ajax({url:"../managers/upload_files_form/eliminar_archivo.php",type:"POST",timeout:1e4,data:{archivo:n},error:function(){a("Error al intentar eliminar el archivo.",!1)},success:function(e){1==e?a("El archivo ha sido eliminado.",!0):a("Error al intentar eliminar el archivo.",!1),s()}})}(n=e.trim(n))}),e("#respuesta").on("click",".continue",function(){setTimeout("document.location.reload()",500)})})}}});