define(["jquery","block_ases/jquery.dataTables","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/_general_modal_manager","block_ases/select2","block_ases/jqueryui","block_ases/loading_indicator","block_ases/sweetalert"],function(e,a,t,s,n,o,r,i,l,c,d){function u(a){e("#div_table").html(""),e("#div_table").fadeIn(500).append('<table id="tableResult" class="stripe row-border order-column" cellspacing="0" width="100%"><thead> </thead></table>'),e("#tableResult").DataTable(a)}const m=new URLSearchParams(window.location.search).get("monitoriaid");return{init:function(){e.datepicker.setDefaults({closeText:"Cerrar",prevText:"&#x3C;Ant",nextText:"Sig&#x3E;",currentText:"Hoy",monthNames:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],monthNamesShort:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],dayNames:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],dayNamesShort:["dom","lun","mar","mié","jue","vie","sáb"],dayNamesMin:["D","L","M","X","J","V","S"],weekHeader:"Sm",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""}),e("#fecha_hasta").datepicker({showWeek:!0,dateFormat:"dd/M/y"}),e("#fecha_desde").datepicker({showWeek:!0,dateFormat:"dd/M/y"}),e("#desplegar-filtrar").click(()=>{e("#flecha").toggleClass("abajo"),e("#rango-fechas-sesiones").toggle(300)}),e("#rango-fechas-sesiones").submit(g)},construir_tabla:u,init_despues_de_tabla:function(){e(".dt-button.buttons-print.eliminar").click(function(a){let t=e(a.target).parent().parent().parent().find("td")[0].innerHTML;swal({title:"Cancelar sesión",text:"¿Deseas cancelar la sesión programada el "+t+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Eliminar"},function(t){t&&(console.log(a.target.id),e.ajax({type:"POST",data:JSON.stringify({function:"eliminar_sesion",params:a.target.id}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",success:function(e){g()},error:function(e){swal("Error!",e,"error"),console.log(e)}}))})})}};function b(e){function a(e){return e<10?"0"+e.toString():e.toString()}return parseInt(e.getFullYear().toString()+a(e.getMonth()+1)+a(e.getDate()))}function g(a){a.preventDefault(),c.show();var t=b(e("#fecha_desde").datepicker("getDate")),s=b(e("#fecha_hasta").datepicker("getDate"));console.log(t+" "+s),console.log(m),e.ajax({type:"POST",data:JSON.stringify({function:"get_tabla_sesiones",params:[m,t,s]}),url:"../managers/asistencia_monitorias/asistencia_monitorias_api.php",dataType:"json",success:function(e){c.hide(),u(e.data_response)},error:function(a){console.log("Error insercion bd de monitoria en backend"),e("#debug").html(a.responseText)}})}});