define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui"],function($,a,b,c){return{init:function(){let b=new google.maps.LatLng(3.3741569,-76.5355235),c=new google.maps.LatLng(3.431626,-76.546822),d=$("#id_ases").val();var e,a=document.querySelector("#cod_programa_activo").dataset.info[1],f="6"===a||"8"===a?c:b,g=(new google.maps.Geocoder().geocode({address:"prueba"},function(b,a){return a==google.maps.GeocoderStatus.OK}),!1);function h(){if(g){var b=new google.maps.Geocoder,a=document.getElementById("geographic_ciudad"),c=$("#geographic_direccion").val()+" "+a.options[a.selectedIndex].text+" Colombia";b.geocode({address:c},function(a){if(a[0]){var b=a[0].geometry.location.lat(),c=a[0].geometry.location.lng();e=i(b,c),document.getElementById("latitude").value=b,document.getElementById("longitude").value=c}else console.log("No se encontraron resultados")})}}function i(h,i){if(!g)return console.log("Mapas fuera de servicio"),e;document.getElementById("mapa").innerHTML="";var a=new google.maps.Map(document.getElementById("mapa"),{center:f,zoom:14}),j=new google.maps.Marker({position:f,map:a,title:"Universidad del Valle"}),b=new google.maps.InfoWindow;b.setContent("Universidad del Valle"),b.open(a,j);var c=new google.maps.Marker({position:{lat:parseFloat(h),lng:parseFloat(i)},map:a}),d=new google.maps.InfoWindow;d.setContent("Residencia Estudiante"),d.open(a,c);var k=new google.maps.Geocoder;return google.maps.event.addListener(a,"click",function(b){k.geocode({latLng:b.latLng},function(e,f){f==google.maps.GeocoderStatus.OK?e[0]?(c?c.setPosition(b.latLng):c=new google.maps.Marker({position:b.latLng,map:a}),d.setContent(e[0].formatted_address+"<br/> Coordenadas: "+e[0].geometry.location),d.open(a,c)):console.log("No se encontraron resultados"):console.log("Geocodificaci\xf3n ha fallado debido a: "+f)})}),c}function j(e,f,g,h,i,b,c,a,d){if(1==a){swal("Error","Debe definir la ciudad del estudiante antes de guardar","error");return}if(1079==a&&"No registra"==c){swal("Error","Debe definir un barrio de residencia antes de guardar","error");return}if(null==d){swal("Error","Debe definir un nivel de riesgo antes de guardar","error");return}if(""==b.trim()){swal("Error","Debe definir una direcci\xf3n antes de guardar","error");return}var j=$("#geographic_text_area").val(),k=$("#geographic_checkbox_vive_lejos").prop("checked"),l=$("#geographic_checkbox_zona_riesgo").prop("checked"),m=$("#nativo").prop("checked");$.ajax({type:"POST",data:JSON.stringify({function:"save_geographic_info",params:[e,f,g,c,h,i,b,a,j,k,l,m,d]}),url:"../managers/student_profile/geographic_api.php",success:function(a){0==a.status_code?swal(a.title,a.message,a.type):console.log(a),$("#button_edit_geographic").removeAttr("hidden"),$("#div_save_buttons").attr("hidden",!0),$("#select_neighborhood").attr("disabled",!0),$("#latitude").attr("disabled",!0),$("#longitude").attr("disabled",!0),$("#geographic_direccion").attr("disabled",!0),$("#geographic_ciudad").attr("disabled",!0),$("#geographic_checkbox_vive_lejos").attr("disabled",!0),$("#geographic_checkbox_zona_riesgo").attr("disabled",!0),$("#nivel_bajo").attr("disabled",!0),$("#nivel_medio").attr("disabled",!0),$("#nivel_alto").attr("disabled",!0),$("#geographic_text_area").attr("disabled",!0),$("#nativo").attr("disabled",!0)},dataType:"json",cache:"false",error:function(a){console.log(a)}})}$("#geographic_direccion").focusout(function(){h()}),$("#geographic_direccion").keypress(function(a){"13"==(a.keyCode?a.keyCode:a.which)&&h()}),$("#geographic_ciudad").on("change",function(){h()}),$("#select_neighborhood").select2({language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando..."}},dropdownAutoWidth:!0}),$("#geographic_ciudad").select2({language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando..."}},dropdownAutoWidth:!0}),$("#button_edit_geographic").on("click",function(){$("#button_edit_geographic").attr("hidden",!0),$("#div_save_buttons").removeAttr("hidden"),$("#select_neighborhood").removeAttr("disabled"),$("#latitude").removeAttr("disabled"),$("#longitude").removeAttr("disabled"),$("#geographic_direccion").removeAttr("disabled"),$("#geographic_ciudad").removeAttr("disabled"),$("#geographic_checkbox_vive_lejos").removeAttr("disabled"),$("#geographic_checkbox_zona_riesgo").removeAttr("disabled"),$("#nivel_bajo").removeAttr("disabled"),$("#nivel_medio").removeAttr("disabled"),$("#nivel_alto").removeAttr("disabled"),$("#geographic_text_area").removeAttr("disabled"),$("#nativo").removeAttr("disabled"),$("#geographic_checkbox_zona_riesgo").prop("checked")&&$("#nativo").removeAttr("disabled");var a=$("#latitude").val(),b=$("#longitude").val();e=i(a,b)}),$("#button_cancel_geographic").on("click",function(){$("#button_edit_geographic").removeAttr("hidden"),$("#div_save_buttons").attr("hidden",!0),$("#select_neighborhood").attr("disabled",!0),$("#latitude").attr("disabled",!0),$("#longitude").attr("disabled",!0),$("#geographic_direccion").attr("disabled",!0),$("#geographic_ciudad").attr("disabled",!0),$("#geographic_checkbox_vive_lejos").attr("disabled",!0),$("#geographic_checkbox_zona_riesgo").attr("disabled",!0),$("#nivel_bajo").attr("disabled",!0),$("#nivel_medio").attr("disabled",!0),$("#nivel_alto").attr("disabled",!0),$("#inmigrante").attr("disabled",!0),$("#geographic_text_area").attr("disabled",!0),$("#nativo").attr("disabled",!0);var c=document.getElementById("geographic_ciudad").value,a=$("#latitude").val(),b=$("#longitude").val();1079==c?document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+a+","+b+"&destination="+f.lat()+","+f.lng()+"&mode=transit'></iframe>":document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+a+","+b+"&destination="+f.lat()+","+f.lng()+"&mode=driving'></iframe>"}),$("#button_save_geographic").on("click",function(){swal({title:"Atenci\xf3n",text:"\xbfEst\xe1 seguro que la ubicaci\xf3n del marcador en el mapa coincide con la direcci\xf3n del estudiante?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"S\xed",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0},function(o){if(o){var c,p,h,q=$("input[name=geographic_nivel_riesgo]:checked").val(),r=$("#select_neighborhood").val(),a=parseFloat($("#latitude").val()),b=parseFloat($("#longitude").val()),i=$("#geographic_direccion").val(),l=$("#geographic_ciudad").val(),s=0,t=0;if(!g){j(d,a,b,s,t,i,r,l,q);return}var m=document.getElementById("geographic_ciudad"),n=m.options[m.selectedIndex].text,u=i+" "+n+" Colombia";document.getElementById("direccion_res").value=i,document.getElementById("municipio_act").value=n;var v={query:u,fields:["photos","formatted_address","name","rating","opening_hours","geometry"]},w=document.getElementById("mapa");(service=new google.maps.places.PlacesService(w)).findPlaceFromQuery(v,function(a){null!=a&&(h=a[0])}),null!=h?(a=h.geometry.location.lat(),b=h.geometry.location.lng()):(a=e.getPosition().lat(),b=e.getPosition().lng()),document.getElementById("latitude").value=a,document.getElementById("longitude").value=b;var x=new google.maps.LatLng(a,b);if(1079==l){var k=document.getElementById("mapa").outerHTML;document.getElementById("geographic_map").innerHTML=k,document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+a+","+b+"&destination="+f.lat()+","+f.lng()+"&mode=transit'></iframe>",c="TRANSIT"}else{var k=document.getElementById("mapa").outerHTML;document.getElementById("geographic_map").innerHTML=k,document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+a+","+b+"&destination="+f.lat()+","+f.lng()+"&mode=driving' allowfullscreen></iframe>",c="DRIVING"}var y={origin:x,destination:f,travelMode:c};p.route(y,function(e,f){var c=e.routes[0].legs[0];t=c.distance.value,s=c.duration.value,j(d,a,b,s,t,i,r,l,q)})}})})}}})