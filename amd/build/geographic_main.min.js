define ("block_ases/geographic_main",["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui"],function(a){return{init:function init(){var e=new google.maps.LatLng(3.3741569,-76.5355235),f=new google.maps.LatLng(3.431626,-76.546822),g=a("#id_ases").val(),h=document.querySelector("#cod_programa_activo").dataset.info,i=h[1],j="6"===i||"8"===i?f:e,k=function(){var a=new google.maps.Geocoder;a.geocode({address:"prueba"},function(a,b){return b==google.maps.GeocoderStatus.OK})}(),l;a("#geographic_direccion").focusout(function(){b()});a("#geographic_direccion").keypress(function(a){var c=a.keyCode?a.keyCode:a.which;if("13"==c){b()}});a("#geographic_ciudad").on("change",function(){b()});a("#select_neighborhood").select2({language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando..."}},dropdownAutoWidth:!0});a("#geographic_ciudad").select2({language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando..."}},dropdownAutoWidth:!0});a("#button_edit_geographic").on("click",function(){a("#button_edit_geographic").attr("hidden",!0);a("#div_save_buttons").removeAttr("hidden");a("#select_neighborhood").removeAttr("disabled");a("#latitude").removeAttr("disabled");a("#longitude").removeAttr("disabled");a("#geographic_direccion").removeAttr("disabled");a("#geographic_ciudad").removeAttr("disabled");a("#geographic_checkbox_vive_lejos").removeAttr("disabled");a("#geographic_checkbox_zona_riesgo").removeAttr("disabled");a("#nivel_bajo").removeAttr("disabled");a("#nivel_medio").removeAttr("disabled");a("#nivel_alto").removeAttr("disabled");a("#geographic_text_area").removeAttr("disabled");a("#nativo").removeAttr("disabled");if(a("#geographic_checkbox_zona_riesgo").prop("checked"))a("#nativo").removeAttr("disabled");var b=a("#latitude").val(),d=a("#longitude").val();l=c(b,d)});a("#button_cancel_geographic").on("click",function(){a("#button_edit_geographic").removeAttr("hidden");a("#div_save_buttons").attr("hidden",!0);a("#select_neighborhood").attr("disabled",!0);a("#latitude").attr("disabled",!0);a("#longitude").attr("disabled",!0);a("#geographic_direccion").attr("disabled",!0);a("#geographic_ciudad").attr("disabled",!0);a("#geographic_checkbox_vive_lejos").attr("disabled",!0);a("#geographic_checkbox_zona_riesgo").attr("disabled",!0);a("#nivel_bajo").attr("disabled",!0);a("#nivel_medio").attr("disabled",!0);a("#nivel_alto").attr("disabled",!0);a("#inmigrante").attr("disabled",!0);a("#geographic_text_area").attr("disabled",!0);a("#nativo").attr("disabled",!0);var b=document.getElementById("geographic_ciudad").value,c=a("#latitude").val(),d=a("#longitude").val();if(1079==b){document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+c+","+d+"&destination="+j.lat()+","+j.lng()+"&mode=transit'></iframe>"}else{document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+c+","+d+"&destination="+j.lat()+","+j.lng()+"&mode=driving'></iframe>"}});a("#button_save_geographic").on("click",function(){swal({title:"Atenci\xF3n",text:"\xBFEst\xE1 seguro que la ubicaci\xF3n del marcador en el mapa coincide con la direcci\xF3n del estudiante?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"S\xED",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0},function(b){if(b){var c=function(a){if(null!=a){u=a[0]}},e=a("input[name=geographic_nivel_riesgo]:checked").val(),f=a("#select_neighborhood").val(),h=parseFloat(a("#latitude").val()),i=parseFloat(a("#longitude").val()),m=a("#geographic_direccion").val(),n=a("#geographic_ciudad").val(),o=0,p=0,q,r;if(!k){d(g,h,i,o,p,m,f,n,e);return}var s=document.getElementById("geographic_ciudad"),t=s.options[s.selectedIndex].text;document.getElementById("direccion_res").value=m;document.getElementById("municipio_act").value=t;var u,v=document.getElementById("mapa");service=new google.maps.places.PlacesService(v);service.findPlaceFromQuery({query:m+" "+t+" Colombia",fields:["photos","formatted_address","name","rating","opening_hours","geometry"]},c);if(null!=u){h=u.geometry.location.lat();i=u.geometry.location.lng()}else{h=l.getPosition().lat();i=l.getPosition().lng()}document.getElementById("latitude").value=h;document.getElementById("longitude").value=i;var w=new google.maps.LatLng(h,i);if(1079==n){var x=document.getElementById("mapa").outerHTML;document.getElementById("geographic_map").innerHTML=x;document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+h+","+i+"&destination="+j.lat()+","+j.lng()+"&mode=transit'></iframe>";q="TRANSIT"}else{var x=document.getElementById("mapa").outerHTML;document.getElementById("geographic_map").innerHTML=x;document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+h+","+i+"&destination="+j.lat()+","+j.lng()+"&mode=driving' allowfullscreen></iframe>";q="DRIVING"}var y={origin:w,destination:j,travelMode:q};r.route(y,function(a){var b=a.routes[0].legs[0];p=b.distance.value;o=b.duration.value;d(g,h,i,o,p,m,f,n,e)})}})});function b(){if(!k){return}var b=new google.maps.Geocoder,d=document.getElementById("geographic_ciudad"),e=a("#geographic_direccion").val(),f=e+" "+d.options[d.selectedIndex].text+" Colombia";b.geocode({address:f},function(a){if(a[0]){var b=a[0].geometry.location.lat(),d=a[0].geometry.location.lng();l=c(b,d);document.getElementById("latitude").value=b;document.getElementById("longitude").value=d}else{console.log("No se encontraron resultados")}})}function c(a,b){if(!k){console.log("Mapas fuera de servicio");return l}document.getElementById("mapa").innerHTML="";var c=new google.maps.Map(document.getElementById("mapa"),{center:j,zoom:14}),d=new google.maps.Marker({position:j,map:c,title:"Universidad del Valle"}),e=new google.maps.InfoWindow;e.setContent("Universidad del Valle");e.open(c,d);var f=new google.maps.Marker({position:{lat:parseFloat(a),lng:parseFloat(b)},map:c}),g=new google.maps.InfoWindow;g.setContent("Residencia Estudiante");g.open(c,f);var h=new google.maps.Geocoder;google.maps.event.addListener(c,"click",function(a){h.geocode({latLng:a.latLng},function(b,d){if(d==google.maps.GeocoderStatus.OK){if(b[0]){if(f){f.setPosition(a.latLng)}else{f=new google.maps.Marker({position:a.latLng,map:c})}g.setContent(b[0].formatted_address+"<br/> Coordenadas: "+b[0].geometry.location);g.open(c,f)}else{console.log("No se encontraron resultados")}}else{console.log("Geocodificaci\xF3n ha fallado debido a: "+d)}})});return f}function d(b,c,d,e,f,g,h,i,j){if(1==i){swal("Error","Debe definir la ciudad del estudiante antes de guardar","error");return}else if(1079==i&&"No registra"==h){swal("Error","Debe definir un barrio de residencia antes de guardar","error");return}else if(null==j){swal("Error","Debe definir un nivel de riesgo antes de guardar","error")}else if(""==g.trim()){swal("Error","Debe definir una direcci\xF3n antes de guardar","error");return}var k=a("#geographic_text_area").val(),l=a("#geographic_checkbox_vive_lejos").prop("checked"),m=a("#geographic_checkbox_zona_riesgo").prop("checked"),n=a("#nativo").prop("checked");a.ajax({type:"POST",data:JSON.stringify({function:"save_geographic_info",params:[b,c,d,h,e,f,g,i,k,l,m,n,j]}),url:"../managers/student_profile/geographic_api.php",success:function success(b){if(0==b.status_code){swal(b.title,b.message,b.type)}else{console.log(b)}a("#button_edit_geographic").removeAttr("hidden");a("#div_save_buttons").attr("hidden",!0);a("#select_neighborhood").attr("disabled",!0);a("#latitude").attr("disabled",!0);a("#longitude").attr("disabled",!0);a("#geographic_direccion").attr("disabled",!0);a("#geographic_ciudad").attr("disabled",!0);a("#geographic_checkbox_vive_lejos").attr("disabled",!0);a("#geographic_checkbox_zona_riesgo").attr("disabled",!0);a("#nivel_bajo").attr("disabled",!0);a("#nivel_medio").attr("disabled",!0);a("#nivel_alto").attr("disabled",!0);a("#geographic_text_area").attr("disabled",!0);a("#nativo").attr("disabled",!0)},dataType:"json",cache:"false",error:function error(a){console.log(a)}})}}}});
//# sourceMappingURL=geographic_main.min.js.map
