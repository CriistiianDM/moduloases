define(['jquery','block_ases/jszip','block_ases/pdfmake','block_ases/jquery.dataTables','block_ases/dataTables.autoFill','block_ases/dataTables.buttons','block_ases/buttons.html5','block_ases/buttons.flash','block_ases/buttons.print','block_ases/bootstrap','block_ases/sweetalert'],function(c,d){return{init:function init(){function n(r){c('#div_res_students').html('<img class="icon-loading" src="../icon/loading.gif"/>'),c.ajax({type:'POST',data:{loadR:'loadReport',value:r},url:'../managers/historic_icetex_reports/icetex_reports_processing.php',success:function success(s){c('#div_res_students').empty(),c('#div_res_students').fadeIn(1e3).append('<table id="tableResStudents" class="display" cellspacing="0" width="80%"><thead><thead></table>');c('#tableResStudents').DataTable(s);c('#tableResStudents').css('cursor','pointer')},dataType:'json',cache:!1,error:function error(){swal('Error','Error al cargar el reporte','error')}})}function o(r){var s=r.column(3,{page:'current'}).data().sum(),t=r.column(3).data().sum(),u=r.column(5,{page:'current'}).data().sum();c(r.column(3).footer()).html('$'+s+'(Total $'+t+')'),c(r.column(5).footer()).html('$'+u)}function p(){c('#div_resolutions').html('<img class="icon-loading" src="../icon/loading.gif"/>'),c.ajax({type:'POST',data:{resR:'resReport'},url:'../managers/historic_icetex_reports/resolution_reports_processing.php',success:function success(r){c('#div_resolutions').empty(),c('#div_resolutions').fadeIn(1e3).append('<table id="tableResolutions" class="display" cellspacing="0" width="100%"><thead><thead><tfoot id="table_res_foot"><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tfoot></table>');var s=c('#tableResolutions').DataTable(r);c('#tableResolutions').on('page.dt',function(){o(s)}),c('#tableResolutions').on('draw.dt',function(){o(s)}),o(s),c('#div_resolutions').css('cursor','pointer')},dataType:'json',cache:!1,error:function error(){swal('Error','Error al cargar el reporte','error')}})}function q(r){c('#div_report_summary').html('<img class="icon-loading" src="../icon/loading.gif"/>'),c.ajax({type:'POST',data:{summ:'summaryR',cohor:r},url:'../managers/historic_icetex_reports/summary_report_processing.php',success:function success(s){c('#div_report_summary').empty(),c('#div_report_summary').fadeIn(1e3).append('<table id="tableSummary" class="display" cellspacing="0" width="100%"><thead><thead><tfoot id="table_summ_foot"><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tfoot></table>');var t=c('#tableSummary').DataTable(s),u=t.column(9).data().sum(),v=t.column(3).data().sum(),w=t.column(5).data().sum(),x=t.column(7).data().sum();c(t.column(3).footer()).html('$'+v),c(t.column(5).footer()).html('$'+w),c(t.column(7).footer()).html('$'+x),c(t.column(9).footer()).html('$'+u),c('#div_report_summary').css('cursor','pointer')},dataType:'json',cache:!1,error:function error(){swal('Error','Error al cargar el reporte','error')}})}window.JSZip=d,c('#stu_res_button').on('click',function(){var r=c('#check_no_res').is(':checked');n(r)}),c(document).on('click','#tableResStudents tbody tr td',function(){var s=c('#tableResStudents').DataTable(),t=s.cell(this).index().column;1<=t&&4>=t&&(c('#formulario').each(function(){this.reset}),window.open('student_profile.php'+location.search+'&student_code='+s.cell(s.row(this).index(),1).data(),'_blank'))}),jQuery.fn.dataTable.Api.register('sum()',function(){var r=0;return this.flatten().reduce(function(s,t){return'string'==typeof s&&(s=1*s.replace(/[\$.]/g,'')),'string'==typeof t&&(t=1*t.replace(/[\$.]/g,'')),r=parseInt(s,10)+parseInt(t,10),r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,'.')},0)}),c('#list-resolutions-panel').on('click',function(){p()}),c('#report_button').on('click',function(){var r=c('#cohort_select select').val();''==r?swal('Informaci\xF3n','Seleccione una cohorte v\xE1lida','info'):q(r)}),c(document).on('change','#tableResStudents thead tr th select',function(){var r=c('#tableResStudents').DataTable(),s=c(this).parent().index()+1;r.columns(s-1).search(this.value).draw()}),c(document).on('change','#tableResolutions thead tr th select',function(){var r=c('#tableResolutions').DataTable(),s=c(this).parent().index()+1;r.columns(s-1).search(this.value).draw()})}}});