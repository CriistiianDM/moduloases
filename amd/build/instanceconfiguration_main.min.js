define(["jquery","block_ases/sweetalert","block_ases/datatables.net","block_ases/datatables.net-buttons","block_ases/buttons.flash","block_ases/jszip","block_ases/pdfmake","block_ases/buttons.html5","block_ases/buttons.print"],function(e,a,n){return{init:function(){function a(){var a=e("#username_input").val(),n=new Array;n.push({name:"function",value:"search"}),n.push({name:"username",value:a}),e.ajax({type:"POST",data:n,url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(a){a.error?swal({title:"Error",html:!0,type:"error",text:a.error,confirmButtonColor:"#D3D3D3"}):(e("#username_input").prop("disabled",!0),e("#lista_programas").prop("disabled",!1),e("#name_lastname").val(a.firstname+" "+a.lastname),e("#lista_programas").append('<option value="'+a.cod_programa+'" selected> '+a.cod_programa+" - "+a.nombre_programa+"</option>"),1==a.seg_academico?e('label input[name="segAca"][ value="1"]').prop("checked",!0):e('label input[name="segAca" ][ value="0"]').prop("checked",!0),1==a.seg_asistencias?e('label input[name="segAsis" ][ value="1"]').prop("checked",!0):e('label input[name="segAsis"][ value="0"]').prop("checked",!0),1==a.seg_socioeducativo?e('label input[name="segSoc" ][ value="1"]').prop("checked",!0):e('label input[name="segSoc"][ value="0"]').prop("checked",!0))},dataType:"json",cache:"false",error:function(e){console.log(e)}})}function n(){e("#lista_programas").html(""),e.ajax({type:"POST",data:[{name:"function",value:"load_programs"}],url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(a){if(e("#lista_programas").append('<option value="0" selected> 0000 - Ninguno</option>'),a)for(x in a)e("#lista_programas").append('<option value="'+a[x].cod_univalle+'">'+a[x].cod_univalle+" - "+a[x].nombre+"</option>")},dataType:"json",cache:"false",error:function(e){console.log(e)}})}function t(){e("#username_input").prop("disabled",!1),e("#name_lastname").prop("disabled",!1);var a=e("#username_input").val(),t=e("#lista_programas option[value='"+e("#lista_programas").val()+"']").text(),s=(e("#lista_programas").val(),e("input, select").serializeArray());e("#username_input").prop("disabled",!0),e("#name_lastname").prop("disabled",!0);var r=0,i=location.search.split("&");for(x in i)i[x].indexOf("instanceid")>=0&&(r=i[x].split("=")[1]);s.push({name:"idinstancia",value:r}),s.push({name:"function",value:"updateUser"}),e.ajax({type:"POST",data:s,url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(s){!0===s?(swal({title:"Actualizado con exito!!",html:!0,type:"success",text:"El usuario con código "+a+" es ahora administrador del sistema de "+t,confirmButtonColor:"#d51b23"},function(e){}),e("#next_div").fadeIn(),o(),n()):swal({title:"Error :(",html:!0,type:"error",text:s,confirmButtonColor:"#d51b23"},function(e){})},dataType:"json",cache:"false",error:function(e){console.log(e)}})}function o(){var a=new Array;a.push({name:"function",value:"loadSystemAdministrators"}),e.ajax({type:"POST",data:a,url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(a){e("#div_users").empty(),e("#div_users").append('<table id="tableUsers" class="display" cellspacing="0" width="100%"><thead><thead></table>');e("#tableUsers").DataTable(a);e("#div_users #delete_user").css("cursor","pointer")},dataType:"json",cache:"false",error:function(e){console.log(e)}})}function s(a){var t=new Array;t.push({name:"function",value:"deleteUser"}),t.push({name:"username",value:a}),e.ajax({type:"POST",data:t,url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(e){!0===e?(swal({title:"Actualizado con exito!!",html:!0,type:"success",text:"El usuario con código "+a+" se ha eliminado satisfactoriamente",confirmButtonColor:"#d51b23"},function(e){}),o(),n()):swal({title:"Error :(",html:!0,type:"error",text:e,confirmButtonColor:"#d51b23"},function(e){})},dataType:"json",cache:"false",error:function(e){console.log(e)}})}e(document).ready(function(){e("#search_button").on("click",function(){e(".assignment_li").removeClass("hidden");var n=e("#username_input").val();if(null===n||""==n)return 0;a()}),e("#ok_button").on("click",function(){t()}),e("#cancel_button").on("click",function(){e(".assignment_li").addClass("hidden"),e("#form_mon_student").fadeOut(),e("#username_input").val(""),e("#username_input").prop("disabled",!1),e("#name_lastname").val(" "),e("#form_prof_type").fadeOut()}),e("#next").on("click",function(){location.href="upload_files_form.php"+location.search}),e("#listadministradores").on("click",function(){o()}),o(),e("#div_users").on("click","#delete_user",function(){var a=e("#div_users #tableUsers").DataTable(),n=e(this).parent(),t=(e(this).children("span").attr("id"),a.cell(n).index().column,a.cell(a.row(n).index(),0).data()),o=a.cell(a.row(n).index(),1).data(),r=a.cell(a.row(n).index(),2).data();swal({title:"¿Estas seguro/a?",text:"Al usuario <strong>"+o+" "+r+"</strong> con código <strong>"+t+"</strong> se le inhabilitará los permisos de administrador del sistema</strong>.<br><strong>¿Estás de acuerdo con los cambios que se efectuarán?</strong>",type:"warning",html:!0,showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si!",cancelButtonText:"No",closeOnConfirm:!0},function(e){e&&s(t)})})})}}});