define(["jquery","block_ases/bootstrap","block_ases/datatables","block_ases/sweetalert"],function(a,b,c,d){return{init:function(){function b(b,c){a.ajax({type:"POST",data:{"function":"insert_cohort",cohort:b,instance:c},url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(a){if(0==a.status)var b="Error",c="error";else var b="Éxito",c="success";d(b,a.msg,c)},dataType:"json",cache:!1,async:!1,error:function(){d("Error","Error al comunicarse con el servidor.","error")}})}function c(b){a.ajax({type:"POST",data:{"function":"load_cohorts",instance:b},url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(b){if(0==b.status)a("#div_cohorts_table").html("<center><span>La instancia no tiene cohortes asignadas</span></center>");else{var c="";c+="<h4>Cohortes asignadas a la instancia</h4><hr/>",c+="<table id='cohorts_table' class='col-sm-12' style='width:100%'></table>",a("#div_cohorts_table").html(c),a("#cohorts_table").DataTable(b.msg)}},dataType:"json",cache:!1,async:!1,error:function(){d("Error","Error al cargar las cohortes asignadas","error")}})}function e(b){a.ajax({type:"POST",data:{"function":"load_cohorts_without_assignment",instance:b},url:"../managers/instance_management/instance_configuration_serverproc.php",success:function(b){if(0==b.status)d("Error",b.msg,"error");else if(1==b.status){var c="",e=b.msg;0==e.length?c+="<option>No hay cohortes disponibles para asignar</option>":a.each(e,function(a){c+="<option value='"+e[a].id+"'>",c+=e[a].idnumber+" "+e[a].name+"</option>"}),a("#select_cohorts").html(c)}else{var f="Error al cargar las cohortes no asignadas. Por favor recargue la página.";f+="Si el problema persiste contacte al área de sistemas.",d("Error",f,"error")}},dataType:"json",cache:!1,async:!1,error:function(){d("Error","Error al cargar las cohortes sin asignación","error")}})}function f(){var a=location.search.split("&");for(var b in a)if(a[b].indexOf("instanceid")>=0){var c=a[b].split("=");return c[1]}return 0}var g=f();a(document).ready(function(){c(g),a("span.unassigned_cohort").on("click",function(){this.unassign_cohort()})}),a("#button_assign_cohort").on("click",function(){var d=a("#select_cohorts").val();b(d,g),c(g),e(g)})},unassign_cohort:function(){alert("success!!")}}});