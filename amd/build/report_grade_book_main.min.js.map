{"version":3,"sources":["../src/report_grade_book_main.js"],"names":["define","$","init","document","ready","pilos","getIDs","prop","deleteNoPilos","bloquearTotales","length","new_page","location","origin","getCourseid","swal","title","text","type","showCancelButton","confirmButtonClass","confirmButtonText","closeOnConfirm","href","on","val","reload","each","input","children","next","css","removeAttr","attr","isPilo","remove","click","id","parent","code","url","search","i","split","push","informacionUrl","window","elemento","curso"],"mappings":"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","sourcesContent":[" /**\n * Management - grade book, disabling fields (not editing).\n * @module amd/src/report_grade_book_main\n * @author Juan Pablo Moreno Mu침oz\n * @copyright 2018 Juan Pablo Moreno Mu침oz <moreno.juan@correounivalle.edu.co>\n * @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert', 'block_ases/jqueryui'], function ($, bootstrap, sweetalert, jqueryui) {\n\n    return {\n\n        init: function () {\n            var grade;\n\n            $(document).ready(function () {\n                var pilos = getIDs();\n                $(\".text\").prop('disabled', true);\n                deleteNoPilos(pilos);\n                bloquearTotales();\n                if ($('.gradingerror').length != 0) {\n                    //Redirect to a new page given the course id \n                    new_page = location.origin + \"/moodle/grade/report/grader/index.php?id=\" + getCourseid();\n                    swal({\n                        title: \"Redireccionando p치gina.\",\n                        text: \"Debido al proceso de actualizaci칩n del campus virtual se debe realizar este paso.\\nSOLO EL DOCENTE ENCARGADO DEL CURSO PUEDE \\n Una vez realizado por favor cerrar la ventana y volver a seleccionar su curso en el listado\",\n                        type: \"warning\",\n                        showCancelButton: false,\n                        confirmButtonClass: \"btn-danger\",\n                        confirmButtonText: \"Continuar\",\n                        closeOnConfirm: false\n                    },\n                        function () {\n                            location.href = new_page;\n                        });\n                }\n            });\n\n            $(document).on('focus', '.text', function () {\n                grade = $(this).val();\n                //console.log(grade);\n            });\n\n            $(document).on('click', '.reload', function () {\n\n                location.reload();\n            });\n            \n            /**\n             * @method bloquearTotales\n             * @desc Changes css style, font size and remove the href attribute (link)\n             * @return {void}\n             */\n            function bloquearTotales() {\n                $('.cat').each(function () {\n                    var input = $(this).children().next('.text');\n                    //input.attr('disabled', true);\n                    input.css('font-weight', 'bold');\n                });\n                $(\"[name^='grade']\").prop('disabled', true);\n                $(\"a\").removeAttr(\"href\");\n\n                $('.course').each(function () {\n                    var input = $(this).children().next('.text');\n                    input.css('font-weight', 'bold');\n                    input.css('font-size', 16);\n                });\n\n                $('.header').children().each(function () {\n                    $(this).removeAttr('href');\n                });\n            }\n\n\n            /**\n             * @method deleteNoPilos\n             * @desc Removes every student who's not 'pilo'. IF the student is 'pilo' remove href attribute (link to other page)\n             * @param {array} pilos students with cohort 'pilo'\n             * @return {void}\n             */\n            function deleteNoPilos(pilos) {\n                $(\"#user-grades\").children().children().each(function () {\n                    if ($(this).attr('data-uid') != undefined) {\n                        if (!isPilo($(this).attr('data-uid'), pilos)) {\n                            $(this).remove();\n                        } else {\n                            $(this).children('th').children().each(function () {\n                                $(this).removeAttr('href');\n                                $(this).click(function () {\n                                    var id = $(this).parent().parent().attr('data-uid');\n                                    var code = $('#idmoodle_' + id).attr('data-code');\n                                    var pagina = \"student_profile.php\";\n                                    var url = pagina + location.search + \"&student_code=\" + code;\n                                    //window.open(url, '_blank');\n                                });\n                            });\n                        }\n                    }\n                });\n            }\n\n            /**\n             * @method isPilo\n             * @desc Verifies if an id is in a given array\n             * @param {id} id id to verify in an array\n             * @param {array} pilos students with category 'pilo'\n             * @return {boolean} true if the given id is in the array, false otherwise\n             */\n            function isPilo(id, pilos) {\n                for (var i = 0; i < pilos.length; i++) {\n                    if (pilos[i].split(\"_\")[1] === id) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            /**\n             * @method getIDs\n             * @desc gets all students id of element with attribute students-pilos from DOM\n             * @return {array} students 'pilos' ids\n             */\n            function getIDs() {\n                var pilos = new Array;\n                $(\"#students-pilos\").children().each(function () {\n                    pilos.push($(this).attr(\"id\"));\n                });\n                return pilos;\n            }\n\n            /**\n             * @method getCourseid\n             * @desc Obtains the course id present on the url\n             * @return {}\n             */\n            function getCourseid() {\n                var informacionUrl = window.location.search.split(\"&\");\n                for (var i = 0; i < informacionUrl.length; i++) {\n                    var elemento = informacionUrl[i].split(\"=\");\n                    if (elemento[0] == \"?id_course\" || elemento[0] == \"id_course\") {\n                        var curso = elemento[1];\n                        return curso;\n                    }\n                }\n            }\n        }\n    };\n});\n\n"],"file":"report_grade_book_main.min.js"}