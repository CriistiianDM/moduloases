{"version":3,"sources":["../src/not_assigned_students_main.js"],"names":["define","$","init","console","log","self","instance_id","get_id_instance","load_not_assigned_students","on","create_assign_table","document","table","DataTable","current_row","row","parents","data","student","username","monitores","closest","find","val","practicantes","next","msg","ajax","type","monitor","practicant","instance","url","success","alert","dataType","cache","error","colIndex","cell","index","column","each","reset","location","href","search","user","source","remove","end","append","dataString","serializeArray","push","name","value","html","fadeIn","urlParameters","split","x","indexOf","intanceparameter"],"mappings":"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","sourcesContent":["/**\n * not_assigned_students\n * @module amd/src/not_assigned_students\n * @author Isabella Serna Ramirez\n * @copyright 2018 Isabella Serna Ramirez <isabella.serna@correounivalle.edu.co>\n * @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n/**\n * @module block_ases/not_assigned_students\n */\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/jquery.dataTables', 'block_ases/sweetalert', 'block_ases/dphpforms_form_renderer'],\n    function($, bootstrap, datatables, swal, renderer_forms) {\n\n        return {\n\n            init: function() {\n\n              console.log(\"pass\");\n\n                var self = this;\n                var instance_id = self.get_id_instance();\n                self.load_not_assigned_students(instance_id);\n\n                $(\"#send_form_btn\").on('click', function() {\n                    self.create_assign_table(instance_id);\n                });\n\n                //Asignaci√≥n de estudiantes a monitores/practicantes por parte de profesional.\n                $(document).on('click', '#tableAssign tbody tr td #student_assign', function() {\n                    var table = $(\"#tableAssign\").DataTable();\n                    var current_row = table.row($(this).parents('tr')).data();\n                    var instance = instance_id;\n                    var student = current_row.username;\n                    var monitores = $(this).closest('tr').find('#monitors').val();\n                    var practicantes = $(this).closest('tr').find('#practicants').val();\n\n                    var next = true;\n                    var msg = \"\";\n                    if (monitores == '-1') {\n                        next = false;\n                        msg += \"* Debe elegir monitor a asignar \\n\";\n                    }\n                    if (practicantes == '-1') {\n                        next = false;\n                        msg += \"*Debe elegir practicantes a asignar\";\n                    }\n\n                    if (next) {\n                        $.ajax({\n                            type: \"POST\",\n                            data: {\n                                type: \"assign_student\",\n                                monitor: monitores,\n                                practicant: practicantes,\n                                instance: instance,\n                                student: student\n\n                            },\n                            url: \"../managers/ases_report/asesreport.php\",\n                            success: function(msg) {\n                                alert(msg);\n                                self.load_not_assigned_students(instance_id);\n                            },\n\n                            dataType: \"text\",\n                            cache: \"false\",\n                            error: function(msg) {\n                                alert(\"Debe seleccionar solo un practicante y monitor a la vez\");\n                                console.log(\"Error al asignar estudiantes\" + msg);\n                            },\n                        });\n                    } else {\n                        alert(msg);\n                    }\n                });\n\n                //Controles para la tabla generada\n                $(document).on('click', '#tableAssign tbody tr td', function() {\n                    var pagina = \"student_profile.php\";\n                    var table = $(\"#tableAssign\").DataTable();\n                    var colIndex = table.cell(this).index().column;\n\n                    if (colIndex <= 2) {\n                        $(\"#formulario\").each(function() {\n                            this.reset;\n                        });\n                        location.href = pagina + location.search + \"&student_code=\" + table.cell(table.row(this).index(), 0).data();\n                    }\n                })\n\n\n                //Despliega monitores deacuerdo al practicante seleccionado\n\n                $(document).on('change', '#tableAssign tbody tr td select#practicants', function() {\n\n                    var user = $(this).val();\n                    var source = \"list_monitors\";\n                    var instancia = instance_id;\n\n                    $.ajax({\n                        type: \"POST\",\n                        data: {\n                            user: user,\n                            instance: instancia,\n                            source: source\n                        },\n                        url: \"../managers/ases_report/asesreport.php\",\n                        success: function(msg) {\n                            $(\"select#monitors\").find('option').remove().end();\n                            $(\"select#monitors\").append(msg);\n                        },\n                        dataType: \"json\",\n                        cache: \"false\",\n                        error: function(msg) {\n                            alert(\"Error al cargar monitores con practicante seleccionado\")\n                        },\n                    });\n\n                });\n\n\n            },\n\n            create_assign_table: function(instance_id) {\n\n                var dataString = $('#form_general_report').serializeArray();\n\n                dataString.push({\n                    name: 'instance_id',\n                    value: instance_id\n                });\n\n                $(\"#not_assigned_students\").html('<img class=\"icon-loading\" src=\"../icon/loading.gif\"/>');\n                $.ajax({\n                    type: \"POST\",\n                    data: dataString,\n                    url: \"../managers/ases_report/load_not_assigned_students.php\",\n                    success: function(msg) {\n                        $(\"#not_assigned_students\").html('');\n                        $(\"#not_assigned_students\").fadeIn(1000).append('<table id=\"tableAssign\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead> </thead></table>');\n\n\n                        var table = $(\"#tableAssign\").DataTable(msg);\n\n                    },\n\n                    dataType: \"json\",\n                    cache: \"false\",\n                    error: function(msg) {\n                        alert(\"Error al cargar estudiantes no asignados\")\n                    },\n                });\n            },\n            load_not_assigned_students: function(instance_id) {\n\n                var dataString = $('#form_general_report').serializeArray();\n\n                dataString.push({\n                    name: 'instance_id',\n                    value: instance_id\n                });\n\n                $(\"#not_assigned_students\").html('<img class=\"icon-loading\" src=\"../icon/loading.gif\"/>');\n                $.ajax({\n                    type: \"POST\",\n                    data: dataString,\n                    url: \"../managers/ases_report/load_not_assigned_students.php\",\n                    success: function(msg) {\n                        $(\"#not_assigned_students\").html('');\n                        $(\"#not_assigned_students\").fadeIn(1000).append('<table id=\"tableAssign\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead> </thead></table>');\n\n\n                        var table = $(\"#tableAssign\").DataTable(msg);\n\n                    },\n\n                    dataType: \"json\",\n                    cache: \"false\",\n                    error: function(msg) {\n                        alert(\"Error al cargar estudiantes no asignados\")\n                    },\n                });\n\n            }, \n\n\n            //Check the current instance\n            get_id_instance: function() {\n                var urlParameters = location.search.split('&');\n                for (var x in urlParameters) {\n                    if (urlParameters[x].indexOf('instanceid') >= 0) {\n                        var intanceparameter = urlParameters[x].split('=');\n                        return intanceparameter[1];\n                    }\n                }\n                return 0;\n            }\n        };\n    });\n"],"file":"not_assigned_students_main.min.js"}