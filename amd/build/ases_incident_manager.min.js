'use strict';define(['jquery','block_ases/sweetalert','block_ases/jqueryui','block_ases/loading_indicator'],function(a,b,c,d){return console.log('ases_incident_manager loaded'),{init:function init(){function e(g){d.show(),a.ajax({method:'POST',url:'../managers/incident_manager/incident_api.php',contentType:'application/json',dataType:'json',data:JSON.stringify({'function':'get_incident',params:[g]}),async:!1,success:function success(h){d.hide();var i=JSON.parse(JSON.parse(h.data_response).comentarios),j=JSON.parse(h.data_response).usuario_registra,k=JSON.parse(h.data_response).usuario_cierra,l=i[0].message.title,m=i[0].message.commentary,n=JSON.parse(h.data_response).cerrada,o=JSON.parse(h.data_response).fecha_hora_registro;a('.inc_detail').html('<strong>Detalle: </strong>'+m),a('.opened_by').html('<strong>Abierta por:</strong> '+j.firstname+' '+j.lastname+' - '+j.username),a('.inc_preview').find('a').attr('href','ases_incidents_preview.php?incident_id='+g),a('.record_datetime').html('<strong>Fecha y hora:</strong> '+o),a('#close_incident').attr('data-id',g),a('.inc_preview').show(),1==n?(a('.inc_opc').hide(),a('.inc_title').html('<h2>Ticket #'+g+' [Cerrada] - '+l+'</h2>'),a('.closed_by').html('<strong>Cerrada por:</strong> '+k.firstname+' '+k.lastname)):(a('.inc_title').html('<h2>Ticket #'+g+' - '+l+'</h2>'),a('.inc_opc').show())},error:function error(h,i,j){d.hide(),console.log('some error '+i+' '+j),console.log(h)}})}function f(g){swal({html:!0,title:'Confirmaci\xF3n',text:'<strong>Nota importante!</strong>: Est\xE1 cerrando una incidencia.',type:'warning',showCancelButton:!0,confirmButtonText:'S\xED, cerrar!'},function(h){h&&(d.show(),a.ajax({method:'POST',url:'../managers/incident_manager/incident_api.php',contentType:'application/json',dataType:'json',data:JSON.stringify({'function':'close_logged_user_incident',params:[g]}),success:function success(i){d.hide(),0===i.status_code?swal('\xC9xito!','Se ha cerrado correctamente la incidencia','success'):swal('Error!','Oops!: Al parece no existe la incidencia','error')},error:function error(i,j,k){d.hide(),console.log('some error '+j+' '+k),console.log(i)}}))})}a(document).on('click','.inc_item',function(){var g=a(this).data('id');e(g)}),a(document).on('click','#close_incident',function(){var g=a(this).data('id');f(g)})}}});