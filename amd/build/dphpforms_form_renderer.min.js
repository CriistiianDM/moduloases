<<<<<<< HEAD
define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2"],function(a,b,c,d,e){return{init:function(){function b(){var a=location.search.split("&");for(var b in a)if(a[b].indexOf("student_code")>=0){var c=a[b].split("=");return c[1].split("-")[0]}return 0}function c(c){var e=d(".puntuacion_riesgo_individual"),f=a(".comentarios_individual").find("textarea").val(),g=d(".puntuacion_riesgo_familiar"),h=a(".comentarios_familiar").find("textarea").val(),i=d(".puntuacion_riesgo_academico"),j=a(".comentarios_academico").find("textarea").val(),k=d(".puntuacion_riesgo_economico"),l=a(".comentarios_economico").find("textarea").val(),m=d(".puntuacion_vida_uni"),n=a(".comentarios_vida_uni").find("textarea").val();if("3"==e||"3"==g||"3"==i||"3"==k||"3"==m){var o={"function":"send_email_dphpforms",student_code:b(),risks:[{name:"Individual",risk_lvl:e,observation:f},{name:"Familiar",risk_lvl:g,observation:h},{name:"Académico",risk_lvl:i,observation:j},{name:"Económico",risk_lvl:k,observation:l},{name:"Vida Universitaria",risk_lvl:m,observation:n}],date:a(".fecha").find("input").val(),url:window.location.href};console.log(JSON.stringify(o)),a.ajax({type:"POST",data:JSON.stringify(o),url:"../managers/pilos_tracking/send_risk_email.php",success:function(a){console.log(a)},dataType:"text",cache:"false",error:function(a){console.log(a)}})}}function d(b){var c=0;return a(b).find(".opcionesRadio").find("div").each(function(){a(this).find("label").find("input").is(":checked")&&(c=a(this).find("label").find("input").val())}),c}function e(a){}function f(b,c){a.get("../managers/dphpforms/dphpforms_forms_core.php?form_id="+b+"&record_id="+c,function(b){a("#body_editor").html(""),a("#body_editor").append(b),a("#permissions_informationr").html("");var c=a(".dphpforms-record").find(".revisado_profesional").find(".checkbox").find("input[type=checkbox]").prop("checked"),d=a(".dphpforms-record").find(".revisado_practicante").find(".checkbox").find("input[type=checkbox]").prop("checked");(c||d)&&a(".dphpforms-record").find(".btn-dphpforms-delete-record").remove();for(var f=JSON.parse(a("#permissions_information").text()),g=0;g<f.behaviors_permissions.length;g++){for(var h=f.behaviors_permissions[g].behaviors[0],i=h.behaviors_accessibility,j=0;j<i.length;j++){var k=i[j].disabled;"true"==k?k=!0:"false"==k&&(k=!1),a(".dphpforms-record").find("#"+i[j].id).prop("disabled",k),a(".dphpforms-record").find("."+i[j]["class"]).prop("disabled",k)}for(var l=h.behaviors_fields_to_remove,j=0;j<l.length;j++)a(".dphpforms-record").find("#"+l[j].id).remove(),a(".dphpforms-record").find("."+l[j]["class"]).remove();for(var m=h.limpiar_to_eliminate,j=0;j<m.length;j++)a(".dphpforms-record").find("."+m[j]["class"]+".limpiar ").remove()}a("#permissions_informationr").html("");var n=b.indexOf("primer_acercamiento_");n!=-1&&e("primer_acercamiento");var o=b.indexOf("seguimiento_de_pares_");o!=-1&&e("seguimiento_pares")})}a("#button_actualizar_primer_acercamiento").click(function(){a.get("../managers/dphpforms/dphpforms_forms_core.php?form_id=primer_acercamiento&record_id="+a(this).attr("data-record-id"),function(b){a("#primer_acercamiento_form").html(""),a("#primer_acercamiento_form").append(b),a("#modal_primer_acercamiento").fadeIn(300);var c=a("#modal_primer_acercamiento").find(".pa_id_creado_por").find("input").val();a.get("../managers/user_management/api_user.php?function=get_user_information&arg="+c,function(b){var c=b.firstname+" "+b.lastname;a("#modal_primer_acercamiento").find("h1").after('<hr style="border-color:#444;"><h3>Registrado por: <strong>'+c+"</strong></h3>")})})}),a(".btn.btn-danger.btn-univalle.btn-card").click(function(){var b=a(this).attr("data-container"),c=a("#"+b).height();if(0==c)a(this).find("span").removeClass("glyphicon-chevron-left"),a(this).find("span").addClass("glyphicon-chevron-down");else{for(;c<0;)c=a("#"+b).height();a(this).find("span").removeClass("glyphicon-chevron-down"),a(this).find("span").addClass("glyphicon-chevron-left")}}),a("#button_add_v2_track").on("click",function(){a("#modal_v2_peer_tracking").fadeIn(300),a(".id_estudiante").find("input").val(b());var c=a("#current_user_id").val();a(".id_creado_por").find("input").val(c)}),a("#button_primer_acercamiento").on("click",function(){a("#modal_primer_acercamiento").fadeIn(300),a(".primer_acerca_id_estudiante_field").find("input").val(b());var c=a("#current_user_id").val();a(".primer_acerca_id_creado_por_field").find("input").val(c)}),a("#button_add_geographic_track").on("click",function(){a("#modal_seguimiento_geografico").fadeIn(300)}),a(".mymodal-close").click(function(){a(this).parent().parent().parent().parent().fadeOut(300)}),a(".dphpforms-peer-record").on("click",function(){var b=a(this).attr("data-record-id");f("seguimiento_pares",b),a("#modal_v2_edit_peer_tracking").fadeIn(300)}),a(".limpiar").click(function(){a(this).parent().find(".opcionesRadio").find("div").each(function(){a(this).find("label").find("input").prop("checked",!1)})}),a(document).on("click",".limpiar",function(){a(this).parent().find(".opcionesRadio").find("div").each(function(){a(this).find("label").find("input").prop("checked",!1)})}),a(document).on("submit",".dphpforms",function(d){d.preventDefault();var e=new FormData(this),f=a(this),g=f.attr("action");"procesador.php"==f.attr("action")&&(g="../managers/dphpforms/procesador.php"),a(f).find("button").prop("disabled",!0),a(f).find("a").attr("disabled",!0),a.ajax({type:"POST",url:g,data:e,cache:!1,contentType:!1,processData:!1,success:function(d){var e=JSON.parse(d);if(console.log(d),0==e.status){var g="";"Stored"==e.message?g="Almacenado":"Updated"==e.message&&(g="Actualizado"),c(),swal({title:"Información",text:g,type:"success"},function(){"Updated"==e.message?a("#dphpforms-peer-record-"+a("#dphpforms_record_id").val()).stop().animate({backgroundColor:"rgb(175, 255, 173)"},400).animate({backgroundColor:"#f5f5f5"},4e3):(a(".dphpforms-response").trigger("reset"),location.reload())}),a("#modal_v2_edit_peer_tracking").fadeOut(300),a("#modal_v2_peer_tracking").fadeOut(300),a("#modal_primer_acercamiento").fadeOut(300),a("#modal_seguimiento_geografico").fadeOut(300),a(f).find("button").prop("disabled",!1),a(f).find("a").attr("disabled",!1),a.get("../managers/pilos_tracking/api_pilos_tracking.php?function=update_last_user_risk&arg="+b(),function(a){console.log(a)})}else if(e.status==-2){a(f).find("button").prop("disabled",!1),a(f).find("a").attr("disabled",!1);var g="";"Without changes"==e.message?g="No hay cambios que registrar":"Unfulfilled rules"==e.message&&(g="Revise los valores ingresados"),swal("Alerta",g,"warning")}else e.status==-1&&(console.log(d),swal("ERROR!","Oops!, informe de este error","error"))},error:function(b){console.log(b),swal("Error!","Oops!, informe de este error","error"),a(f).find("button").prop("disabled",!1),a(f).find("a").attr("disabled",!1)}})}),a(document).on("click",".btn-dphpforms-delete-record",function(){swal({title:"Confirmación",text:"Está eliminando este registro, ¿desea continuar?",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, Eliminar!"},function(b){if(b){var c=a(".btn-dphpforms-delete-record").attr("data-record-id");a.get("../managers/dphpforms/dphpforms_delete_record.php?record_id="+c,function(b){var c=b;0==c.status?swal({title:"Información",text:"Eliminado",type:"success"},function(){a("#modal_v2_edit_peer_tracking").fadeOut(300),a("#modal_primer_acercamiento").fadeOut(300),location.reload()}):c.status==-1&&swal("Error!",c.message,"error")})}})})}}});
=======
'use strict';define(['jquery','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function g(){var n=location.search.split('&');for(var o in n)if(0<=n[o].indexOf('student_code')){var p=n[o].split('=');return p[1].split('-')[0]}return 0}function h(){var o=k('.seg_geo_nivel_riesgo'),p=a('.seg_geo_observaciones').find('textarea').val();if('3'==o){var q={'function':'send_email_dphpforms',student_code:g(),risks:[{name:'Geogr\xE1fico',risk_lvl:o,observation:p}],date:a('.fecha').find('input').val(),url:window.location.href};console.log(JSON.stringify(q)),a.ajax({type:'POST',data:JSON.stringify(q),url:'../managers/pilos_tracking/send_risk_email.php',success:function success(r){console.log(r)},dataType:'text',cache:'false',error:function error(r){console.log(r)}})}}function j(){var o=k('.puntuacion_riesgo_individual'),p=a('.comentarios_individual').find('textarea').val();var q=k('.puntuacion_riesgo_familiar'),r=a('.comentarios_familiar').find('textarea').val(),s=k('.puntuacion_riesgo_academico'),t=a('.comentarios_academico').find('textarea').val(),u=k('.puntuacion_riesgo_economico'),v=a('.comentarios_economico').find('textarea').val(),w=k('.puntuacion_vida_uni'),y=a('.comentarios_vida_uni').find('textarea').val();if('3'==o||'3'==q||'3'==s||'3'==u||'3'==w){var A={'function':'send_email_dphpforms',student_code:g(),risks:[{name:'Individual',risk_lvl:o,observation:p},{name:'Familiar',risk_lvl:q,observation:r},{name:'Acad\xE9mico',risk_lvl:s,observation:t},{name:'Econ\xF3mico',risk_lvl:u,observation:v},{name:'Vida Universitaria',risk_lvl:w,observation:y}],date:a('.fecha').find('input').val(),url:window.location.href};console.log(JSON.stringify(A)),a.ajax({type:'POST',data:JSON.stringify(A),url:'../managers/pilos_tracking/send_risk_email.php',success:function success(B){console.log(B)},dataType:'text',cache:'false',error:function error(B){console.log(B)}})}}function k(n){var o=0;return a(n).find('.opcionesRadio').find('div').each(function(){a(this).find('label').find('input').is(':checked')&&(o=a(this).find('label').find('input').val())}),o}function l(n){'primer_acercamiento'==n||'seguimiento_pares'==n||'seguimiento_geografico_'==n&&a('.seg_geo_origen').find('input').prop('disabled',!1)}function m(n,o){a.get('../managers/dphpforms/dphpforms_forms_core.php?form_id='+n+'&record_id='+o,function(p){a('#body_editor').html(''),a('#body_editor').append(p),a('#permissions_informationr').html('');var q=a('.dphpforms-record').find('.revisado_profesional').find('.checkbox').find('input[type=checkbox]').prop('checked'),r=a('.dphpforms-record').find('.revisado_practicante').find('.checkbox').find('input[type=checkbox]').prop('checked');(q||r)&&a('.dphpforms-record').find('.btn-dphpforms-delete-record').remove();for(var s=JSON.parse(a('#permissions_information').text()),t=0;t<s.behaviors_permissions.length;t++){for(var y,u=s.behaviors_permissions[t].behaviors[0],v=u.behaviors_accessibility,w=0;w<v.length;w++)y=v[w].disabled,'true'==y?y=!0:'false'==y&&(y=!1),a('.dphpforms-record').find('#'+v[w].id).prop('disabled',y),a('.dphpforms-record').find('.'+v[w]['class']).prop('disabled',y);for(var A=u.behaviors_fields_to_remove,w=0;w<A.length;w++)a('.dphpforms-record').find('#'+A[w].id).remove(),a('.dphpforms-record').find('.'+A[w]['class']).remove();for(var B=u.limpiar_to_eliminate,w=0;w<B.length;w++)a('.dphpforms-record').find('.'+B[w]['class']+'.limpiar ').remove()}a('#permissions_informationr').html('');var C=p.indexOf('primer_acercamiento_');-1!=C&&l('primer_acercamiento');var D=p.indexOf('seguimiento_de_pares_');-1!=D&&l('seguimiento_pares')})}a(document).ready(function(){a('.seg_geo_origen').find('input').prop('disabled',!0)}),a(document).on('change',a('.seg_geo_vive_zona_riesgo').find('label').find('input'),function(){a('.seg_geo_vive_zona_riesgo').find('label').find('input').prop('checked')?a('.seg_geo_origen').find('input').prop('disabled',!1):(a('.seg_geo_origen').find('input').prop('disabled',!0),a('.seg_geo_origen').find('input').prop('checked',!1))}),a('.seg_geo_vive_zona_riesgo').find('label').find('input').change(function(){a('.seg_geo_vive_zona_riesgo').find('label').find('input').prop('checked')?a('.seg_geo_origen').find('input').prop('disabled',!1):(a('.seg_geo_origen').find('input').prop('disabled',!0),a('.seg_geo_origen').find('input').prop('checked',!1))}),a('#button_actualizar_primer_acercamiento').click(function(){a.get('../managers/dphpforms/dphpforms_forms_core.php?form_id=primer_acercamiento&record_id='+a(this).attr('data-record-id'),function(n){a('#primer_acercamiento_form').html(''),a('#primer_acercamiento_form').append(n),a('#modal_primer_acercamiento').fadeIn(300);var o=a('#modal_primer_acercamiento').find('.pa_id_creado_por').find('input').val();a.get('../managers/user_management/api_user.php?function=get_user_information&arg='+o,function(p){var q=p.firstname+' '+p.lastname;a('#modal_primer_acercamiento').find('h1').after('<hr style="border-color:#444;"><h3>Registrado por: <strong>'+q+'</strong></h3>')})})}),a('#button_update_geographic_track').click(function(){a.get('../managers/dphpforms/dphpforms_forms_core.php?form_id=seguimiento_geografico&record_id='+a(this).attr('data-record-id'),function(n){a('#seguimiento_geografico_form').html(''),a('#seguimiento_geografico_form').append(n),a('#modal_seguimiento_geografico').fadeIn(300),a('.seg_geo_vive_zona_riesgo').find('label').find('input').prop('checked')?a('.seg_geo_origen').find('input').prop('disabled',!1):(a('.seg_geo_origen').find('input').prop('disabled',!0),a('.seg_geo_origen').find('input').prop('checked',!1))})});a('.btn.btn-danger.btn-univalle.btn-card').click(function(){var n=a(this).attr('data-container'),o=a('#'+n).height();if(0==o)a(this).find('span').removeClass('glyphicon-chevron-left'),a(this).find('span').addClass('glyphicon-chevron-down');else{for(;0>o;)o=a('#'+n).height();a(this).find('span').removeClass('glyphicon-chevron-down'),a(this).find('span').addClass('glyphicon-chevron-left')}}),a('#button_add_v2_track').on('click',function(){a('#modal_v2_peer_tracking').fadeIn(300),a('.id_estudiante').find('input').val(g());var n=a('#current_user_id').val();a('.id_creado_por').find('input').val(n)}),a('#button_primer_acercamiento').on('click',function(){a('#modal_primer_acercamiento').fadeIn(300),a('.primer_acerca_id_estudiante_field').find('input').val(g());var n=a('#current_user_id').val();a('.primer_acerca_id_creado_por_field').find('input').val(n)}),a('#button_add_geographic_track').on('click',function(){a('#modal_seguimiento_geografico').fadeIn(300),a('.seg_geo_id_estudiante').find('input').val(g());var n=a('#current_user_id').val();a('.seg_geo_id_creado_por').find('input').val(n),a('.seg_geo_vive_zona_riesgo').find('label').find('input').prop('checked')?a('.seg_geo_origen').find('input').prop('disabled',!1):(a('.seg_geo_origen').find('input').prop('disabled',!0),a('.seg_geo_origen').find('input').prop('checked',!1))}),a('.mymodal-close').click(function(){a(this).parent().parent().parent().parent().fadeOut(300)}),a('.dphpforms-peer-record').on('click',function(){var n=a(this).attr('data-record-id');m('seguimiento_pares',n),a('#modal_v2_edit_peer_tracking').fadeIn(300)}),a('.limpiar').click(function(){a(this).parent().find('.opcionesRadio').find('div').each(function(){a(this).find('label').find('input').prop('checked',!1)})}),a(document).on('click','.limpiar',function(){a(this).parent().find('.opcionesRadio').find('div').each(function(){a(this).find('label').find('input').prop('checked',!1)})}),a(document).on('submit','.dphpforms',function(n){n.preventDefault();var o=a(this).attr('id').indexOf('seguimiento_geografico_');-1!=o&&l('seguimiento_geografico_'),a('.seg_geo_origen').find('input').prop('disabled',!1);var p=new FormData(this),q=a(this),r=q.attr('action');'procesador.php'==q.attr('action')&&(r='../managers/dphpforms/procesador.php'),a(q).find('button').prop('disabled',!0),a(q).find('a').attr('disabled',!0),a.ajax({type:'POST',url:r,data:p,cache:!1,contentType:!1,processData:!1,success:function success(s){var t=JSON.parse(s);if(console.log(s),0==t.status){var u='';'Stored'==t.message?u='Almacenado':'Updated'==t.message&&(u='Actualizado'),j(),h(),swal({title:'Informaci\xF3n',text:u,type:'success'},function(){'Updated'==t.message?a('#dphpforms-peer-record-'+a('#dphpforms_record_id').val()).stop().animate({backgroundColor:'rgb(175, 255, 173)'},400).animate({backgroundColor:'#f5f5f5'},4e3):(a('.dphpforms-response').trigger('reset'),location.reload())}),a('#modal_v2_edit_peer_tracking').fadeOut(300),a('#modal_v2_peer_tracking').fadeOut(300),a('#modal_primer_acercamiento').fadeOut(300),a('#modal_seguimiento_geografico').fadeOut(300),a.get('../managers/pilos_tracking/api_pilos_tracking.php?function=update_last_user_risk&arg='+g(),function(v){console.log(v)}),a(q).find('button').prop('disabled',!1),a(q).find('a').attr('disabled',!1)}else if(-2==t.status){a(q).find('button').prop('disabled',!1),a(q).find('a').attr('disabled',!1);var u='';'Without changes'==t.message?u='No hay cambios que registrar':'Unfulfilled rules'==t.message&&(u='Revise los valores ingresados'),swal('Alerta',u,'warning')}else-1==t.status&&(console.log(s),swal('ERROR!','Oops!, informe de este error','error'))},error:function error(s){console.log(s),swal('Error!','Oops!, informe de este error','error'),a(q).find('button').prop('disabled',!1),a(q).find('a').attr('disabled',!1)}})}),a(document).on('click','.btn-dphpforms-delete-record',function(){swal({title:'Confirmaci\xF3n',text:'Est\xE1 eliminando este registro, \xBFdesea continuar?',type:'warning',showCancelButton:!0,confirmButtonText:'S\xED, Eliminar!'},function(n){if(n){var o=a('.btn-dphpforms-delete-record').attr('data-record-id');a.get('../managers/dphpforms/dphpforms_delete_record.php?record_id='+o,function(p){var q=p;0==q.status?swal({title:'Informaci\xF3n',text:'Eliminado',type:'success'},function(){a('#modal_v2_edit_peer_tracking').fadeOut(300),a('#modal_primer_acercamiento').fadeOut(300),location.reload()}):-1==q.status&&swal('Error!',q.message,'error')})}})})}}});
>>>>>>> 28da74771d0db3d66d8e572a2894fff2ecb3eeaf
