define ("block_ases/groupal_tracking",["jquery","block_ases/bootstrap","block_ases/validator","block_ases/sweetalert"],function(a){return{init:function init(){a(".outside").click(function(){var b=a(this);swal({title:"Confirmaci\xF3n de salida",text:"",type:"warning",showCancelButton:!0,confirmButtonText:"Salir"},function(c){if(c){a(b).parent(".mymodal").fadeOut(300);console.log(a(this).parent(".mymodal"))}})});a(document).ready(function(){d();g();a("#socioedu_add_grupal").click(function(){a("#save_seg").removeClass("hide");a("#div_created").addClass("hide");a("#upd_seg").addClass("hide");a("#myModalLabel").attr("name","GRUPAL");f();e()});a("#close_seg").on("click",function(){a("#edit_seg").addClass("hide")});a("#go_back").on("click",function(){window.history.back()});a("#edit_seg").click(function(){var b=[],d=c(document.location.search),e=a(this).prop("name");a("#seguimiento input[id=asistencia]:checked").each(function(){var c=a(this).val();b.push(c)});a("#myModalLabel").attr("name","GRUPAL");var f=a("#myModalLabel").attr("name"),h=a("#seguimiento").serializeArray();h.push({name:"function",value:"update"});h.push({name:"tipo",value:f});h.push({name:"id_seg",value:e});h.push({name:"idtalentos",value:b});h.push({name:"idinstancia",value:d.instanceid});h.push({name:"idmonitor",value:120});var i=j(h);if(i.isvalid){a.ajax({type:"POST",data:h,url:"../managers/seguimiento_grupal/groupal_trackings_report.php",success:function success(b){var c=b.error;if(!c){swal({title:"Actualizado con exito!!!",html:!0,type:"success",text:b.msg,confirmButtonColor:"#d51b23"});a("#myModal").modal("toggle");a("#myModal").modal("toggle");a("#save_seg").addClass("hide");a(".modal-backdrop").remove();g()}else{swal({title:c,html:!0,type:"error",text:b.msg,confirmButtonColor:"#D3D3D3"})}},dataType:"json",cache:"false",error:function error(){alert("error al actualizar seguimiento")}})}else{swal({title:"Error",html:!0,type:"warning",text:"Detalles del error:<br>"+i.detalle,confirmButtonColor:"#D3D3D3"})}});a("#save_seg").click(function(){var b=[],d=c(document.location.search);a("#seguimiento input[id=asistencia]:checked").each(function(){var c=a(this).val();b.push(c)});var e=a("#myModalLabel").attr("name"),f=a("#seguimiento").serializeArray();f.push({name:"function",value:"new"});f.push({name:"tipo",value:e});f.push({name:"idtalentos",value:b});f.push({name:"idinstancia",value:d.instanceid});f.push({name:"idmonitor",value:120});var h=j(f);if(h.isvalid){a.ajax({type:"POST",data:f,url:"../managers/seguimiento_grupal/groupal_trackings_report.php",success:function success(b){var c=b.error;if(!c){swal({title:"Actualizado con exito!!",html:!0,type:"success",text:b.msg,confirmButtonColor:"#d51b23"});a("#myModal").modal("toggle");a("#myModal").modal("toggle");a("#save_seg").addClass("hide");a(".modal-backdrop").remove();g()}else{swal({title:c,html:!0,type:"error",text:b.msg,confirmButtonColor:"#D3D3D3"})}},dataType:"json",cache:"false",error:function error(){alert("error al guardar seguimiento")}})}else{swal({title:"Error",html:!0,type:"warning",text:"Detalles del error:<br>"+h.detalle,confirmButtonColor:"#D3D3D3"})}});a("#upd_seg").click(function(){a(this).attr("name");a("#seguimiento :input").prop("disabled",!1);var c=b();e(c,!0);a("#edit_seg").removeClass("hide");a("#upd_seg").addClass("hide")})});function b(){var b=[];a("#mytable_consult > tbody  > tr > td").each(function(){if("talentos"==a(this).attr("id")){b.push(a(this).html())}});return b}function c(){for(var a=[],b=document.location.search.substring(1),c=b.split("&"),d=0,e;d<c.length;d++){e=c[d].split("=");a[e[0]]=e[1]}return a}function d(){var b=[],d=c(document.location.search);b.push({name:"function",value:"load_grupal"});b.push({name:"idinstancia",value:d.instanceid});a.ajax({type:"POST",data:b,url:"../managers/user_management/usermanagement_report.php",success:function success(b){a("#mytable tbody").html("");if(0!=b.rows){var c=b.content;for(x in c){a("#mytable tbody").append("<tr> <td>"+c[x].username+"</td> <td>"+c[x].firstname+"</td> <td>"+c[x].lastname+"</td>  <td class=\"hide\">"+c[x].idtalentos+"</td> </tr>")}}else{a("#list_grupal_seg").append("<a>No registra ningun estudiante a su cargo.Por favor dirigete a la oficina de Sistemas de talentos pilos para gestionar tu situaci\xF3n</a>")}},dataType:"json",cache:"false",error:function error(){alert("error al cargar estudiantes")}})}function e(b,d){if(b===void 0){b=null}if(d===void 0){d=null}var e=[],f=c(document.location.search);e.push({name:"function",value:"load_grupal"});e.push({name:"idinstancia",value:f.instanceid});a.ajax({type:"POST",data:e,url:"../managers/user_management/usermanagement_report.php",success:function success(c){a("#seguimiento #mytable_consult tbody").html("");if(0!=c.rows){var d=c.content;if(!b){for(x in d){a("#seguimiento #mytable_consult tbody").append("<tr> <td>"+d[x].username+"</td> <td>"+d[x].firstname+"</td> <td>"+d[x].lastname+"</td>  <td><input type=\"checkbox\" id=\"asistencia\" name=\"asistencia\" value=\""+d[x].idtalentos+"\"/></td>  </tr>")}}else{for(x in d){if(-1!=b.indexOf(x)){a("#seguimiento #mytable_consult tbody").append(" <tr> <td>"+d[x].username+"</td> <td>"+d[x].firstname+"</td> <td>"+d[x].lastname+"</td>  <td><input type=\"checkbox\" checked=\"checked\" id=\"asistencia\" name=\"asistencia\"  value=\""+d[x].idtalentos+"\"/></td>  </tr>")}else{a("#seguimiento #mytable_consult tbody").append("<tr> <td>"+d[x].username+"</td> <td>"+d[x].firstname+"</td> <td>"+d[x].lastname+"</td>  <td><input type=\"checkbox\" id=\"asistencia\" name=\"asistencia\" value=\""+d[x].idtalentos+"\"/></td>  </tr>")}}}}else{a("#seguimiento #list_grupal_seg").append("<a>No registra ningun estudiante a su cargo.Por favor dirigete a la oficina de Sistemas de talentos pilos para gestionar tu situaci\xF3n</a>")}var e=a("#upd_seg").prop("name");a("#edit_seg").prop("name",e)},dataType:"json",cache:"false",error:function error(){alert("error al cargar listado de asistencia")}})}function f(){for(var b=new Date,c=b.getDate(),d=b.getMonth()+1,e=b.getFullYear(),f=b.getMinutes(),g=b.getHours(),h="",j=0;24>j;j++){if(j==g){if(10>g)g="0"+g;h+="<option value=\""+g+"\" selected>"+g+"</option>"}else if(10>j){h+="<option value=\"0"+j+"\">0"+j+"</option>"}else{h+="<option value=\""+j+"\">"+j+"</option>"}}for(var k="",j=0;60>j;j++){if(j==f){if(10>f)f="0"+f;k+="<option value=\""+f+"\" selected>"+f+"</option>"}else if(10>j){k+="<option value=\"0"+j+"\">0"+j+"</option>"}else{k+="<option value=\""+j+"\">"+j+"</option>"}}a("#seguimiento #h_ini").append(h);a("#seguimiento #m_ini").append(k);a("#seguimiento #h_fin").append(h);a("#seguimiento #m_fin").append(k);a("#seguimiento").find("input:text, textarea").val("");a("#seguimiento #infomonitor").addClass("hide");a("#upd_seg").attr("disabled",!1);a("#upd_seg").attr("title","");a("#seguimiento").find("select, textarea, input").attr("disabled",!1)}function g(){a("#list_grupal").html("");var b=[],d=c(document.location.search);b.push({name:"function",value:"loadSegMonitor"});b.push({name:"tipo",value:"GRUPAL"});b.push({name:"idinstancia",value:d.instanceid});a.ajax({type:"POST",data:b,url:"../managers/seguimiento_grupal/groupal_trackings_report.php",success:function success(b){var c=b.error;if(!c){var d=b.result,e=b.rows;if(0<e){for(x in d){a("#list_grupal").append("<div class=\"container well col-md-12\"> <div class=\"container-fluid col-md-10\" name=\"info\"><div class=\"row\"><label class=\"col-md-3\" for=\"fecha_des\">Fecha</label><label class=\"col-md-9\" for=\"tema_des\">Tema</label> </div> <div class=\"row\"> <input type=\"text\" class=\"col-md-3\" value="+d[x].fecha+" id=\"fecha_seg\" name=\"fecha_seg\" disabled> <input type=\"text\" class=\"col-md-9\" value="+d[x].tema+" id=\"tema_seg\" name=\"tema_seg\" disabled> </div></div> <div id="+d[x].id+" class=\"col-md-2\" name=\"div_button_seg\"> <span class=\"btn btn-danger\" id=\"consult_grupal\" name=\"consult_grupal\" data-toggle=\"modal\" data-target=\"#myModal\">Detalle</span><span class=\"btn btn-warning\" id=\"delete_grupal\" name=\"delete_grupal\">Borrar</span> </div></div>")}a("#list_grupal").on("click","#consult_grupal",function(){var b=a(this).parent().attr("id");a("#upd_seg").removeClass("hide");a("#upd_seg").prop("name",b);i(b,"GRUPAL")});a("#list_grupal").on("click","#delete_grupal",function(){var b=a(this).parent().attr("id");h(b)})}else{a("#list_grupal").append("<label>No registra</label><br>")}}else{swal({title:c,html:!0,type:"error",text:b.msg,confirmButtonColor:"#D3D3D3"})}},dataType:"json",cache:"false",error:function error(){alert("error al cargar seguimiento monitor")}})}function h(b){swal({title:"\xBFSeguro que desea eliminar el registro?",text:"No podr\xE1s deshacer este paso",type:"warning",showCancelButton:!0,cancelButtonText:"No",confirmButtonColor:"#d51b23",confirmButtonText:"Si",closeOnConfirm:!1},function(){a.ajax({type:"POST",data:{id:b,function:"delete"},url:"../../../blocks/ases/managers/seguimiento_grupal/groupal_trackings_report.php",async:!1,success:function success(a){if(0==a){swal({title:"error al borrar registro",html:!0,type:"error",confirmButtonColor:"#d51b23"})}else{setTimeout("document.location.reload()",500);swal("\xA1Hecho!","El registro ha sido eliminado","success")}},dataType:"text",cache:"false",error:function error(){alert("error al eliminar seguimiento")}})})}function i(b,d){var e=[],g=c(document.location.search);a("#save_seg").addClass("hide");f();e.push({name:"function",value:"getSeguimiento"});e.push({name:"id",value:b});e.push({name:"idinstancia",value:g.instanceid});e.push({name:"tipo",value:d});a.ajax({type:"POST",data:e,url:"../managers/seguimiento_grupal/groupal_trackings_report.php",success:function success(b){var c=b.error;if(!c){a("#place").val(b.seguimiento.lugar);a("#tema").val(b.seguimiento.tema);a("#objetivos").val(b.seguimiento.objetivos);a("#actividades").val(b.seguimiento.actividades);a("#observaciones").val(b.seguimiento.observaciones);a("#h_ini option[value="+b.hour.h_ini+"]").attr("selected",!0);a("#m_ini option[value="+b.hour.m_ini+"]").attr("selected",!0);a("#h_fin option[value="+b.hour.h_fin+"]").attr("selected",!0);a("#m_fin option[value="+b.hour.m_fin+"]").attr("selected",!0);a("#date").val(b.hour.seguimiento.fecha);a("#seguimiento :input").prop("disabled",!0);a("#mytable_consult tbody").html("");if(0!=b.rows){var d=b.content;for(x in d){a("#mytable_consult tbody").append("<tr> <td>"+d[x].username+"</td> <td>"+d[x].firstname+"</td> <td>"+d[x].lastname+"</td>  <td id=\"talentos\"  class = \"hide\">"+d[x].idtalentos+"</td> </tr>")}}else{a("#list_grupal_seg_consult").append("<a>No registra ningun estudiante a su cargo.Por favor dirigete a la oficina de Sistemas de talentos pilos para gestionar tu situaci\xF3n</a>")}}else{swal({title:c,html:!0,type:"error",text:b.msg,confirmButtonColor:"#D3D3D3"})}},dataType:"json",cache:"false",error:function error(){alert("error al ver detalles de seguimientos")}})}function j(b){var c=!0,d="",e,f,g,h,i,j,k,l,m;a.each(b,function(a,b){switch(b.name){case"date":e=b.value;break;case"place":m=b.value;break;case"h_ini":f=b.value;break;case"m_ini":g=b.value;break;case"h_fin":h=b.value;break;case"m_fin":i=b.value;break;case"tema":j=b.value;break;case"objetivos":k=b.value;break;case"actividades":actividades=b.value;break;case"observaciones":observaciones=b.value;break;case"idtalentos":l=b.value;break;}});if(!e){c=!1;d+="* Selecciona una Fecha de seguimiento valida: date<br>"}if(m==void 0||""==m){d+="* Seleccione el lugar : lugar<br>";c=!1}if(actividades==void 0||""==actividades){d+="* Seleccione las actividades que se realizaron : actividades<br>";c=!1}if(observaciones==void 0||""==observaciones){d+="* Seleccione las observaciones : observaciones<br>";c=!1}if(f>h){c=!1;d+="* La hora final debe ser mayor a la inicial<br>"}else if(f==h){if(g>i){c=!1;d+="* La hora final debe ser mayor a la inicial<br>"}}if(0===l.length){c=!1;d+="* Selecciona los estudiantes que asistieron al seguimiento: "+l.length+"<br>"}if(""==j){c=!1;d+="* La informacion de \"observaciones\" es obligatoria :"+j+"<br>"}if(""==k){c=!1;d+="* La informacion de \"Objetivos\" es obligatoria:"+k+"<br>"}var n={isvalid:c,detalle:d};return n}a("#ficha_estudiante #editar_ficha").click(function(){a("#ficha_estudiante").find("input, textarea").prop("readonly",!1);a("#profesional_ps").prop("readonly",!0);a("#practicante_ps").prop("readonly",!0);a("#monitor_ps").prop("readonly",!0);a("#ficha_estudiante").find("select").prop("disabled",!1);a(this).hide();a("#ficha_estudiante #cancel").fadeIn();a("#ficha_estudiante #save").fadeIn();a("#ficha_estudiante #codigo").attr("readonly",!0);a("#ficha_estudiante #search").fadeOut()});a("#ficha_estudiante #cancel").click(function(){swal({title:"Estas seguro/a de cancelar?",text:"Los cambios realizados no ser\xE1n tomados en cuenta y se perder\xE1n",type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si!",cancelButtonText:"No",closeOnConfirm:!0},function(b){if(b){a("#ficha_estudiante").find("input, textarea").prop("readonly",!0);a("#ficha_estudiante").find("select").prop("disabled",!0);a(this).hide();a("#ficha_estudiante #save").fadeOut();a("#ficha_estudiante #cancel").fadeOut();a("#ficha_estudiante #editar_ficha").fadeIn();a("#ficha_estudiante #codigo").attr("readonly",!1);a("#ficha_estudiante #search").fadeIn();k()}})});a("#ficha_estudiante #go_back").on("click",function(){var a=location.search.split("&");location.href="index.php"+a[0]+"&"+a[1]});a("#ficha_estudiante").on("click",".accordion-toggle",function(b){b.preventDefault();var c=a(this),d=c.next(".accordion-content"),e=a(this).children(".toggle-icon");c.toggleClass("open");if(c.hasClass("open")){e.html("<i class='glyphicon glyphicon-chevron-down whitesmoke'></i>")}else{e.html("<i class='glyphicon glyphicon-chevron-left'></i>")}d.slideToggle(250)});a(document).on("click","panel-heading",function(){a(".panel-collapse.in").removeClass("in").addClass("collapse")});function k(){var b=a("#ficha_estudiante #codigo").serializeArray();a.ajax({type:"POST",data:b,url:"../managers/search_profile.php",success:function success(b){var d=b.error;a("#ficha_estudiante input,textarea").val("");a("#ficha_estudiante #nombreficha").text("");a("#ficha_estudiante #email").text("");a("#ficha_estudiante #cohorte").text("");if(!d){var e=c(document.location.search);canSeeStudent(b.idtalentos,e,function(a){if(a.result){var c=location.search.split("&"),d=location.href.split("?")[0]+c[0]+"&"+c[1]+"&talento_id="+b.username;location.href=d}else{swal({title:"\xC1REA RESTRINGIDA",html:!0,type:"warning",text:"No tienes permisos para ver la informaci\xF3n de este estudiante.<br> Dirigete a la oficina de Sistemas del plan talentos pilos para gestionar tu situaci\xF3n",confirmButtonColor:"#d51b23"},function(b){if(b){location.href=a.pagina}})}})}else{swal({title:"No encotrado",html:!0,type:"error",text:d,confirmButtonColor:"#d51b23"},function(a){if(a){var b=location.search.split("&");window.history.pushState(null,null,"talentos_profile.php"+b[0]+"&"+b[1])}})}},dataType:"json",cache:"false",error:function error(a){alert("Error "+a)}})}}}});
//# sourceMappingURL=groupal_tracking.min.js.map
