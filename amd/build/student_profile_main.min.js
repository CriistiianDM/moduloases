define ("block_ases/student_profile_main",["jquery","block_ases/bootstrap","block_ases/d3","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2","block_ases/Chart","block_ases/mustache","block_ases/loading_indicator","block_ases/academic_profile_main","block_ases/socioed_profile_main","block_ases/geographic_main","block_ases/discapacity_tracking_main"],function(e,a,t,o,r,s,n,l,c,d,p,_,u){return{init:function init(a){var t=this,o=e("#municipio_act").val(),r=e("#latitude").val(),s=e("#longitude").val(),n=new google.maps.LatLng(3.3741569,-76.5355235),l=new google.maps.LatLng(3.431626,-76.546822),d=document.querySelector("#cod_programa_activo").dataset.info,p=d[1],_="6"===p||"8"===p?l:n;if("CALI"==o){document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+r+","+s+"&destination="+_.lat()+","+_.lng()+"&mode=transit'></iframe>"}else{document.getElementById("mapa").innerHTML="<iframe class='col-xs-12 col-sm-12 col-md-12 col-lg-12' height='396' frameborder='0' style='border:0' src='https://www.google.com/maps/embed/v1/directions?key=AIzaSyAoE-aPVfruphY4V4BbE8Gdwi93x-5tBTM&origin="+r+","+s+"&destination="+_.lat()+","+_.lng()+"&mode=driving'></iframe>"}e("#field_doc_dtddp").hide();e("#socioed_li").one("click",{tab_name:"socioed"},m);e("#academic_li").one("click",{tab_name:"academic"},m);e("#geographic_li").one("click",{tab_name:"geographic"},m);e("#discapacity_tracking_li").one("click",{tab_name:"discapacity_tracking"},m);e("#geographic_li").on("click",function(){e("#mapa").appendTo("#geographic_map")});e("#general_li").click(function(){e("#mapa").appendTo("#movableMap")});e(document).on("click","#table_vive_con tbody tr td button",function(){e(this).parent().parent().remove()});e("#cohorts_table tbody").find("td").each(function(){if(-1!=e(this).text().indexOf("Condici\xF3n de Excepci\xF3n")){var a=e("#cond_excepcion_alias").text().trim(),t=e("#cond_excepcion_name").text().trim();e(this).append("-");e(this).append(a);e(this).attr("title",t)}});e("#input_button_add_person").click(function(){var a="";a+="<tr><td> <input name=\"name_person\" class=\"input_fields_general_tab\"  type=\"text\"/></td>";a+="<td> <input name=\"parentesco_person\" class=\"input_fields_general_tab\"  type=\"text\" /></td>";a+="<td> <button type =\"button\" id=\"bt_delete_person\" title=\"Eliminar persona\" name=\"btn_delete_person\" style=\"visibility:visible;\"> </button></td> </tr>";e("#table_vive_con").find("tbody").append(a)});e("[data-toggle=\"tooltip\"]").tooltip();var u=A(document.location.search),h=e(".panel-collapse.collapse.in");e("#asignados").select2({width:"resolve",height:"resolve",language:{noResults:function noResults(){return"No hay resultado"},searching:function searching(){return"Buscando.."}}});e("#asignados").on("change",function(){var a=e("#asignados").val(),t=a.split(" ")[0];O(t)});for(var f=0,b=a.length;f<b;f++){e("#select-"+a[f].academic_program_id+" option[value="+a[f].program_status+"]").attr("selected",!0);if("1"==a[f].program_status){e("#tr-"+a[f].id_moodle_user).addClass("is-active")}if("1"==a[f].tracking_status){e("#div_flags_"+a[f].academic_program_id).prop("checked",!0)}}var y="",B=e("#div_cohorts").height();e("#div-icon-edit").height(B);this.edit_profile(t);e("div.slider.round").click(function(e){y=e.target.parentElement.children[0].checked});e(".input-tracking").on("change",{current_tracking_status:y},function(){t.update_tracking_status(y,e(this),a,t)});var z="";e(".select_statuses_program").on("focus",function(e){z=e.target.value});e(".select_statuses_program").on("change",{current_status:z},function(){t.update_status_program(z,e(this))});e("#icetex_status").on("click",{previous_status:e("#icetex_status option:selected").text()},k);e("#icon-tracking").on("click",function(){var a=e("#input_status_ases").val();if("seguimiento"==a)t.update_status_ases(u)});switch(u.tab){case"socioed_tab":e("#general_li").removeClass("active");e("#socioed_li").addClass("active");e("#general_tab").removeClass("active");e("#socioed_tab").addClass("active");h.removeClass("in");e("#collapseOne").addClass("in");break;default:h.removeClass("in");break;}var I=e("#modal_peer_tracking");x();E();w();e("#button_add_track").on("click",function(){e("#save_seg").removeClass("hide");e("#div_created").addClass("hide");e("#upd_seg").addClass("hide");e("#myModalLabel").attr("name","PARES");I.show();C()});e("#view_form_update_profile_image").on("click",function(){e("#profile_image_update").show()});e("#send-profile-image").on("click",function(){c.show();var a=e("#id_moodle").val(),t=document.getElementById("profile-image-input").files[0];e.ajax({url:"../managers/student_profile/studentprofile_api.php",data:JSON.stringify({function:"update_user_image",params:[a,t]}),cache:!1,contentType:!1,processData:!1,method:"POST",type:"POST",success:function success(e){c.hide();alert(e)},error:function error(e){c.hide();console.log(e)}})});e("#save_tracking_btn").on("click",function(){T()});e("fieldset").removeClass("hidden");e("#clean_individual_risk").on("click",function(){e("#no_value_individual").prop("checked",!0)});e("#clean_familiar_risk").on("click",function(){e("#no_value_familiar").prop("checked",!0)});e("#clean_academic_risk").on("click",function(){e("#no_value_academic").prop("checked",!0)});e("#clean_economic_risk").on("click",function(){e("#no_value_economic").prop("checked",!0)});e("#clean_life_risk").on("click",function(){e("#no_value_life").prop("checked",!0)});e(".btn-primary.edit_peer_tracking").on("click",function(){var a=e(this).attr("id"),t=a.substring(14);S(t)});e(".btn-danger.delete_peer_tracking").on("click",function(){var a=e(this).attr("id"),t=a.substring(21);swal({title:"Advertencia",text:"\xBFEst\xE1 seguro(a) que desea borrar este seguimiento?",type:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!1},function(e){if(e){j(t)}})});e("#view_graph_radial_button").on("click",function(){t.graph_radial()});e("#view_graphic_risk_button").off("click",v);e("#view_graphic_risk_button").one("click",g);e("#mymodal-riesgo-close").click(function(){e("#modal_riesgos").fadeOut(200)})},equalize:function equalize(){e(document).ready(function(){if(0==document.getElementById("genero").value){e("#lb_otro").show();e("#div_otro_genero").show()}if(0==document.getElementById("act_simultanea").value){e("#lb_otro_act").show();e("#div_otro_act").show()}var a=e(".equalize").map(function(){return e(this).height()}).get(),t=Math.max.apply(null,a);e(".equalize").height(t);e("#birthdate").datepicker({dateFormat:"yy-mm-dd",changeYear:!0,changeMonth:!0})})},update_status_program:function update_status_program(a,t){var o=t.parent().parent().attr("id").split("-")[1],r=t.attr("id").split("-")[1],s=t.val();swal({title:"Advertencia",text:"\xBFEst\xE1 seguro que desea cambiar el estado del programa?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!1},function(t){if(t){c.show();e.ajax({type:"POST",data:JSON.stringify({function:"update_status_program",params:[o,r,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(a){c.hide();if(0==a.status_code){if("ACTIVO"==e("#select-"+r).val()){e("#tr-"+o).addClass("is-active")}else{e("#tr-"+o).removeClass("is-active")}swal(a.title,a.message,a.type)}else{console.log(a)}},dataType:"json",cache:"false",error:function error(e){c.hide();swal(e.title,e.msg,e.type)}})}else{e("#select-"+data.program_id).val(a)}})},update_status_ases:function update_status_ases(a){swal({title:"Advertencia",text:"\xBFEst\xE1 seguro de que desea cambiar el estado de seguimiento del estudiante en esta instancia? El estado pasar\xE1 de 'seguimiento' a 'sin seguimiento'",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Si",cancelButtonText:"No"},function(t){if(t){modal_dropout=e("#modal_dropout");modal_dropout.show();e("#save_changes_dropout").on("click",function(){c.show();var t=e("#id_ases").val(),o=e("#reasons_select").val(),r=e("#description_dropout").val();e.ajax({type:"POST",data:JSON.stringify({function:"update_ases_status",params:[t,a.instanceid,a.student_code,o,r]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(a){c.hide();if(0==a.status_code){e("#input_status_ases").val("sinseguimiento");e("#tip_ases_status").html("No se realiza seguimiento en esta instancia");e("#icon-tracking").removeClass("i-tracking-t");e("#icon-tracking").addClass("i-tracking");modal_dropout.hide();swal(a.title,a.message,a.type)}else if(-7==a.status_code||-8==a.status_code){swal(a.title,a.error_message,a.type)}else{console.log(a)}},dataType:"json",cache:"false",error:function error(e){c.hide();modal_dropout.hide();swal(e.title,e.message,e.type)}})})}})},update_tracking_status:function update_tracking_status(a,t,o,r){has_tracking_status=!1;if(!1==a){has_tracking_status=r.validate_tracking_statuses(o);if(has_tracking_status.tracking_status){swal({title:"\xBFEst\xE1 seguro/a de cambiar el estado?",text:"Se alternar\xE1 el perfil de Moodle asociado al estudiante al cual se el realiza seguimiento",type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!0,allowEscapeKey:!1},function(o){if(o){c.show();e(".input-tracking").prop("checked",!1);t.prop("checked",!0);var r=e("#id_ases").val(),s=t[0].id;s=s.split("_")[2];e.ajax({type:"POST",data:JSON.stringify({function:"update_tracking_status",params:[r,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(e){c.hide();setTimeout(function(){if(0==e.status_code||-9==e.status_code){swal(e.title,e.message,e.type)}else{console.log(e)}},100)},dataType:"json",cache:"false",error:function error(e){c.hide();setTimeout(function(){swal(e.title,e.msg,e.status)},100)}})}else{if(a){t.prop("checked",!0)}else{t.prop("checked",!1)}}})}}else{t.prop("checked",!0)}},validate_tracking_statuses:function validate_tracking_statuses(e){has_tracking_status=!1;for(i=0;i<e.length;i++){if(1==e[i].tracking_status){has_tracking_status=!0;break}}return e[i]},get_url_parameters:function(){for(var e=[],a=document.location.search.substring(1),t=a.split("&"),o=0,r;o<t.length;o++){r=t[o].split("=");e[r[0]]=r[1]}return e},graph_radial:function graph_radial(){var a=document.getElementById("canvas_radial_graph").getContext("2d"),t,o,r,s,l;if(0==e("#individual_risk").attr("data-risk-level")){t=4}else{t=e("#individual_risk").attr("data-risk-level")}if(0==e("#familiar_risk").attr("data-risk-level")){o=4}else{o=e("#familiar_risk").attr("data-risk-level")}if(0==e("#academic_risk").attr("data-risk-level")){r=4}else{r=e("#academic_risk").attr("data-risk-level")}if(0==e("#economic_risk").attr("data-risk-level")){s=4}else{s=e("#economic_risk").attr("data-risk-level")}if(0==e("#life_risk").attr("data-risk-level")){l=4}else{l=e("#life_risk").attr("data-risk-level")}e("#modal_radial_graph").fadeIn(200);var c={labels:["Individual","Familiar","Acad\xE9mico","Econ\xF3mico","Vida universitaria"],datasets:[{data:[4-t,4-o,4-r,4-s,4-l],backgroundColor:"rgba(255, 99, 132, 0.4)",borderColor:["rgba(255,99,132,1)"],borderWidth:2,fontsize:12}]},d=new n(a,{type:"radar",data:c,options:{scale:{ticks:{beginAtZero:!0,min:0,max:3,stepSize:1,display:!1},pointLabels:{fontSize:12},scaleLabel:{fontsize:10}},legend:{display:!1}}})},edit_profile:function edit_profile(a){var t=e("#ficha_estudiante").serializeArray(),o=document.getElementById("otro_genero").value,r=document.getElementById("otro_act_simultanea").value;e("#span-icon-edit").on("click",function(){e(this).hide();e("#tip-edit").hide();e("#span-icon-save-profile").show();e("#tip-save").show();e("#span-icon-cancel-edit").show();e("#tip-cancel").show();e("#tipo_doc").prop("disabled",!1);e("#num_doc").prop("readonly",!1);e("#email").prop("readonly",!1);e("#icetex_status").prop("disabled",!1);e("#pais").prop("disabled",!1);e("#genero").prop("disabled",!1);e("#sexo").prop("disabled",!1);e("#cond_excepcion").prop("disabled",!1);e("#act_simultanea").prop("disabled",!1);e("#etnia").prop("disabled",!1);e("#otro_act_simultanea").prop("disabled",!1);e("#otro_genero").prop("disabled",!1);e("#otro_genero").prop("required",!1);e("#otro_act_simultanea").prop("required",!1);e("#estado_civil").prop("disabled",!1);e("#observacion").prop("readonly",!1);e(".select_statuses_program").prop("disabled",!1);e("#field_doc_dtddp").show();e(".input_fields_general_tab").prop("readonly",!1);e(".bt_delete_person").css("visibility","visible");e(".input-tracking").prop("disabled",!1);e("#div_add_persona_vive").show();e("#edit_person_vive").show();e("#age").hide();e("#birthdate").show();e("#link_doc_dtddp").bind("click",function(a){a.preventDefault()});e("#link_doc_dtddp").css("color","black").css("text-decoration","none");e("#genero").on("click",function(){if(0==document.getElementById("genero").value){e("#div_otro_genero").show();e("#lb_otro").show();e("#otro_genero").prop("required",!0)}else{e("#div_otro_genero").hide();e("#lb_otro").hide();e("#otro_genero").prop("required",!1)}});e("#act_simultanea").on("click",function(){if(0==document.getElementById("act_simultanea").value){e("#div_otro_act").show();e("#lb_otro_act").show();e("#otro_act_simultanea").prop("required",!0)}else{e("#div_otro_act").hide();e("#lb_otro_act").hide();e("#otro_act_simultanea").prop("required",!1)}})});e("#span-icon-cancel-edit").on("click",{form:t},function(e){swal({title:"\xBFDesea cancelar la edici\xF3n?",text:"Los cambios no guardados se perder\xE1n",type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!0,allowEscapeKey:!1},function(t){if(t){a.cancel_edition();a.revert_changes(e.data.form)}})});e("#span-icon-save-profile").on("click",function(){var t=e("#ficha_estudiante").serializeArray(),s=a.validate_form(t);if("error"==s.status){swal(s.title,s.msg,s.status)}else{var n=[],l,c=[],d=[];e(".table_vive_con td").find(":input").each(function(){if("name_person"==e(this).attr("name")){c.push(e(this).val())}if("parentesco_person"==e(this).attr("name")){d.push(e(this).val())}});for(var p=0;p<c.length;p++){l={name:c[p],parentesco:d[p]};n.push(l)}n=JSON.stringify(n);a.save_form_edit_profile(t,a,o,r,n);e("#otro_genero").prop("disabled",!0);e("#otro_act_simultanea").prop("disabled",!0);e("#otro_genero").prop("required",!1);e("#otro_act_simultanea").prop("required",!1)}})},validate_form:function validate_form(a){for(o in a){var t={},o=a[o];t.title="\xC9xito";t.msg="El formulario fue validado con \xE9xito";t.status="success";switch(o.name){case"email":var r=/((?:[a-z]+\.)*[a-z]+(?:@correounivalle\.edu\.co))/,s=r.exec(o.value);if(null!==s){if(!(s[0]===o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no cumple con el formato institucional.";return t}}else{t.title="Error";t.status="error";t.msg="El campo "+o.name+" no cumple con el formato institucional.";return t}break;case"fecha_nac":var n=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,l=n.exec(o.value);if(null==l){t.title="Error";t.status="error";t.msg="El campo 'fecha de nacimiento' no cumple con el formato de fecha aceptado (yyyy-mm-dd).";return t}else{o.value+=" 00:00:00"}break;case"estrato":if(0>o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe ser negativo";return t}if(6<o.value){t.title="Error";t.status="error";t.msg="El campo a\xF1o de "+o.name+" no debe ser mayor al permitido";return t}if(h(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener letras";return t}break;case"ingreso":if(0>o.value){t.title="Error";t.status="error";t.msg="El campo a\xF1o de "+o.name+" no debe ser negativo";return t}var c=new Date,d=c.getFullYear();if(o.value>d){t.title="Error";t.status="error";t.msg="El campo a\xF1o de "+o.name+" no debe ser mayor al actual";return t}if(h(o.value)){t.title="Error";t.status="error";t.msg="El campo a\xF1o de "+o.name+" no debe contener letras";return t}break;case"puntaje_icfes":if(0>o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe ser negativo";return t}if(500<o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe ser mayor al permitido";return t}if(h(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener letras";return t}break;case"hijos":if(""==o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" es obligatorio";return t}if(0>o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe ser negativo";return t}if(h(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener letras";return t}break;case"name_person":if(""==o.value){t.title="Error";t.status="error";t.msg="El campo "+o.name+" es obligatorio";return t}if(f(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener n\xFAmeros";return t}break;case"otro_genero":if(""==document.getElementById("otro_genero").value&&e("#otro_genero").attr("required")){t.title="Error";t.status="error";t.msg="El campo "+o.name+" es obligatorio";return t}if(f(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener n\xFAmeros";return t}break;case"otro_act_simultanea":if(""==document.getElementById("otro_act_simultanea").value&&e("#otro_act_simultanea").attr("required")){t.title="Error";t.status="error";t.msg="El campo "+o.name+" es obligatorio";return t}if(f(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no debe contener n\xFAmeros";return t}break;case"num_doc":case"tel_res":case"celular":case"tel_acudiente":if(h(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" solo debe contener n\xFAmeros";return t}break;case"emailpilos":if(!b(o.value)){t.title="Error";t.status="error";t.msg="El campo "+o.name+" no tiene el formato de un correo electr\xF3nico";return t}break;}}return t},save_form_edit_profile:function save_form_edit_profile(a,t,o,r,s){c.show();e.ajax({type:"POST",data:JSON.stringify({function:"save_profile",params:[a,o,r,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(a){c.hide();e("#link_doc_dtddp").attr("href",e("#field_doc_dtddp").prop("value"));if(0==a.status_code){swal(a.title,a.message,a.type)}},dataType:"json",cache:"false",error:function error(e){c.hide();swal(e.title,e.msg,e.type)}});t.cancel_edition()},cancel_edition:function cancel_edition(){e("#span-icon-cancel-edit").hide();e("#tip-cancel").hide();e("#span-icon-save-profile").hide();e("#tip-save").hide();e("#span-icon-edit").show();e("#tip-edit").show();e("#tipo_doc").prop("disabled",!0);e("#num_doc").prop("readonly",!0);e("#email").prop("readonly",!0);e("#icetex_status").prop("disabled",!0);e("#genero").prop("disabled",!0);e("#sexo").prop("disabled",!0);e("#cond_excepcion").prop("disabled",!0);e("#act_simultanea").prop("disabled",!0);e("#etnia").prop("disabled",!0);e("#estado_civil").prop("disabled",!0);e("#pais").prop("disabled",!0);e("#observacion").prop("readonly",!0);e(".select_statuses_program").prop("disabled",!0);e("#field_doc_dtddp").hide();e(".input_fields_general_tab").prop("readonly",!0);e(".input-tracking").prop("disabled",!0);e(".bt_delete_person").css("visibility","hidden");e("#age").show();e("#birthdate").hide();e("#link_doc_dtddp").css("color","").css("text-decoration","");e("#link_doc_dtddp").unbind("click")},revert_changes:function revert_changes(a){for(field in a){e("#"+a[field].name).val(a[field].value)}location.reload(!0)}};function m(a){c.show();var t=e("#id_ases").val(),o=a.data.tab_name,r=document.querySelector("#dphpforms_block_instance").dataset.info;e(".active").removeClass("active");e("#"+o+"_li").addClass("active");e.ajax({type:"POST",data:JSON.stringify({function:"load_tabs",params:[t,o,r]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(a){if(0==a.status_code){e.ajax({url:"../templates/view_"+o+"_tab_sp.mustache",data:null,dataType:"text",async:!1,success:function success(t){c.hide();var r=e(l.render(t,a.data_response));e(".tab-content").append(r);switch(o){case"socioed":p.init();break;case"academic":d.init();break;case"geographic":_.init();e("#mapa").appendTo("#geographic_map");break;case"tracing_others":break;case"discapacity_tracking":u.init();break;}e("#"+o+"_tab").addClass("active")},error:function error(){c.hide();console.log("../templates/view_"+o+"_tab_sp.mustache cannot be reached.")}})}else{c.hide();console.log(a)}},dataType:"json",cache:"false",error:function error(e){c.hide();console.log(e)}})}function g(){c.show();var a=e("#id_ases").val(),t=document.querySelector("#peer_tracking_info"),o=JSON.parse(t?t.dataset.info:null);e.ajax({type:"POST",data:JSON.stringify({function:"load_risk_info",params:[a,o]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(a){c.hide();if(0==a.status_code){var t=a.data_response;z(t);e("#modal_riesgos").fadeIn(200);I();e("#view_graphic_risk_button").on("click",v)}else{console.log(a)}},dataType:"json",cache:"false",error:function error(e){c.hide();console.log(e)}})}function v(){e("#modal_riesgos").fadeIn(200);I()}function h(e){e=e.toLowerCase();for(i=0;i<e.length;i++){if(-1!="abcdefghyjklmn\xF1opqrstuvwxyz".indexOf(e.charAt(i),0)){return 1}}return 0}function f(e){for(i=0;i<e.length;i++){if(-1!="0123456789".indexOf(e.charAt(i),0)){return 1}}return 0}function b(e){var a=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;if(a.test(e)){return 1}else{return 0}}function k(a){var t=a.data.previous_status;e("#icetex_status").change(function(){var a=e("#icetex_status option:selected").text();swal({title:"\xBFEst\xE1 seguro/a de realizar este cambio?",text:"El estado Icetex del estudiante pasar\xE1 de "+t+" a "+a,type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!0,allowEscapeKey:!1},function(a){if(a){y()}else{e("#icetex_status").val(t)}})})}function y(){c.show();var a=e("#id_ases").val(),t=e("#icetex_status").val();e.ajax({type:"POST",data:JSON.stringify({function:"save_icetex_status",params:[a,t]}),dataType:"json",cache:"false",url:"../../ases/managers/student_profile/studentprofile_api.php",success:function success(e){c.hide();if(0==e.status_code){swal({title:e.title,text:e.message,type:e.type})}else{console.log(e)}},error:function error(){c.hide();swal("Error","No se puede contactar con el servidor.","error")}})}function x(){var a=e("#modal_dropout"),t=e(".mymodal-close"),o=e("#goback_backdrop");o.on("click",function(){a.hide()});t.on("click",function(){a.hide()})}function E(){var a=e("#modal_peer_tracking"),t=e(".mymodal-close"),o=e("#cancel_peer_tracking");o.on("click",function(){a.hide()});t.on("click",function(){a.hide()});var r=e(".panel-heading.heading_semester_tracking");r.on("click",function(){if("collapsed"==e(this).parent().attr("class")){e("h4>span",this).removeClass("glyphicon-chevron-left");e("h4>span",this).addClass("glyphicon-chevron-down")}else{e("h4>span",this).removeClass("glyphicon-chevron-down");e("h4>span",this).addClass("glyphicon-chevron-left")}})}function w(){var a=e("#modal_risk_span"),t=e("#modal_risk_close");a.on("click",function(){e("#modal_risk_graph").hide()});t.on("click",function(){e("#modal_risk_graph").hide()})}function C(){e("#date").datepicker({dateFormat:"yy-mm-dd"});for(var a=new Date,t=a.getDate(),o=a.getMonth()+1,r=a.getFullYear(),s=a.getMinutes(),n=a.getHours(),l="",c=0;24>c;c++){if(c==n){if(10>n){n="0"+n}l+="<option value=\""+n+"\" selected>"+n+"</option>"}else if(10>c){l+="<option value=\"0"+c+"\">0"+c+"</option>"}else{l+="<option value=\""+c+"\">"+c+"</option>"}}for(var d="",c=0;60>c;c++){if(c==s){if(10>s){s="0"+s}d+="<option value=\""+s+"\" selected>"+s+"</option>"}else if(10>c){d+="<option value=\"0"+c+"\">0"+c+"</option>"}else{d+="<option value=\""+c+"\">"+c+"</option>"}}e("#h_ini").append(l);e("#m_ini").append(d);e("#h_fin").append(l);e("#m_fin").append(d);e("#infomonitor").addClass("hide");e("#seguimiento").find("input:text, textarea").val("");e("#seguimiento").find("input:radio,input:checkbox").prop("checked",!1);e("#upd_seg").attr("disabled",!1);e("#upd_seg").attr("title","");e("#seguimiento").find("select, textarea, input").attr("disabled",!1);e("#no_value_individual").hide();e("#no_value_familiar").hide();e("#no_value_academic").hide();e("#no_value_economic").hide();e("#no_value_life").hide();e("#id_tracking_peer").val("");e("#place").val("");e("#topic_textarea").val("");e("#objetivos").val("");e("#individual").val("");e("#familiar").val("");e("#academico").val("");e("#economico").val("");e("#vida_uni").val("");e("#observaciones").val("");e("#no_value_individual").prop("checked",!0);e("#no_value_familiar").prop("checked",!0);e("#no_value_academic").prop("checked",!0);e("#no_value_economic").prop("checked",!0);e("#no_value_life").prop("checked",!0)}function T(){var a=e("#tracking_peer_form"),t=e("#modal_peer_tracking"),o=a.serializeArray(),r=A(document.location.search),s=B(o);if("success"!=s){swal({title:"Advertencia",text:s,type:"warning",html:!0})}else{o.push({name:"func",value:"save_tracking_peer"});var n=e("#id_ases").val();o.push({name:"id_ases",value:n});o.push({name:"id_instance",value:r.instanceid});e.ajax({type:"POST",data:o,url:"../../ases/managers/student_profile/studentprofile_serverproc.php",success:function success(e){swal({title:e.title,text:e.msg,type:e.type},function(){t.hide();var e=A(document.location.search);if(e.tab){location.reload()}else{location.href=location.search+"&tab=socioed_tab"}})},dataType:"json",cache:"false",error:function error(e){console.log(e)}})}}function B(e){var a=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,t=a.exec(e[1].value);if(""==e[1].value){return"Debe introducir la fecha en la cual se realiz\xF3 el seguimiento"}else if(null===t){return"La fecha no sigue el patr\xF3n yyyy-mm-dd. Ejemplo 2017-10-13"}else if(""==e[2].value){return"Debe introducir el lugar donde se realiz\xF3 el seguimiento"}else if(""==e[7].value){return"El campo tema se encuentra vacio"}else if(""==e[8].value){return"El campo objetivos se encuentra vacio"}else if(parseInt(e[5].value)<parseInt(e[3].value)){return"La hora de finalizaci\xF3n debe ser mayor a la hora inicial"}else if(parseInt(e[3].value)==parseInt(e[5].value)&&parseInt(e[6].value)<=parseInt(e[4].value)){return"La hora de finalizaci\xF3n debe ser mayor a la hora inicial"}else if(""!=e[9].value&&0==e[10].value){return"El riesgo asociado al campo Actividad Invidual no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Individual debe marcar un nivel de riesgo."}else if(""!=e[11].value&&0==e[12].value){return"El riesgo asociado al campo Actividad Familiar no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Familiar debe marcar un nivel de riesgo."}else if(""!=e[13].value&&0==e[14].value){return"El riesgo asociado al campo Actividad Acad\xE9mico no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Acad\xE9mico debe marcar un nivel de riesgo."}else if(""!=e[15].value&&0==e[16].value){return"El riesgo asociado al campo Actividad Econ\xF3mico no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Econ\xF3mico debe marcar un nivel de riesgo."}else if(""!=e[17].value&&0==e[18].value){return"El riesgo asociado al campo Actividad Vida Universitaria no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Vida Universitaria debe marcar un nivel de riesgo."}else if(""==e[9].value&&0!=e[10].value){return"Usted ha marcado el nivel de riesgo asociado a la actividad Individual, debe digitar informaci\xF3n en el campo Actividad Individual. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo."}else if(""==e[11].value&&0!=e[12].value){return"Usted ha marcado el nivel de riesgo asociado a la actividad Familiar, debe digitar informaci\xF3n en el campo Actividad Familiar. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo."}else if(""==e[13].value&&0!=e[14].value){return"Usted ha marcado el nivel de riesgo asociado a la actividad Acad\xE9mico, debe digitar informaci\xF3n en el campo Actividad Acad\xE9mico. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo."}else if(""==e[15].value&&0!=e[16].value){return"Usted ha marcado el nivel de riesgo asociado a la actividad Econ\xF3mico, debe digitar informaci\xF3n en el campo Actividad Econ\xF3mico. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo."}else if(""==e[17].value&&0!=e[18].value){return"Usted ha marcado el nivel de riesgo asociado a la actividad Vida Universitaria, debe digitar informaci\xF3n en el campo Actividad Vida Universitaria. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo."}else{return"success"}}function A(){for(var e=[],a=document.location.search.substring(1),t=a.split("&"),o=0,r;o<t.length;o++){r=t[o].split("=");e[r[0]]=r[1]}return e}function S(a){C();var t=new Date(e("#"+a+" .date_tracking_peer").text()),o=e("#"+a+" .place_tracking_peer").text(),r=e("#"+a+" .init_time_tracking_peer").text(),s=e("#"+a+" .ending_time_tracking_peer").text(),n=e("#"+a+" .topic_tracking_peer").text(),l=e("#"+a+" .objectives_tracking_peer").text(),c=e("#"+a+" .individual_tracking_peer").text(),d=e("#"+a+" .ind_risk_tracking_peer").text(),p=e("#"+a+" .familiar_tracking_peer").text(),_=e("#"+a+" .fam_risk_tracking_peer").text(),u=e("#"+a+" .academico_tracking_peer").text(),m=e("#"+a+" .aca_risk_tracking_peer").text(),g=e("#"+a+" .economico_tracking_peer").text(),v=e("#"+a+" .econ_risk_tracking_peer").text(),h=e("#"+a+" .lifeu_tracking_peer").text(),f=e("#"+a+" .lifeu_risk_tracking_peer").text(),b=e("#"+a+" .observations_tracking_peer").text(),k={};k.bajo=1;k.medio=2;k.alto=3;var y=t.getFullYear(),x=t.getMonth()+1;if(10>t.getMonth()){y+="-0"+x}else{y+="-"+x}if(10>t.getDate()){y+="-0"+t.getDate()}else{y+="-"+t.getDate()}var E=r.substring(0,2),w=r.substring(3,5),T=s.substring(0,2),B=s.substring(3,5);e("#h_ini option[value=\""+E+"\"]").attr("selected",!0);e("#m_ini option[value=\""+w+"\"]").attr("selected",!0);e("#h_fin option[value=\""+T+"\"]").attr("selected",!0);e("#m_fin option[value=\""+B+"\"]").attr("selected",!0);var A=k[d.toLowerCase()],S=k[_.toLowerCase()],j=k[v.toLowerCase()],O=k[m.toLowerCase()],z=k[f.toLowerCase()];if(""!=d){e("input[name='riesgo_ind'][value='"+A+"']").prop("checked",!0)}else{e("input[name='riesgo_ind'][value='0']").prop("checked",!0)}if(""!=_){e("input[name='riesgo_familiar'][value='"+S+"']").prop("checked",!0)}else{e("input[name='riesgo_familiar'][value='0']").prop("checked",!0)}if(""!=v){e("input[name='riesgo_econom'][value='"+j+"']").prop("checked",!0)}else{e("input[name='riesgo_econom'][value='0']").prop("checked",!0)}if(""!=m){e("input[name='riesgo_aca'][value='"+O+"']").prop("checked",!0)}else{e("input[name='riesgo_aca'][value='0']").prop("checked",!0)}if(""!=f){e("input[name='riesgo_uni'][value='"+z+"']").prop("checked",!0)}else{e("input[name='riesgo_uni'][value='0']").prop("checked",!0)}e("#date").val(y);e("#place").val(o);e("#topic_textarea").val(n);e("#objetivos").val(l);e("#individual").val(c);e("#familiar").val(p);e("#academico").val(u);e("#economico").val(g);e("#vida_uni").val(h);e("#observaciones").val(b);e("#id_tracking_peer").val(a);var I=e("#modal_peer_tracking");I.show()}function j(a){e.ajax({type:"POST",data:{func:"delete_tracking_peer",id_tracking:a},url:"../managers/student_profile/studentprofile_serverproc.php",success:function success(e){swal(e.title,e.msg,e.status);var a=A(document.location.search);if(a.tab){location.reload()}else{location.href=location.search+"&tab=socioed_tab"}},dataType:"json",cache:"false",error:function error(e){swal(e.title,e.msg,e.status)}})}function O(a){e.ajax({type:"POST",data:JSON.stringify({function:"is_student",params:[a]}),url:"../managers/student_profile/studentprofile_api.php",success:function success(e){var t=JSON.parse(e);if(1==t){var o=A(document.location.search),r=document.location+"",s=r.split("?"),n=s[0]+"?courseid="+o.courseid+"&instanceid="+o.instanceid+"&student_code="+a;location.href=n}else{swal("Error","No se encuentra un estudiante asociado al c\xF3digo ingresado","error")}},dataType:"text",cache:"false",error:function error(){swal("Error","Error al comunicarse con el servidor, por favor int\xE9ntelo nuevamente.","error")}})}function z(a){for(var t=[],o=["individual","familiar","academico","economico","vida_universitaria"],r=0;r<Object.keys(a).length;r++){var s=[],n=[],l=[],c=[],d=o[r],p=a[d][0].datos,_=0;while("false"==p.end){n.push(p.fecha);l.push(p.color);c.push(p.riesgo);_+=1;p=a[d][_].datos}s.push(d);s.push(n);s.push(l);s.push(c);t.push(s)}e("#risk_graphic_info").attr("data-info",JSON.stringify(t))}function I(){var e=JSON.parse(document.querySelector("#risk_graphic_info").dataset.info),a=q(e[0],ctx_individual),t=q(e[1],ctx_familiar),o=q(e[2],ctx_academico),r=q(e[3],ctx_economico),s=q(e[4],ctx_vida_universitaria)}function q(e,a){return new n(a,{type:"line",data:{labels:e[1],datasets:[{label:"Nivel de riesgo",fill:!1,lineTension:0,pointBackgroundColor:e[2],data:e[3],backgroundColor:"black",borderColor:"black",borderWidth:3,pointRadius:5,pointHoverRadius:7}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1,max:3,min:0}}]}}})}});
//# sourceMappingURL=student_profile_main.min.js.map
