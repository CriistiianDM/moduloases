define(["jquery","block_ases/bootstrap","block_ases/tagging","block_ases/smart_wizard","block_ases/mustache","block_ases/sweetalert","block_ases/select2"],function(e,t,a,i,n){return{init:function(){e(document).ready(function(){var t,a,i,n,o,r,s,l,c,d,p,u,_,v,m,f="",h="",b="",g="",y="",x="",k=!1,j=!1,w=!1,C=!1;function O(){W(e("#select_programa"),"get_programas_academicos")}function S(){f="",h="",b="",i="",n="",o="",g="",y="",x="",r=!1,s=!1,k=!1,l=!1,j=!1,c=!1,d=!1,w=!1,p=!1,u=!1,_=!1,v=!1,m=!1,C=!1,e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#emailpilos_modal").val(""),X("step-1"),X("step-2"),X("step-3"),X("div_educ_media"),X("step-4"),X("step-5"),X("step-6"),e("#select_programa").empty(),O(),oe("step1"),A("deportes",[]),A("actividades",[]),e("#table_familia").find("tbody tr").remove(),e("#smartwizard").smartWizard("reset")}function E(){r?e("#step-1 :input").prop("disabled",!1):(e("#nombre").prop("disabled",!0),e("#apellido").prop("disabled",!0),e("#emailinstitucional").prop("disabled",!0)),e("#edad").prop("disabled",!0)}function N(t){var a=new Date,i=new Date(t),n=a.getFullYear()-i.getFullYear(),o=a.getMonth()-i.getMonth();(o<0||0===o&&a.getDate()<i.getDate())&&n--,e("#edad").val(n)}function J(t,a,i){let n="";n+='<tr><td> <input id="nom'+i+'" class="input_fields_general_tab_modal"  type="text"/></td>',n+='<td> <input id="rol'+i+'" class="input_fields_general_tab_modal"  type="text" /></td>',n+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_familia").find("tbody").append(n),e("#nom"+i).val(t),e("#rol"+i).val(a)}e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#pruebas").on("click",function(){}),e("#mostrar").on("click",function(){W(e("#id_ciudad_ini"),"get_ciudades"),W(e("#acompanamientos"),"get_otros_acompañamientos"),W(e("#id_cond_excepcion"),"get_cond_excepcion"),W(e("#id_estado_civil"),"get_estados_civiles"),W(e("#sexo"),"get_sex_options"),W(e("#id_identidad_gen"),"get_generos"),W(e("#id_act_simultanea"),"get_act_simultaneas"),W(e("#id_etnia"),"get_etnias"),W(e("#tipo_doc"),"get_document_types"),W(e("#id_discapacidad"),"get_discapacities"),W(e("#id_pais"),"get_paises"),W(e("#barrio_res"),"get_barrios"),W(e("#id_ciudad_res"),"get_ciudades"),O(),W(e("#id_pais_res"),"get_paises"),W(e("#barrio_ini"),"get_barrios"),W(e("#tipo_doc_ini"),"get_document_types"),W(e("#select_sede"),"get_sedes"),Q("permanencia","solvencia_econo"),Q("set-desplazamiento","ayuda_transporte"),Q("set-certificado-discapacidad","discapacidad"),Q("set-apoyo","apoyo_partic"),Q("set-participacion","participacion"),Q("set-salud","condicion"),ee("set-orientacion","orientacion_sexual"),ee("set-identidad-gen","identidad_genero"),Q("set-beca","beca"),(t=new Tagging(e("#deportes_tag"),e("#tags_deportes"),1,3)).createTag(),(a=new Tagging(e("#tiempo_libre"),e("#tags_tiempo_libre"))).createTag(),e(".js-example-basic-single").select2(),e("#modalExample").show(),document.body.style.overflowY="hidden"}),e(".closer").on("click",function(){e("#modalExample").hide(),document.body.style.overflowY="visible"}),e("#smartwizard").smartWizard({selected:0,theme:"dots",autoAdjustHeight:!0,showStepURLhash:!1,lang:{next:"Continuar y Guardar",previous:"Anterior"}}),e("#limpiar_form").on("click",function(){S()}),e("#validar_codigo").on("click",function(){var t,a=e("#codigo_estudiantil").val();oe("step1"),(t=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),t.addClass("otros"),(t=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),t.addClass("otros"),""===a||" "===a?(e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),O()):e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(t){!function(t){0!=t?(e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#tipo_doc_ini").prop("disabled",!1),e("#num_doc_ini").prop("disabled",!1),e("#select_sede").prop("disabled",!1),e("#select_programa").prop("disabled",!1),function(t){e("#nombre").val(t.firstname),e("#apellido").val(t.lastname),e("#emailinstitucional").val(t.email),E(),programs=t.username.slice(t.username.indexOf("-")+1),e("#select_programa").empty(),W(e("#select_programa"),"get_programas_academicos_est",programs)}(t),s=!1,r=!1):swal({title:"Warning",text:"Estudiante inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal({title:"Confirmado",text:"",type:"success",timer:1500}),r=!0,s=!1,X("step-2"),X("step-3"),X("div_educ_media"),X("step-4"),X("step-5"),X("step-6"),E()):(swal({title:"Cancelado",text:"Ingresa nuevamente el codigo del estudiante",type:"error",timer:1500}),e("#codigo_estudiantil").val(""))})}(JSON.parse(t))},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}),e("#fecha_nac_modal").blur(function(){N(e("#fecha_nac_modal").val())}),e(document).on("click",".remove_fila",function(){u=!0,e(this).parent().parent().remove()}),e(document).on("click",".remove_fila_ing",function(){_=!0,T--,e(this).parent().parent().remove()}),e("#add_person_r").on("click",function(){u=!0,function(e){let t="";t+='<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td>',t+='<td> <input  class="input_fields_general_tab_modal"  type="text" /></td>',t+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e.find("tbody").append('<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td><td> <input  class="input_fields_general_tab_modal"  type="text" /></td><td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>')}(e("#table_familia"))}),e("#add_ingreso").on("click",function(){_=!0,T++,function(t){let a="";a+='<tr><td> <input id="anio_'+T+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+T+'"  type="text"/></td>',a+='<td> <select id="s_programa_'+T+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+T+'" name="id_programa_'+T+'" class="ingresos_u" type="number" hidden></td>',a+='<td><select class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input  id="motivo_'+T+'" name="motivo_'+T+'" class="ingresos_u" type="number" hidden> </td>',a+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',t.find("tbody").append(a),W(e("#s_programa_"+T),"get_programas_academicos")}(e("#table_ingresos"))}),e(document).on("click","#guardar_info",function(){d?C&&(!function(){var t=Y();V(e("#num_doc_ini").val());var a=e("#EPS").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_health_service",params:[t,a,h,g]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=e;t&&swal("Actualizacion completada exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),C=!1):(!function(){var t=Y();V(e("#num_doc_ini").val());var a=e("#EPS").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_health_service",params:[t,a,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=e;isNaN(t)||swal("Registro completado exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),d=!0,C=!1)});var T=0;function P(t,a,i,n){let o="";o+='<tr><td> <input id="anio_'+t+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+t+'"  type="text"/></td>',o+='<td> <select id="s_programa_'+t+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+t+'" name="id_programa_'+t+'" class="ingresos_u" type="number" hidden></td>',o+='<td><select id="motivo_I'+t+'" class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input id="motivo_'+t+'" name="motivo_'+t+'" class="ingresos_u" type="number" hidden> </td>',o+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_ingresos").find("tbody").append(o),W(e("#s_programa_"+t),"get_programas_academicos"),e("#anio_"+t).val(a),setTimeout(()=>{e("#s_programa_"+t).val(i)},1e3),e("#motivo_I"+t).val(n),T=t}function z(t){for(var a=[],i=t.find("tbody input").map(function(){return e(this).val()}).get(),n=0;n<i.length;n+=2){var o={nombre:i[n],rol:i[n+1]};a.push(o)}return a}function V(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_ases_user_id",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);null==a?function(e){h=e}(t.id):1==a&&function(e){b=e}(t)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function A(i,n){"deportes"==i?t.displayTags(n,e("#tags_deportes")):a.displayTags(n,e("#tags_tiempo_libre"))}function B(t,a){e("input:radio[name="+t+"]").filter("[value="+a+"]").attr("checked",!0)}function D(t){e("input[name="+t+"]").attr("checked",!0)}function I(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:a,params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);"exist_academics_data"==a?j=t:"exist_health_data"==a?d=t:"exist_discapacity_data"==a&&(c=t)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function R(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:a,params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);x=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function q(t){switch(t){case"solvencia_econo":(a=e("#permanencia .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"ayuda_transporte":(a=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"beca":(a=e("#set-beca .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"participacion":(a=e("#set-participacion .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"condicion":(a=e("#set-salud .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"apoyo_partic":(a=e("#set-apoyo .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"discapacidad":(a=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"identidad_genero":(a=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"orientacion_sexual":var a;(a=e("#set-orientacion .otro").parent().next()).attr("hidden",!1),a.removeClass("otros")}}function F(t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t,a=JSON.parse(e);t=a.id,f=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function M(t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_program",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t,a=JSON.parse(e);t=a.cod_univalle,y=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function W(t,a,i){var n="1";null!=i&&(n=i),e.ajax({type:"POST",data:JSON.stringify({function:a,params:n}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=JSON.parse(e);for(var i in a)t.append("<option value='"+a[i].id+"'>"+Object.values(a[i])[1]+"</option>")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function X(t){e("#"+t).find("input").each(function(){switch(e(this).attr("type")){case"text":case"number":case"date":""!=e(this).val()&&e(this).val("");break;case"radio":let t=e(this).attr("name");e(this).is(":checked")&&e(this).attr("checked",!1),e(this).hasClass("otro")&&function(t){switch(t){case"solvencia_econo":(a=e("#permanencia .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"ayuda_transporte":(a=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"beca":(a=e("#set-beca .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"participacion":(a=e("#set-participacion .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"condicion":(a=e("#set-salud .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"apoyo_partic":(a=e("#set-apoyo .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"discapacidad":(a=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"identidad_genero":(a=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"orientacion_sexual":var a;(a=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),a.addClass("otros")}}(t);break;case"checkbox":if(e(this).is(":checked")){let t=e(this).attr("name");e("input[name="+t+"]").attr("checked",!1)}case"tel":""!=e(this).val()&&e(this).val("")}}),e("#"+t).find("textarea").each(function(){""!=e(this).val()&&e(this).val("")}),e("#"+t).find("select").each(function(){""!=e(this).val()&&e(this).val(1)})}function Y(){var e=[],t=[];return H("regimen_salud",t),G("regimen_salud",t,e),H("data_sisben",t=[]),$("observ_sisben",t),H("serv_adicionales",t),H("conclusion_jornada",t),$("conclusion",t),H("json_detalle",t),G("datos_salud_adicionales",t,e),H("serv_usuario",t=[]),G("servicios_usados",t,e),t=[],e}function L(){var e=[],t=[];return H("percepcion_discapacidad",t),$("desc_discap",t),G("percepcion_disca",t,e),H("diagnosticos",t=[]),G("diagnosticos",t,e),H("condicion_salud",t=[]),$("rel_cond_salud",t),G("condicion_salud",t,e),H("medicamentos",t=[]),G("medicamentos",t,e),H("cambio_tratamiento",t=[]),$("obs_cambio",t),G("cambios_tratamiento",t,e),H("disca_por_municipio",t=[]),$("doc_localizacion",t),G("discapacidad_municipio",t,e),H("certificado_disca",t=[]),$("certi_disca",t),G("certificado_discapacidad",t,e),H("datos_invalidez",t=[]),G("certificado_invalidez",t,e),H("cond_org_sist",t=[]),G("condicion_organos",t,e),H("dif_permanente",t=[]),G("dificultad_permanente",t,e),H("set-participacion",t=[]),$("text_participacion",t),H("set-apoyo",t),$("text_apoyo_partic",t),G("participacion_estudiantil",t,e),H("asoc_disca",t=[]),G("organizacion_disca",t,e),H("apoyo_recibido",t=[]),G("apoyo_dicapacidad",t,e),t=[],e}function U(){for(var t={},a=e(".select-academics-data").map(function(){return e(this).attr("id")}).get(),i=e(".select-academics-data").map(function(){return e(this).next().attr("id")}).get(),n=0;n<i.length;n++)e("#"+i[n]).val(e("#"+a[n]+" option:selected").val());var o=[],r=[],s=[];H("dif_educ_media",s),H("dif_educ_superior",s),H("dif_educ_paralelo",s),t.key_input="dificultades",t.val_input=s,(s=[]).push(t),t={};var l=[],c=e(".ingresos_u").serializeArray();return H("jornada",c),H("p_ingreso",c),G("datos_academicos_adicionales",c,l),H("div_tipo_institucion",r),H("div_tipo_institucion_superior",r),H("div_tipo_institucion_paralelo",r),t.key_input="otras_instituciones",t.val_input=r,(r=[]).push(t),t={},o.push(l),o.push(r),o.push(s),o}function Z(){var e=[],t=[],a=[],i=[],n=[],o=[],r=[],s={},l={},c={},d={};return H("set-sostenimiento",r),H("otro_ingreso",r),G("datos_economicos_adicionales",r,e),H("set-permanencia",e),H("set-beca",e),H("set-materiales",t),H("set-valor-materiales",t),e.push(t),H("set-desplazamiento",t=[]),H("set-valor-desplazamiento",t),e.push(t),H("row_madre_academic",a),H("row_padre_academic",a),H("row_otro_academic",a),H("row_madre_ocupacion",i),H("row_padre_ocupacion",i),H("row_otro_ocupacion",i),H("row_madre_laboral",n),H("row_padre_laboral",n),H("row_otro_laboral",n),$("motivo_ingreso",o),$("expecativas_carrera",o),$("expectativas_graduarse",o),s.key_input="expectativas_laborales",s.val_input=o,c.key_input="ocupacion_padres",c.val_input=i,l.key_input="nivel_educ_padres",l.val_input=a,d.key_input="situa_laboral_padres",d.val_input=n,e.push(l),e.push(c),e.push(d),e.push(s),e}function $(t,a){json_insert={},null!=e("#"+t).val()&&e("#"+t).val().length>=3&&(json_insert.key_input_text=e("#"+t).attr("id"),json_insert.val_input_text=e("#"+t).val(),a.push(json_insert),json_insert={})}function G(e,t,a){json_insert={},json_insert.key_input=e,json_insert.val_input=t,a.push(json_insert),json_insert={}}function H(t,a){e("#"+t).find("input").each(function(){switch(json_object={},e(this).attr("type")){case"text":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_text=e(this).attr("id"),json_object.val_input_text=e(this).val(),a.push(json_object);break;case"number":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_number=e(this).attr("id"),json_object.val_input_number=e(this).val(),a.push(json_object);break;case"date":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_date=e(this).attr("id"),json_object.val_input_date=e(this).val(),a.push(json_object);break;case"radio":if(""===(t=K(e(this))).id)break;""!=t.id1?(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==t.type&&(json_object.key_input_text=t.id,json_object.val_input_text=t.val,json_object.key_input_number=t.id1,json_object.val_input_number=t.val1),a.push(json_object)):(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==t.type?(json_object.key_input_text=t.id,json_object.val_input_text=t.val):"number"==t.type&&(json_object.key_input_number=t.id,json_object.val_input_number=t.val),a.push(json_object));break;case"checkbox":var t;if(""===(t=K(e(this))).id)break;json_object.key_input=e(this).attr("id"),json_object.val_input="on","text"==t.type?(json_object.key_input_text=t.id,json_object.val_input_text=t.val):"number"==t.type&&(json_object.key_input_number=t.id,json_object.val_input_number=t.val),a.push(json_object);break;default:json_object.key_input=0,json_object.val_input=0}})}function K(e){var t={};if(e.is(":checked")){if(e.hasClass("otro")){var a=e.parent().next().find("input"),i=e.parent().next().children("input:last");return t.id=a.attr("id"),t.val=a.val(),t.type=a.attr("type"),i.attr("id")!=t.id&&(t.id1=i.attr("id"),t.val1=i.val(),t.type1=i.attr("type")),t}return t.id=e.attr("name"),t.val=e.val(),t}return t.id="",t.val="",t}function Q(t,a){e("#"+t).find("[name="+a+"]").on("click",function(){var a=e("#"+t+" .otro").parent().next();e(this).hasClass("otro")?(a.attr("hidden",!1),a.removeClass("otros")):(a.attr("hidden",!0),a.addClass("otros"))})}function ee(t,a){e("#"+t).find("[name="+a+"]").on("change",function(){var a=e("#"+t+" .otro").parent().next();e(this).hasClass("otro")&&e(this).prop("checked")?(a.attr("hidden",!1),a.removeClass("otros")):(a.attr("hidden",!0),a.addClass("otros"))})}function te(e,t){switch(t){case"codigo_estudiantil":case"num_doc_ini":ie(e);break;case"nombre":case"apellido":ae(e);break;case"celular_modal":case"tel_res_modal":case"tel_ini":case"tel_acudiente_modal":case"tel_cont_2":case"estrato_modal":case"hijos_modal":case"semestre_actual":case"anio_ingreso":case"puntaje_icfes_modal":ie(e)}}function ae(e){for(var t in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" áéíóúabcdefghijklmnñopqrstuvwxyz",especiales=[8,37,39,46],tecla_especial=!1,especiales)if(key==especiales[t]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function ie(e){for(var t in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" 0123456789",especiales=[8,37,39],tecla_especial=!1,especiales)if(key==especiales[t]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function ne(t){var a=!1;return e("."+t+"[required]").each(function(){var t=e(this);if("radio"==t.attr("type")){var i=t.attr("name");if(e('input:radio[name="'+i+'"]').is(":checked")){let t=e(this).prev();e(this).prev().hasClass("alert")&&t.attr("hidden",!0)}else{a=!0,e(this).prev().attr("hidden",!1)}}else if(""==t.val()){a=!0,e(this).next().attr("hidden",!1)}else{let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)}}),a}function oe(t){e("."+t+"[required]:visible").each(function(){let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)})}function re(){var t=z(e("#table_familia"));H("set-vive",t);var a=JSON.stringify(t),n=e("#hijos_modal").val(),o=e("#estrato_modal").val();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step2",params:[h,o,n,a,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function se(){var t=e("#puntaje_icfes_modal").val(),a=e("#anio_ingreso").val(),i=e("#colegio").val();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step3",params:[h,t,a,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function le(){var t=e("#input_discapacidad").val();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step4",params:[h,t]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}e("#num_doc_ini").blur(function(){e("#num_doc_ini").val().length>2&&(oe("step1"),V(e("#num_doc_ini").val()),e("#step-1 :input").prop("disabled",!1),null!=h?(F(e("#codigo_estudiantil").val()),function(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_exist_user_extended",params:[t,a]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){k=JSON.parse(e)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(h,f),k?(X("step-2"),X("step-3"),X("div_educ_media"),X("step-4"),X("step-5"),X("step-6"),E(),s=!0,V(e("#num_doc_ini").val(),1),function(t){var a=!0;for(var n in t)"json_detalle"==n&&(a=!1);for(var n in t)if(null!=t[n])switch(n){case"vive_con":let d="";if(-1==t[n].indexOf("Array")){let a=(d=JSON.parse(t[n])).find(e=>"vive"===e.key_input);null!=a&&B(a.key_input,a.val_input),e("#table_familia").find("tbody tr").remove();for(let e=0;e<d.length-1;e++){let t=d[e];J(t.nombre,t.rol,e)}}else e("#table_familia").find("tbody tr").remove();break;case"fecha_nac":var o=new Date(t[n]),r="",s="";s=1+o.getMonth()<10?"0"+(1+o.getMonth()):1+o.getMonth(),r=o.getDate()<10?"0"+o.getDate():o.getDate(),e("#fecha_nac_modal").val(o.getFullYear()+"-"+s+"-"+r),N(t[n]);break;case"json_detalle":var c=t[n];c=JSON.parse(c);for(let t=0;t<c.length;t++){const i=c[t];null!=i.key_input_text?e("#"+i.key_input_text).val(i.val_input_text):"sede"==i.key_input_number?(e("#select_sede").val(i.val_input_number),e("#select_sede").trigger("change")):"orientacion_s"==i.key_input_number?(e("#select-orientacion").val(i.val_input_number),e("#select-orientacion").trigger("change")):(e("#acompanamientos").val(i.val_input_number),e("#acompanamientos").trigger("change")),null!=i.key_input&&(D(i.key_input),q(i.key_input)),null!=i.v_modal&&(a=!0)}break;case"actividades_ocio_deporte":var c=t[n];c=JSON.parse(c);for(let e=0;e<c.length;e++){const t=c[e];A(t.name,t.value)}break;case"id_economics_data":null!=(i=t[n])&&(l=!0,w=!0,I(h,"exist_academics_data"),I(h,"exist_health_data"),I(h,"exist_discapacity_data"));break;default:"estrato"==n||"puntaje_icfes"==n||"hijos"==n||"tel_res"==n||"celular"==n||"tel_acudiente"==n||"emailpilos"==n?e("#"+n+"_modal").val(t[n]):(e("#"+n).val(t[n]),e("#"+n).trigger("change"))}a||(swal({title:"",text:"Este usuario ha sido registrado con otro formulario",type:"info"}),S());p=!1}(b)):(E(),e("#num_doc_ini").val(""),swal("Waarning","No existe relacion entre el numero de documento y el codigo del estudiante, intentalo nuevamente.","warning"))):swal({title:"Warning",text:"Usuario inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal({title:"Confirmado",text:"",type:"success",timer:1500}),e("#step-1 :input").prop("disabled",!1),E()):(swal({title:"Cancelado",text:"Ingresa nuevamente el documento del estudiante",type:"error",timer:1500}),e("#num_doc_ini").val(""))}))}),e(".step1").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),p=!0)}),t.bind("keypress",function(e){te(e,t.attr("id"))})}),e(".step2").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),u=!0)}),t.bind("keypress",function(e){te(e,t.attr("id"))})}),e(".step3").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),_=!0)}),t.bind("keypress",function(e){te(e,t.attr("id"))})}),e(".step4").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),v=!0)})}),e(".step5").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),m=!0)})}),e(".step6").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),C=!0)})}),e('input[type="radio"]').on("change",function(){e(this).hasClass("step1")?p=!0:e(this).hasClass("step2")?u=!0:e(this).hasClass("step3")?_=!0:e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#codigo_estudiantil").each(function(){var t=e(this);t.bind("keypress",function(e){te(e,t.attr("id"))})}),e('input[type="checkbox"]').on("change",function(){e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#emailpilos_modal").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEPilos").attr("hidden",!0),e("#successEPilos").attr("hidden",!1),setTimeout(()=>{e("#successEPilos").attr("hidden",!0)},3e3)):(e("#errorEPilos").attr("hidden",!1),e("#successEPilos").attr("hidden",!0))}),e("#emailinstitucional").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEInst").attr("hidden",!0),e("#successEInst").attr("hidden",!1),setTimeout(()=>{e("#successEInst").attr("hidden",!0)},3e3)):(e("#errorEInst").attr("hidden",!1),e("#successEInst").attr("hidden",!0))}),e("#smartwizard").on("leaveStep",function(b,k,C,O,S){if("forward"===O)switch(function(){e("#tipo_doc").val(e("#tipo_doc_ini option:selected").val());for(var t=e(".select-registro").map(function(){return e(this).attr("id")}).get(),a=e(".select-registro").map(function(){return e(this).next().attr("id")}).get(),i=0;i<a.length;i++)e("#"+a[i]).val(e("#"+t[i]+" option:selected").val())}(),C){case 0:if(X=!1,e("."+"step1"+"[required]:visible").each(function(){if(""==e(this).val())X=!0,e(this).next().attr("hidden",!1);else{let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)}}),X)return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;r&&(M(e("#programa").val()),N=e("#codigo_estudiantil").val(),J=e("#nombre").val(),T=e("#apellido").val(),A=e("#emailinstitucional").val(),I=N+"-"+y,W=(W=J.charAt(0)+N+T.charAt(0)).toUpperCase(),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_mdl_user",params:[I,J,T,A,W]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){f=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),r=!1),s?p&&(V(e("#num_doc_ini").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:t.getArr()}),i.push({name:"actividades",value:a.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=e("#programa").val(),s=[];H("otra_identidad",s),s.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),s.push({v_modal:!0}),H("otra_orientacion",s),H("div_contacto_2",s),H("otros_acomp",s),H("sede_div",s),s=JSON.stringify(s),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_data_ases",params:[n,i,r,h,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),p=!1):(F(e("#codigo_estudiantil").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:t.getArr()}),i.push({name:"actividades",value:a.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=z(e("#table_familia")),s=e("#programa").val(),l=[];H("otra_identidad",l),l.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),l.push({v_modal:!0}),H("otra_orientacion",l),H("div_contacto_2",l),H("otros_acomp",l),H("sede_div",l),l=JSON.stringify(l),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data",params:[n,i,r,s,f,l]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),s=!0,p=!1),l&&(V(e("#num_doc_ini").val()),R(h,"get_economics_data"),function(t){let a=Object.values(t);for(let t=2;t<a.length;t++){var i=JSON.parse(a[t]);if(null!=i)if(Array.isArray(i))for(let t=0;t<i.length;t++)void 0!==i[t].key_input?(B(i[t].key_input,i[t].val_input),0==i[t].val_input&&(q(i[t].key_input),e("#"+i[t].key_input_text).val(i[t].val_input_text))):e("#"+i[t].key_input_text).val(i[t].val_input_text);else"beca"===i.key_input?(B(i.key_input,i.val_input),0==i.val_input&&(q("beca"),e("#"+i.key_input_text).val(i.val_input_text),e("#"+i.key_input_number).val(i.val_input_number))):B("solvencia_econo",i)}}(x));break;case 1:if(ne("step2"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;l?u&&(re(),function(){var t=Z(),a=e("#estrato_modal").val();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_economics_dt",params:[t,a,h,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),u=!1):(!function(){var t=Z(),a=e("#estrato_modal").val();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_economics_data",params:[t,a,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){i=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),re(),l=!0,u=!1),j&&(V(e("#num_doc_ini").val()),R(h,"get_academics_data"),function(t){for(const a in t)switch(a){case"id":n=t[a];break;case"otras_instituciones":let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)e("#"+i[t].key_input_text).val(i[t].val_input_text),null!=i[t].key_input&&B(i[t].key_input,i[t].val_input);break;case"dificultades":let o=JSON.parse(t[a]);for(let t=0;t<o.length;t++)e("#"+o[t].key_input_text).val(o[t].val_input_text);break;case"datos_academicos_adicionales":let r=JSON.parse(t[a]);e("#table_ingresos").find("tbody").find("tr").remove();for(let t=0;t<r.length;t++)null!=r[t].name&&-1!=r[t].name.indexOf("anio")&&P(t+1,r[t].value,r[t+1].value,r[t+2].value),e("#"+r[t].key_input_text).val(r[t].val_input_text),e("#"+r[t].key_input_date).val(r[t].val_input_date),null!=r[t].key_input&&B(r[t].key_input,r[t].val_input);break;default:"observaciones"==a?e("#"+a+"_modal").val(t[a]):e("#"+a).val(t[a])}}(x),_=!1);break;case 2:if(ne("step3"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;j?_&&(se(),function(){var t=U();V(e("#num_doc_ini").val());var a=e("#programa").val(),i=e("#titulo_1").val(),o=e("#observaciones_modal").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_academics_dt",params:[t,a,i,o,h,n]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),_=!1):(se(),function(){var t=U();V(e("#num_doc_ini").val());var a=e("#programa").val(),i=e("#titulo_1").val(),n=e("#observaciones_modal").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_academics_data",params:[t,a,i,n,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),j=!0,_=!1),c&&(V(e("#num_doc_ini").val()),R(h,"get_discapacity_data"),function(t){for(const a in t){"id"==a&&(o=t[a]);let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)"on"===i[t].val_input?D(i[t].key_input):(B(i[t].key_input,i[t].val_input),0==i[t].val_input&&(q(i[t].key_input),e("#"+i[t].key_input_text).val(i[t].val_input_text))),"doc_localizacion"!==i[t].key_input_text&&"certi_disca"!==i[t].key_input_text&&(e("#"+i[t].key_input_text).val(i[t].val_input_text),e("#"+i[t].key_input_date).val(i[t].val_input_date))}}(x));break;case 3:w?v&&(le(),v=!1):(le(),w=!0,v=!1);break;case 4:c?m&&(!function(){var t=L();V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_discapacity_dt",params:[t,h,o]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),m=!1):(E=L(),V(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_disapacity_data",params:[E,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),c=!0,m=!1),d&&(V(e("#num_doc_ini").val()),R(h,"get_health_data"),function(t){for(const a in t)switch(a){case"id":g=t[a];break;case"servicio_salud_vinculado":e("#EPS").val(t[a]);break;default:let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)"on"===i[t].val_input?D(i[t].key_input):B(i[t].key_input,i[t].val_input),e("#"+i[t].key_input_text).val(i[t].val_input_text),e("#"+i[t].key_input_number).val(i[t].val_input_number),e("#"+i[t].key_input_date).val(i[t].val_input_date)}}(x))}var E,N,J,T,A,I,W,X})})}}});