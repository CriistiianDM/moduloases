define(["jquery","block_ases/bootstrap","block_ases/tagging","block_ases/smart_wizard","block_ases/mustache","block_ases/sweetalert","block_ases/select2"],function(e,t,a,i,n){return{init:function(){e(document).ready(function(){var t,a,i,n,o,r,s,c,l,d,p,u,_,v,m,f="",h="",b="",g="",y="",x="",k=!1,j=!1,w=!1,C=!1;function O(){M(e("#select_programa"),"get_programas_academicos")}function S(){r?e("#step-1 :input").prop("disabled",!1):(e("#nombre").prop("disabled",!0),e("#apellido").prop("disabled",!0),e("#emailinstitucional").prop("disabled",!0)),e("#edad").prop("disabled",!0)}function E(t){var a=new Date,i=new Date(t),n=a.getFullYear()-i.getFullYear(),o=a.getMonth()-i.getMonth();(o<0||0===o&&a.getDate()<i.getDate())&&n--,e("#edad").val(n)}function N(t,a,i){let n="";n+='<tr><td> <input id="nom'+i+'" class="input_fields_general_tab_modal"  type="text"/></td>',n+='<td> <input id="rol'+i+'" class="input_fields_general_tab_modal"  type="text" /></td>',n+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_familia").find("tbody").append(n),e("#nom"+i).val(t),e("#rol"+i).val(a)}e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#pruebas").on("click",function(){}),e("#mostrar").on("click",function(){M(e("#id_ciudad_ini"),"get_ciudades"),M(e("#acompanamientos"),"get_otros_acompañamientos"),M(e("#id_cond_excepcion"),"get_cond_excepcion"),M(e("#id_estado_civil"),"get_estados_civiles"),M(e("#sexo"),"get_sex_options"),M(e("#id_identidad_gen"),"get_generos"),M(e("#id_act_simultanea"),"get_act_simultaneas"),M(e("#id_etnia"),"get_etnias"),M(e("#tipo_doc"),"get_document_types"),M(e("#id_discapacidad"),"get_discapacities"),M(e("#id_pais"),"get_paises"),M(e("#barrio_res"),"get_barrios"),M(e("#id_ciudad_res"),"get_ciudades"),O(),M(e("#id_pais_res"),"get_paises"),M(e("#barrio_ini"),"get_barrios"),M(e("#tipo_doc_ini"),"get_document_types"),M(e("#select_sede"),"get_sedes"),K("permanencia","solvencia_econo"),K("set-desplazamiento","ayuda_transporte"),K("set-certificado-discapacidad","discapacidad"),K("set-apoyo","apoyo_partic"),K("set-participacion","participacion"),K("set-salud","condicion"),Q("set-orientacion","orientacion_sexual"),Q("set-identidad-gen","identidad_genero"),K("set-beca","beca"),(t=new Tagging(e("#deportes_tag"),e("#tags_deportes"),1,3)).createTag(),(a=new Tagging(e("#tiempo_libre"),e("#tags_tiempo_libre"))).createTag(),e(".select_modal").select2(),e("#modalExample").show(),document.body.style.overflowY="hidden"}),e(".closer").on("click",function(){e("#modalExample").hide(),document.body.style.overflowY="visible"}),e("#smartwizard").smartWizard({selected:0,theme:"dots",autoAdjustHeight:!0,showStepURLhash:!1,lang:{next:"Continuar y Guardar",previous:"Anterior"}}),e("#limpiar_form").on("click",function(){f="",h="",b="",i="",n="",o="",g="",y="",x="",r=!1,s=!1,k=!1,c=!1,j=!1,l=!1,d=!1,w=!1,p=!1,u=!1,_=!1,v=!1,m=!1,C=!1,e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#emailpilos_modal").val(""),W("step-1"),W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),e("#select_programa").empty(),O(),ne("step1"),V("deportes",[]),V("actividades",[]),e("#table_familia").find("tbody tr").remove(),e("#smartwizard").smartWizard("reset")}),e("#validar_codigo").on("click",function(){var t,a=e("#codigo_estudiantil").val();ne("step1"),(t=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),t.addClass("otros"),(t=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),t.addClass("otros"),""===a||" "===a?(e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),O()):e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(t){!function(t){0!=t?(e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#tipo_doc_ini").prop("disabled",!1),e("#num_doc_ini").prop("disabled",!1),e("#select_sede").prop("disabled",!1),e("#select_programa").prop("disabled",!1),function(t){e("#nombre").val(t.firstname),e("#apellido").val(t.lastname),e("#emailinstitucional").val(t.email),S(),programs=t.username.slice(t.username.indexOf("-")+1),e("#select_programa").empty(),M(e("#select_programa"),"get_programas_academicos_est",programs)}(t),s=!1,r=!1):swal({title:"Warning",text:"Estudiante inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal({title:"Confirmado",text:"",type:"success",timer:1500}),r=!0,s=!1,W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),S()):(swal({title:"Cancelado",text:"Ingresa nuevamente el codigo del estudiante",type:"error",timer:1500}),e("#codigo_estudiantil").val(""))})}(JSON.parse(t))},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}),e("#fecha_nac_modal").blur(function(){E(e("#fecha_nac_modal").val())}),e(document).on("click",".remove_fila",function(){u=!0,e(this).parent().parent().remove()}),e(document).on("click",".remove_fila_ing",function(){_=!0,J--,e(this).parent().parent().remove()}),e("#add_person_r").on("click",function(){u=!0,function(e){let t="";t+='<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td>',t+='<td> <input  class="input_fields_general_tab_modal"  type="text" /></td>',t+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e.find("tbody").append('<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td><td> <input  class="input_fields_general_tab_modal"  type="text" /></td><td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>')}(e("#table_familia"))}),e("#add_ingreso").on("click",function(){_=!0,J++,function(t){let a="";a+='<tr><td> <input id="anio_'+J+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+J+'"  type="text"/></td>',a+='<td> <select id="s_programa_'+J+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+J+'" name="id_programa_'+J+'" class="ingresos_u" type="number" hidden></td>',a+='<td><select class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input  id="motivo_'+J+'" name="motivo_'+J+'" class="ingresos_u" type="number" hidden> </td>',a+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',t.find("tbody").append(a),M(e("#s_programa_"+J),"get_programas_academicos")}(e("#table_ingresos"))}),e(document).on("click","#guardar_info",function(){d?C&&(!function(){var t=X();z(e("#num_doc_ini").val());var a=e("#EPS").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_health_service",params:[t,a,h,g]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=e;t&&swal("Actualizacion completada exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),C=!1):(!function(){var t=X();z(e("#num_doc_ini").val());var a=e("#EPS").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_health_service",params:[t,a,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=e;isNaN(t)||swal("Registro completado exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),d=!0,C=!1)});var J=0;function T(t,a,i,n){let o="";o+='<tr><td> <input id="anio_'+t+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+t+'"  type="text"/></td>',o+='<td> <select id="s_programa_'+t+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+t+'" name="id_programa_'+t+'" class="ingresos_u" type="number" hidden></td>',o+='<td><select id="motivo_I'+t+'" class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input id="motivo_'+t+'" name="motivo_'+t+'" class="ingresos_u" type="number" hidden> </td>',o+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_ingresos").find("tbody").append(o),M(e("#s_programa_"+t),"get_programas_academicos"),e("#anio_"+t).val(a),setTimeout(()=>{e("#s_programa_"+t).val(i)},1e3),e("#motivo_I"+t).val(n),J=t}function P(t){for(var a=[],i=t.find("tbody input").map(function(){return e(this).val()}).get(),n=0;n<i.length;n+=2){var o={nombre:i[n],rol:i[n+1]};a.push(o)}return a}function z(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_ases_user_id",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);null==a?function(e){h=e}(t.id):1==a&&function(e){b=e}(t)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function V(a,i){"deportes"==a?t.displayTags(i,e("#tags_deportes")):t.displayTags(i,e("#tags_tiempo_libre"))}function A(t,a){e("input:radio[name="+t+"]").filter("[value="+a+"]").attr("checked",!0)}function B(t){e("input[name="+t+"]").attr("checked",!0)}function D(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:a,params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);"exist_academics_data"==a?j=t:"exist_health_data"==a?d=t:"exist_discapacity_data"==a&&(l=t)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function I(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:a,params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);x=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function R(t){switch(t){case"solvencia_econo":(a=e("#permanencia .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"ayuda_transporte":(a=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"beca":(a=e("#set-beca .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"participacion":(a=e("#set-participacion .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"condicion":(a=e("#set-salud .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"apoyo_partic":(a=e("#set-apoyo .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"discapacidad":(a=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"identidad_genero":(a=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!1),a.removeClass("otros");break;case"orientacion_sexual":var a;(a=e("#set-orientacion .otro").parent().next()).attr("hidden",!1),a.removeClass("otros")}}function q(t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t,a=JSON.parse(e);t=a.id,f=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function F(t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_program",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t,a=JSON.parse(e);t=a.cod_univalle,y=t},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function M(t,a,i){var n="1";null!=i&&(n=i),e.ajax({type:"POST",data:JSON.stringify({function:a,params:n}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=JSON.parse(e);for(var i in a)t.append("<option value='"+a[i].id+"'>"+Object.values(a[i])[1]+"</option>")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function W(t){e("#"+t).find("input").each(function(){switch(e(this).attr("type")){case"text":case"number":case"date":""!=e(this).val()&&e(this).val("");break;case"radio":let t=e(this).attr("name");e(this).is(":checked")&&e(this).attr("checked",!1),e(this).hasClass("otro")&&function(t){switch(t){case"solvencia_econo":(a=e("#permanencia .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"ayuda_transporte":(a=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"beca":(a=e("#set-beca .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"participacion":(a=e("#set-participacion .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"condicion":(a=e("#set-salud .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"apoyo_partic":(a=e("#set-apoyo .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"discapacidad":(a=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"identidad_genero":(a=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),a.addClass("otros");break;case"orientacion_sexual":var a;(a=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),a.addClass("otros")}}(t);break;case"checkbox":if(e(this).is(":checked")){let t=e(this).attr("name");e("input[name="+t+"]").attr("checked",!1)}case"tel":""!=e(this).val()&&e(this).val("")}}),e("#"+t).find("textarea").each(function(){""!=e(this).val()&&e(this).val("")}),e("#"+t).find("select").each(function(){""!=e(this).val()&&e(this).val(1)})}function X(){var e=[],t=[];return G("regimen_salud",t),$("regimen_salud",t,e),G("data_sisben",t=[]),Z("observ_sisben",t),G("serv_adicionales",t),G("conclusion_jornada",t),Z("conclusion",t),G("json_detalle",t),$("datos_salud_adicionales",t,e),G("serv_usuario",t=[]),$("servicios_usados",t,e),t=[],e}function Y(){var e=[],t=[];return G("percepcion_discapacidad",t),Z("desc_discap",t),$("percepcion_disca",t,e),G("diagnosticos",t=[]),$("diagnosticos",t,e),G("condicion_salud",t=[]),Z("rel_cond_salud",t),$("condicion_salud",t,e),G("medicamentos",t=[]),$("medicamentos",t,e),G("cambio_tratamiento",t=[]),Z("obs_cambio",t),$("cambios_tratamiento",t,e),G("disca_por_municipio",t=[]),Z("doc_localizacion",t),$("discapacidad_municipio",t,e),G("certificado_disca",t=[]),Z("certi_disca",t),$("certificado_discapacidad",t,e),G("datos_invalidez",t=[]),$("certificado_invalidez",t,e),G("cond_org_sist",t=[]),$("condicion_organos",t,e),G("dif_permanente",t=[]),$("dificultad_permanente",t,e),G("set-participacion",t=[]),Z("text_participacion",t),G("set-apoyo",t),Z("text_apoyo_partic",t),$("participacion_estudiantil",t,e),G("asoc_disca",t=[]),$("organizacion_disca",t,e),G("apoyo_recibido",t=[]),$("apoyo_dicapacidad",t,e),t=[],e}function L(){for(var t={},a=e(".select-academics-data").map(function(){return e(this).attr("id")}).get(),i=e(".select-academics-data").map(function(){return e(this).next().attr("id")}).get(),n=0;n<i.length;n++)e("#"+i[n]).val(e("#"+a[n]+" option:selected").val());var o=[],r=[],s=[];G("dif_educ_media",s),G("dif_educ_superior",s),G("dif_educ_paralelo",s),t.key_input="dificultades",t.val_input=s,(s=[]).push(t),t={};var c=[],l=e(".ingresos_u").serializeArray();return G("jornada",l),G("p_ingreso",l),$("datos_academicos_adicionales",l,c),G("div_tipo_institucion",r),G("div_tipo_institucion_superior",r),G("div_tipo_institucion_paralelo",r),t.key_input="otras_instituciones",t.val_input=r,(r=[]).push(t),t={},o.push(c),o.push(r),o.push(s),o}function U(){var e=[],t=[],a=[],i=[],n=[],o=[],r=[],s={},c={},l={},d={};return G("set-sostenimiento",r),G("otro_ingreso",r),$("datos_economicos_adicionales",r,e),G("set-permanencia",e),G("set-beca",e),G("set-materiales",t),G("set-valor-materiales",t),e.push(t),G("set-desplazamiento",t=[]),G("set-valor-desplazamiento",t),e.push(t),G("row_madre_academic",a),G("row_padre_academic",a),G("row_otro_academic",a),G("row_madre_ocupacion",i),G("row_padre_ocupacion",i),G("row_otro_ocupacion",i),G("row_madre_laboral",n),G("row_padre_laboral",n),G("row_otro_laboral",n),Z("motivo_ingreso",o),Z("expecativas_carrera",o),Z("expectativas_graduarse",o),s.key_input="expectativas_laborales",s.val_input=o,l.key_input="ocupacion_padres",l.val_input=i,c.key_input="nivel_educ_padres",c.val_input=a,d.key_input="situa_laboral_padres",d.val_input=n,e.push(c),e.push(l),e.push(d),e.push(s),e}function Z(t,a){json_insert={},null!=e("#"+t).val()&&e("#"+t).val().length>=3&&(json_insert.key_input_text=e("#"+t).attr("id"),json_insert.val_input_text=e("#"+t).val(),a.push(json_insert),json_insert={})}function $(e,t,a){json_insert={},json_insert.key_input=e,json_insert.val_input=t,a.push(json_insert),json_insert={}}function G(t,a){e("#"+t).find("input").each(function(){switch(json_object={},e(this).attr("type")){case"text":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_text=e(this).attr("id"),json_object.val_input_text=e(this).val(),a.push(json_object);break;case"number":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_number=e(this).attr("id"),json_object.val_input_number=e(this).val(),a.push(json_object);break;case"date":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_date=e(this).attr("id"),json_object.val_input_date=e(this).val(),a.push(json_object);break;case"radio":if(""===(t=H(e(this))).id)break;""!=t.id1?(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==t.type&&(json_object.key_input_text=t.id,json_object.val_input_text=t.val,json_object.key_input_number=t.id1,json_object.val_input_number=t.val1),a.push(json_object)):(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==t.type?(json_object.key_input_text=t.id,json_object.val_input_text=t.val):"number"==t.type&&(json_object.key_input_number=t.id,json_object.val_input_number=t.val),a.push(json_object));break;case"checkbox":var t;if(""===(t=H(e(this))).id)break;json_object.key_input=e(this).attr("id"),json_object.val_input="on","text"==t.type?(json_object.key_input_text=t.id,json_object.val_input_text=t.val):"number"==t.type&&(json_object.key_input_number=t.id,json_object.val_input_number=t.val),a.push(json_object);break;default:json_object.key_input=0,json_object.val_input=0}})}function H(e){var t={};if(e.is(":checked")){if(e.hasClass("otro")){var a=e.parent().next().find("input"),i=e.parent().next().children("input:last");return t.id=a.attr("id"),t.val=a.val(),t.type=a.attr("type"),i.attr("id")!=t.id&&(t.id1=i.attr("id"),t.val1=i.val(),t.type1=i.attr("type")),t}return t.id=e.attr("name"),t.val=e.val(),t}return t.id="",t.val="",t}function K(t,a){e("#"+t).find("[name="+a+"]").on("click",function(){var a=e("#"+t+" .otro").parent().next();e(this).hasClass("otro")?(a.attr("hidden",!1),a.removeClass("otros")):(a.attr("hidden",!0),a.addClass("otros"))})}function Q(t,a){e("#"+t).find("[name="+a+"]").on("change",function(){var a=e("#"+t+" .otro").parent().next();e(this).hasClass("otro")&&e(this).prop("checked")?(a.attr("hidden",!1),a.removeClass("otros")):(a.attr("hidden",!0),a.addClass("otros"))})}function ee(e,t){switch(t){case"codigo_estudiantil":case"num_doc_ini":ae(e);break;case"nombre":case"apellido":te(e);break;case"celular_modal":case"tel_res_modal":case"tel_ini":case"tel_acudiente_modal":case"tel_cont_2":case"estrato_modal":case"hijos_modal":case"semestre_actual":case"anio_ingreso":case"puntaje_icfes_modal":ae(e)}}function te(e){for(var t in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" áéíóúabcdefghijklmnñopqrstuvwxyz",especiales=[8,37,39,46],tecla_especial=!1,especiales)if(key==especiales[t]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function ae(e){for(var t in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" 0123456789",especiales=[8,37,39],tecla_especial=!1,especiales)if(key==especiales[t]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function ie(t){var a=!1;return e("."+t+"[required]").each(function(){var t=e(this);if("radio"==t.attr("type")){var i=t.attr("name");if(e('input:radio[name="'+i+'"]').is(":checked")){let t=e(this).prev();e(this).prev().hasClass("alert")&&t.attr("hidden",!0)}else{a=!0,e(this).prev().attr("hidden",!1)}}else if(""==t.val()){a=!0,e(this).next().attr("hidden",!1)}else{let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)}}),a}function ne(t){e("."+t+"[required]:visible").each(function(){let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)})}function oe(){var t=P(e("#table_familia"));G("set-vive",t);var a=JSON.stringify(t),n=e("#hijos_modal").val(),o=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step2",params:[h,o,n,a,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function re(){var t=e("#puntaje_icfes_modal").val(),a=e("#anio_ingreso").val(),i=e("#colegio").val();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step3",params:[h,t,a,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function se(){var t=e("#input_discapacidad").val();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data_user_step4",params:[h,t]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}e("#num_doc_ini").blur(function(){ne("step1"),z(e("#num_doc_ini").val()),e("#step-1 :input").prop("disabled",!1),null!=h?(q(e("#codigo_estudiantil").val()),function(t,a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_exist_user_extended",params:[t,a]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){k=JSON.parse(e)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(h,f),k?(W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),S(),s=!0,z(e("#num_doc_ini").val(),1),function(t){for(var a in t)if(null!=t[a])switch(a){case"vive_con":let l="";if(-1==t[a].indexOf("Array")){let i=(l=JSON.parse(t[a])).find(e=>"vive"===e.key_input);A(i.key_input,i.val_input),e("#table_familia").find("tbody tr").remove();for(let e=0;e<l.length-1;e++){let t=l[e];N(t.nombre,t.rol,e)}}else e("#table_familia").find("tbody tr").remove();break;case"fecha_nac":var n=new Date(t[a]),o="",r="";r=1+n.getMonth()<10?"0"+(1+n.getMonth()):1+n.getMonth(),o=n.getDate()<10?"0"+n.getDate():n.getDate(),e("#fecha_nac_modal").val(n.getFullYear()+"-"+r+"-"+o),E(t[a]);break;case"json_detalle":var s=t[a];s=JSON.parse(s);for(let t=0;t<s.length;t++){const a=s[t];null!=a.key_input_text?e("#"+a.key_input_text).val(a.val_input_text):"sede"==a.key_input_number?(e("#select_sede").val(a.val_input_number),e("#select_sede").trigger("change")):"orientacion_s"==a.key_input_number?(e("#select-orientacion").val(a.val_input_number),e("#select-orientacion").trigger("change")):(e("#acompanamientos").val(a.val_input_number),e("#acompanamientos").trigger("change")),null!=a.key_input&&(B(a.key_input),R(a.key_input))}break;case"actividades_ocio_deporte":var s=t[a];s=JSON.parse(s);for(let e=0;e<s.length;e++){const t=s[e];V(t.name,t.value)}break;case"id_economics_data":null!=(i=t[a])&&(c=!0,w=!0,D(h,"exist_academics_data"),D(h,"exist_health_data"),D(h,"exist_discapacity_data"));break;default:"estrato"==a||"puntaje_icfes"==a||"hijos"==a||"tel_res"==a||"celular"==a||"tel_acudiente"==a||"emailpilos"==a?e("#"+a+"_modal").val(t[a]):(e("#"+a).val(t[a]),e("#"+a).trigger("change"))}p=!1}(b)):(S(),e("#num_doc_ini").val(""),swal("Waarning","No existe relacion entre el numero de documento y el codigo del estudiante, intentalo nuevamente.","warning"))):swal({title:"Warning",text:"Usuario inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal({title:"Confirmado",text:"",type:"success",timer:1500}),e("#step-1 :input").prop("disabled",!1),S()):(swal({title:"Cancelado",text:"Ingresa nuevamente el documento del estudiante",type:"error",timer:1500}),e("#num_doc_ini").val(""))})}),e(".step1").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),p=!0)}),t.bind("keypress",function(e){ee(e,t.attr("id"))})}),e(".step2").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),u=!0)}),t.bind("keypress",function(e){ee(e,t.attr("id"))})}),e(".step3").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),_=!0)}),t.bind("keypress",function(e){ee(e,t.attr("id"))})}),e(".step4").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),v=!0)})}),e(".step5").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),m=!0)})}),e(".step6").each(function(){var t=e(this);t.data("oldVal",t.val()),t.bind("propertychange change input paste",function(e){t.data("oldVal")!=t.val()&&(t.data("oldVal",t.val()),C=!0)})}),e('input[type="radio"]').on("change",function(){e(this).hasClass("step1")?p=!0:e(this).hasClass("step2")?u=!0:e(this).hasClass("step3")?_=!0:e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#codigo_estudiantil").each(function(){var t=e(this);t.bind("keypress",function(e){ee(e,t.attr("id"))})}),e('input[type="checkbox"]').on("change",function(){e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#emailpilos_modal").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEPilos").attr("hidden",!0),e("#successEPilos").attr("hidden",!1),setTimeout(()=>{e("#successEPilos").attr("hidden",!0)},3e3)):(e("#errorEPilos").attr("hidden",!1),e("#successEPilos").attr("hidden",!0))}),e("#emailinstitucional").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEInst").attr("hidden",!0),e("#successEInst").attr("hidden",!1),setTimeout(()=>{e("#successEInst").attr("hidden",!0)},3e3)):(e("#errorEInst").attr("hidden",!1),e("#successEInst").attr("hidden",!0))}),e("#smartwizard").on("leaveStep",function(b,k,C,O,S){if("forward"===O)switch(function(){e("#tipo_doc").val(e("#tipo_doc_ini option:selected").val());for(var t=e(".select-registro").map(function(){return e(this).attr("id")}).get(),a=e(".select-registro").map(function(){return e(this).next().attr("id")}).get(),i=0;i<a.length;i++)e("#"+a[i]).val(e("#"+t[i]+" option:selected").val())}(),C){case 0:if(X=!1,e("."+"step1"+"[required]:visible").each(function(){if(""==e(this).val())X=!0,e(this).next().attr("hidden",!1);else{let t=e(this).next();e(this).next().hasClass("alert")&&t.attr("hidden",!0)}}),X)return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;r&&(F(e("#programa").val()),N=e("#codigo_estudiantil").val(),J=e("#nombre").val(),V=e("#apellido").val(),D=e("#emailinstitucional").val(),M=N+"-"+y,W=(W=J.charAt(0)+N+V.charAt(0)).toUpperCase(),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_mdl_user",params:[M,J,V,D,W]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){f=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),r=!1),s?p&&(z(e("#num_doc_ini").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:t.getArr()}),i.push({name:"actividades",value:a.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=e("#programa").val(),s=[];G("otra_identidad",s),s.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),G("otra_orientacion",s),G("div_contacto_2",s),G("otros_acomp",s),G("sede_div",s),s=JSON.stringify(s),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_data_ases",params:[n,i,r,h,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),p=!1):(q(e("#codigo_estudiantil").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:t.getArr()}),i.push({name:"actividades",value:a.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=P(e("#table_familia")),s=e("#programa").val(),c=[];G("otra_identidad",c),c.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),G("otra_orientacion",c),G("div_contacto_2",c),G("otros_acomp",c),G("sede_div",c),c=JSON.stringify(c),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"save_data",params:[n,i,r,s,f,c]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),s=!0,p=!1),c&&(z(e("#num_doc_ini").val()),I(h,"get_economics_data"),function(t){let a=Object.values(t);for(let t=2;t<a.length;t++){var i=JSON.parse(a[t]);if(null!=i)if(Array.isArray(i))for(let t=0;t<i.length;t++)void 0!==i[t].key_input?(A(i[t].key_input,i[t].val_input),0==i[t].val_input&&(R(i[t].key_input),e("#"+i[t].key_input_text).val(i[t].val_input_text))):e("#"+i[t].key_input_text).val(i[t].val_input_text);else"beca"===i.key_input?(A(i.key_input,i.val_input),0==i.val_input&&(R("beca"),e("#"+i.key_input_text).val(i.val_input_text),e("#"+i.key_input_number).val(i.val_input_number))):A("solvencia_econo",i)}}(x));break;case 1:if(ie("step2"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;c?u&&(oe(),function(){var t=U(),a=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_economics_dt",params:[t,a,h,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),u=!1):(!function(){var t=U(),a=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_economics_data",params:[t,a,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){i=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),oe(),c=!0,u=!1),j&&(z(e("#num_doc_ini").val()),I(h,"get_academics_data"),function(t){for(const a in t)switch(a){case"id":n=t[a];break;case"otras_instituciones":let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)e("#"+i[t].key_input_text).val(i[t].val_input_text),null!=i[t].key_input&&A(i[t].key_input,i[t].val_input);break;case"dificultades":let o=JSON.parse(t[a]);for(let t=0;t<o.length;t++)e("#"+o[t].key_input_text).val(o[t].val_input_text);break;case"datos_academicos_adicionales":let r=JSON.parse(t[a]);e("#table_ingresos").find("tbody").find("tr").remove();for(let t=0;t<r.length;t++)null!=r[t].name&&-1!=r[t].name.indexOf("anio")&&T(t+1,r[t].value,r[t+1].value,r[t+2].value),e("#"+r[t].key_input_text).val(r[t].val_input_text),e("#"+r[t].key_input_date).val(r[t].val_input_date),null!=r[t].key_input&&A(r[t].key_input,r[t].val_input);break;default:"observaciones"==a?e("#"+a+"_modal").val(t[a]):e("#"+a).val(t[a])}}(x),_=!1);break;case 2:if(ie("step3"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;j?_&&(re(),function(){var t=L();z(e("#num_doc_ini").val());var a=e("#programa").val(),i=e("#titulo_1").val(),o=e("#observaciones_modal").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_academics_dt",params:[t,a,i,o,h,n]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),_=!1):(re(),function(){var t=L();z(e("#num_doc_ini").val());var a=e("#programa").val(),i=e("#titulo_1").val(),n=e("#observaciones_modal").val();e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_academics_data",params:[t,a,i,n,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),j=!0,_=!1),l&&(z(e("#num_doc_ini").val()),I(h,"get_discapacity_data"),function(t){for(const a in t){"id"==a&&(o=t[a]);let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)"on"===i[t].val_input?B(i[t].key_input):(A(i[t].key_input,i[t].val_input),0==i[t].val_input&&(R(i[t].key_input),e("#"+i[t].key_input_text).val(i[t].val_input_text))),"doc_localizacion"!==i[t].key_input_text&&"certi_disca"!==i[t].key_input_text&&(e("#"+i[t].key_input_text).val(i[t].val_input_text),e("#"+i[t].key_input_date).val(i[t].val_input_date))}}(x));break;case 3:w?v&&(se(),v=!1):(se(),w=!0,v=!1);break;case 4:l?m&&(!function(){var t=Y();z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"update_discapacity_dt",params:[t,h,o]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal({title:"Cambios actualizados exitosamente!",text:"",type:"success",timer:1500})},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),m=!1):(E=Y(),z(e("#num_doc_ini").val()),e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"insert_disapacity_data",params:[E,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),l=!0,m=!1),d&&(z(e("#num_doc_ini").val()),I(h,"get_health_data"),function(t){for(const a in t)switch(a){case"id":g=t[a];break;case"servicio_salud_vinculado":e("#EPS").val(t[a]);break;default:let i=JSON.parse(t[a]);for(let t=0;t<i.length;t++)"on"===i[t].val_input?B(i[t].key_input):A(i[t].key_input,i[t].val_input),e("#"+i[t].key_input_text).val(i[t].val_input_text),e("#"+i[t].key_input_number).val(i[t].val_input_number),e("#"+i[t].key_input_date).val(i[t].val_input_date)}}(x))}var E,N,J,V,D,M,W,X})})}}});