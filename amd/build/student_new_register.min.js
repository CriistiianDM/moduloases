define(["jquery","block_ases/bootstrap","block_ases/tagging","block_ases/smart_wizard","block_ases/mustache","block_ases/sweetalert"],function(e,a,t,i,n){return{init:function(){e(document).ready(function(){var a,t,i,n,o,r,s,c,l,d,p,u,_,v,m,f="",h="",b="",g="",y="",k="",x=!1,j=!1,w=!1,C=!1;function O(){M(e("#select_programa"),"get_programas_academicos")}function S(){r?e("#step-1 :input").prop("disabled",!1):(e("#nombre").prop("disabled",!0),e("#apellido").prop("disabled",!0),e("#emailinstitucional").prop("disabled",!0)),e("#edad").prop("disabled",!0)}function E(a){var t=new Date,i=new Date(a),n=t.getFullYear()-i.getFullYear(),o=t.getMonth()-i.getMonth();(o<0||0===o&&t.getDate()<i.getDate())&&n--,e("#edad").val(n)}function N(a,t,i){let n="";n+='<tr><td> <input id="nom'+i+'" class="input_fields_general_tab_modal"  type="text"/></td>',n+='<td> <input id="rol'+i+'" class="input_fields_general_tab_modal"  type="text" /></td>',n+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_familia").find("tbody").append(n),e("#nom"+i).val(a),e("#rol"+i).val(t)}e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#pruebas").on("click",function(){}),e("#mostrar").on("click",function(){M(e("#id_ciudad_ini"),"get_ciudades"),M(e("#acompanamientos"),"get_otros_acompañamientos"),M(e("#id_cond_excepcion"),"get_cond_excepcion"),M(e("#id_estado_civil"),"get_estados_civiles"),M(e("#sexo"),"get_sex_options"),M(e("#id_identidad_gen"),"get_generos"),M(e("#id_act_simultanea"),"get_act_simultaneas"),M(e("#id_etnia"),"get_etnias"),M(e("#tipo_doc"),"get_document_types"),M(e("#id_discapacidad"),"get_discapacities"),M(e("#id_pais"),"get_paises"),M(e("#barrio_res"),"get_barrios"),M(e("#id_ciudad_res"),"get_ciudades"),O(),M(e("#id_pais_res"),"get_paises"),M(e("#barrio_ini"),"get_barrios"),M(e("#tipo_doc_ini"),"get_document_types"),M(e("#select_sede"),"get_sedes"),K("permanencia","solvencia_econo"),K("set-desplazamiento","ayuda_transporte"),K("set-certificado-discapacidad","discapacidad"),K("set-apoyo","apoyo_partic"),K("set-participacion","participacion"),K("set-salud","condicion"),Q("set-orientacion","orientacion_sexual"),Q("set-identidad-gen","identidad_genero"),K("set-beca","beca"),(a=new Tagging(e("#deportes_tag"),e("#tags_deportes"),1,3)).createTag(),(t=new Tagging(e("#tiempo_libre"),e("#tags_tiempo_libre"))).createTag(),e("#modalExample").show()}),e(".closer").on("click",function(){e("#modalExample").hide()}),e("#smartwizard").smartWizard({selected:0,theme:"dots",autoAdjustHeight:!0,showStepURLhash:!1,lang:{next:"Continuar y Guardar",previous:"Anterior"}}),e("#limpiar_form").on("click",function(){f="",h="",b="",g="",y="",k="",x=!1,j=!1,w=!1,C=!1,e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#emailpilos_modal").val(""),W("step-1"),W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),e("#select_programa").empty(),O(),ne("step1"),V("deportes",[]),V("actividades",[])}),e("#validar_codigo").on("click",function(){var a,t=e("#codigo_estudiantil").val();ne("step1"),(a=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),a.addClass("otros"),(a=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),a.addClass("otros"),""===t||" "===t?(e("#nombre").val(""),e("#apellido").val(""),e("#emailinstitucional").val(""),e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),O()):e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:t}),url:"../managers/student_profile/studentprofile_api.php",success:function(a){!function(a){0!=a?(e("#step-1 :input").prop("disabled",!0),e("#codigo_estudiantil").prop("disabled",!1),e("#validar_codigo").prop("disabled",!1),e("#limpiar_form").prop("disabled",!1),e("#tipo_doc_ini").prop("disabled",!1),e("#num_doc_ini").prop("disabled",!1),e("#select_sede").prop("disabled",!1),e("#select_programa").prop("disabled",!1),function(a){e("#nombre").val(a.firstname),e("#apellido").val(a.lastname),e("#emailinstitucional").val(a.email),S(),programs=a.username.slice(a.username.indexOf("-")+1),e("#select_programa").empty(),M(e("#select_programa"),"get_programas_academicos_est",programs)}(a),s=!1,r=!1):swal({title:"Warning",text:"Estudiante inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(a){a?(swal("Confirmado","","success"),r=!0,s=!1,W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),S()):(swal("Cancelado","Ingresa nuevamente el codigo del estudiante","error"),e("#codigo_estudiantil").val(""))})}(JSON.parse(a))},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}),e("#fecha_nac_modal").blur(function(){E(e("#fecha_nac_modal").val())}),e(document).on("click",".remove_fila",function(){u=!0,e(this).parent().parent().remove()}),e(document).on("click",".remove_fila_ing",function(){_=!0,J--,e(this).parent().parent().remove()}),e("#add_person_r").on("click",function(){u=!0,function(e){let a="";a+='<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td>',a+='<td> <input  class="input_fields_general_tab_modal"  type="text" /></td>',a+='<td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e.find("tbody").append('<tr><td> <input  class="input_fields_general_tab_modal"  type="text"/></td><td> <input  class="input_fields_general_tab_modal"  type="text" /></td><td> <button class="btn btn-danger remove_fila" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>')}(e("#table_familia"))}),e("#add_ingreso").on("click",function(){_=!0,J++,function(a){let t="";t+='<tr><td> <input id="anio_'+J+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+J+'"  type="text"/></td>',t+='<td> <select id="s_programa_'+J+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+J+'" name="id_programa_'+J+'" class="ingresos_u" type="number" hidden></td>',t+='<td><select class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input  id="motivo_'+J+'" name="motivo_'+J+'" class="ingresos_u" type="number" hidden> </td>',t+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',a.find("tbody").append(t),M(e("#s_programa_"+J),"get_programas_academicos")}(e("#table_ingresos"))}),e(document).on("click","#guardar_info",function(){d?C&&(!function(){var a=X();z(e("#num_doc_ini").val());var t=e("#EPS").val();e.ajax({type:"POST",data:JSON.stringify({function:"update_health_service",params:[a,t,h,g]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=e;a&&swal("Actualizacion completada exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),C=!1):(!function(){var a=X();z(e("#num_doc_ini").val());var t=e("#EPS").val();e.ajax({type:"POST",data:JSON.stringify({function:"insert_health_service",params:[a,t,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=e;isNaN(a)||swal("Registro completado exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),d=!0,C=!1,e("#smartwizard").smartWizard("reset"))});var J=0;function T(a,t,i,n){let o="";o+='<tr><td> <input id="anio_'+a+'" class="input_fields_general_tab_modal ingresos_u step3" name="anio_'+a+'"  type="text"/></td>',o+='<td> <select id="s_programa_'+a+'" class="custom-select select-academics-data step3"></select> <input  id="id_programa_'+a+'" name="id_programa_'+a+'" class="ingresos_u" type="number" hidden></td>',o+='<td><select id="motivo_I'+a+'" class="custom-select select-academics-data step3"> <option value="1">Bajos académicos</option> <option value="2">Condición de salud</option> <option value="3">Fallecimiento</option> <option value="4">Condición económica</option> <option value="5">Condición de programa académico</option> <option value="6">Cambio de institución educativa</option> <option value="7">Cambio de ciudad</option> <option value="8">Retiro voluntario</option> <option value="9">Prefiero no decirlo</option> </select> <input id="motivo_'+a+'" name="motivo_'+a+'" class="ingresos_u" type="number" hidden> </td>',o+='<td> <button class="btn btn-danger remove_fila_ing" type="button" title="Eliminar persona" name="btn_delete_person" style="visibility:visible;"> X </button></td></tr>',e("#table_ingresos").find("tbody").append(o),M(e("#s_programa_"+a),"get_programas_academicos"),e("#anio_"+a).val(t),setTimeout(()=>{e("#s_programa_"+a).val(i)},1e3),e("#motivo_I"+a).val(n),J=a}function P(a){for(var t=[],i=a.find("tbody input").map(function(){return e(this).val()}).get(),n=0;n<i.length;n+=2){var o={nombre:i[n],rol:i[n+1]};t.push(o)}return t}function z(a,t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_ases_user_id",params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=JSON.parse(e);null==t?function(e){h=e}(a.id):1==t&&function(e){b=e}(a)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function V(t,i){"deportes"==t?a.displayTags(i,e("#tags_deportes")):a.displayTags(i,e("#tags_tiempo_libre"))}function A(a,t){e("input:radio[name="+a+"]").filter("[value="+t+"]").attr("checked",!0)}function B(a){e("input[name="+a+"]").attr("checked",!0)}function D(a,t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:t,params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=JSON.parse(e);"exist_academics_data"==t?j=a:"exist_health_data"==t?d=a:"exist_discapacity_data"==t&&(l=a)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function I(a,t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:t,params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a=JSON.parse(e);k=a},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function R(a){switch(a){case"solvencia_econo":(t=e("#permanencia .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"ayuda_transporte":(t=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"beca":(t=e("#set-beca .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"participacion":(t=e("#set-participacion .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"condicion":(t=e("#set-salud .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"apoyo_partic":(t=e("#set-apoyo .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"discapacidad":(t=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"identidad_genero":(t=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!1),t.removeClass("otros");break;case"orientacion_sexual":var t;(t=e("#set-orientacion .otro").parent().next()).attr("hidden",!1),t.removeClass("otros")}}function q(a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_user",params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a,t=JSON.parse(e);a=t.id,f=a},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function F(a){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_program",params:a}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var a,t=JSON.parse(e);a=t.cod_univalle,y=a},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function M(a,t,i){var n="1";null!=i&&(n=i),e.ajax({type:"POST",data:JSON.stringify({function:t,params:n}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){var t=JSON.parse(e);for(var i in t)a.append("<option value='"+t[i].id+"'>"+Object.values(t[i])[1]+"</option>")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function W(a){e("#"+a).find("input").each(function(){switch(e(this).attr("type")){case"text":case"number":case"date":""!=e(this).val()&&e(this).val("");break;case"radio":let a=e(this).attr("name");e(this).is(":checked")&&e("input[name="+a+"]").attr("checked",!1),e(this).hasClass("otro")&&function(a){switch(a){case"solvencia_econo":(t=e("#permanencia .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"ayuda_transporte":(t=e("#set-desplazamiento .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"beca":(t=e("#set-beca .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"participacion":(t=e("#set-participacion .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"condicion":(t=e("#set-salud .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"apoyo_partic":(t=e("#set-apoyo .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"discapacidad":(t=e("#set-certificado-discapacidad .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"identidad_genero":(t=e("#set-identidad-gen .otro").parent().next()).attr("hidden",!0),t.addClass("otros");break;case"orientacion_sexual":var t;(t=e("#set-orientacion .otro").parent().next()).attr("hidden",!0),t.addClass("otros")}}(a);break;case"checkbox":if(e(this).is(":checked")){let a=e(this).attr("name");e("input[name="+a+"]").attr("checked",!1)}case"tel":""!=e(this).val()&&e(this).val("")}}),e("#"+a).find("textarea").each(function(){""!=e(this).val()&&e(this).val("")}),e("#"+a).find("select").each(function(){""!=e(this).val()&&e(this).val(1)})}function X(){var e=[],a=[];return G("regimen_salud",a),$("regimen_salud",a,e),G("data_sisben",a=[]),Z("observ_sisben",a),G("serv_adicionales",a),G("conclusion_jornada",a),Z("conclusion",a),G("json_detalle",a),$("datos_salud_adicionales",a,e),G("serv_usuario",a=[]),$("servicios_usados",a,e),a=[],e}function L(){var e=[],a=[];return G("percepcion_discapacidad",a),Z("desc_discap",a),$("percepcion_disca",a,e),G("diagnosticos",a=[]),$("diagnosticos",a,e),G("condicion_salud",a=[]),Z("rel_cond_salud",a),$("condicion_salud",a,e),G("medicamentos",a=[]),$("medicamentos",a,e),G("cambio_tratamiento",a=[]),Z("obs_cambio",a),$("cambios_tratamiento",a,e),G("disca_por_municipio",a=[]),Z("doc_localizacion",a),$("discapacidad_municipio",a,e),G("certificado_disca",a=[]),Z("certi_disca",a),$("certificado_discapacidad",a,e),G("datos_invalidez",a=[]),$("certificado_invalidez",a,e),G("cond_org_sist",a=[]),$("condicion_organos",a,e),G("dif_permanente",a=[]),$("dificultad_permanente",a,e),G("set-participacion",a=[]),Z("text_participacion",a),G("set-apoyo",a),Z("text_apoyo_partic",a),$("participacion_estudiantil",a,e),G("asoc_disca",a=[]),$("organizacion_disca",a,e),G("apoyo_recibido",a=[]),$("apoyo_dicapacidad",a,e),a=[],e}function U(){for(var a={},t=e(".select-academics-data").map(function(){return e(this).attr("id")}).get(),i=e(".select-academics-data").map(function(){return e(this).next().attr("id")}).get(),n=0;n<i.length;n++)e("#"+i[n]).val(e("#"+t[n]+" option:selected").val());var o=[],r=[],s=[];G("dif_educ_media",s),G("dif_educ_superior",s),G("dif_educ_paralelo",s),a.key_input="dificultades",a.val_input=s,(s=[]).push(a),a={};var c=[],l=e(".ingresos_u").serializeArray();return G("jornada",l),G("p_ingreso",l),$("datos_academicos_adicionales",l,c),G("div_tipo_institucion",r),G("div_tipo_institucion_superior",r),G("div_tipo_institucion_paralelo",r),a.key_input="otras_instituciones",a.val_input=r,(r=[]).push(a),a={},o.push(c),o.push(r),o.push(s),o}function Y(){var e=[],a=[],t=[],i=[],n=[],o=[],r=[],s={},c={},l={},d={};return G("set-sostenimiento",r),G("otro_ingreso",r),$("datos_economicos_adicionales",r,e),G("set-permanencia",e),G("set-beca",e),G("set-materiales",a),G("set-valor-materiales",a),e.push(a),G("set-desplazamiento",a=[]),G("set-valor-desplazamiento",a),e.push(a),G("row_madre_academic",t),G("row_padre_academic",t),G("row_otro_academic",t),G("row_madre_ocupacion",i),G("row_padre_ocupacion",i),G("row_otro_ocupacion",i),G("row_madre_laboral",n),G("row_padre_laboral",n),G("row_otro_laboral",n),Z("motivo_ingreso",o),Z("expecativas_carrera",o),Z("expectativas_graduarse",o),s.key_input="expectativas_laborales",s.val_input=o,l.key_input="ocupacion_padres",l.val_input=i,c.key_input="nivel_educ_padres",c.val_input=t,d.key_input="situa_laboral_padres",d.val_input=n,e.push(c),e.push(l),e.push(d),e.push(s),e}function Z(a,t){json_insert={},e("#"+a).val().length>=3&&(json_insert.key_input_text=e("#"+a).attr("id"),json_insert.val_input_text=e("#"+a).val(),t.push(json_insert),json_insert={})}function $(e,a,t){json_insert={},json_insert.key_input=e,json_insert.val_input=a,t.push(json_insert),json_insert={}}function G(a,t){e("#"+a).find("input").each(function(){switch(json_object={},e(this).attr("type")){case"text":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_text=e(this).attr("id"),json_object.val_input_text=e(this).val(),t.push(json_object);break;case"number":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_number=e(this).attr("id"),json_object.val_input_number=e(this).val(),t.push(json_object);break;case"date":if(e(this).hasClass("otros")||""==e(this).val())break;json_object.key_input_date=e(this).attr("id"),json_object.val_input_date=e(this).val(),t.push(json_object);break;case"radio":if(""===(a=H(e(this))).id)break;""!=a.id1?(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==a.type&&(json_object.key_input_text=a.id,json_object.val_input_text=a.val,json_object.key_input_number=a.id1,json_object.val_input_number=a.val1),t.push(json_object)):(json_object.key_input=e(this).attr("name"),json_object.val_input=e(this).val(),"text"==a.type?(json_object.key_input_text=a.id,json_object.val_input_text=a.val):"number"==a.type&&(json_object.key_input_number=a.id,json_object.val_input_number=a.val),t.push(json_object));break;case"checkbox":var a;if(""===(a=H(e(this))).id)break;json_object.key_input=e(this).attr("id"),json_object.val_input="on","text"==a.type?(json_object.key_input_text=a.id,json_object.val_input_text=a.val):"number"==a.type&&(json_object.key_input_number=a.id,json_object.val_input_number=a.val),t.push(json_object);break;default:json_object.key_input=0,json_object.val_input=0}})}function H(e){var a={};if(e.is(":checked")){if(e.hasClass("otro")){var t=e.parent().next().find("input"),i=e.parent().next().children("input:last");return a.id=t.attr("id"),a.val=t.val(),a.type=t.attr("type"),i.attr("id")!=a.id&&(a.id1=i.attr("id"),a.val1=i.val(),a.type1=i.attr("type")),a}return a.id=e.attr("name"),a.val=e.val(),a}return a.id="",a.val="",a}function K(a,t){e("#"+a).find("[name="+t+"]").on("click",function(){var t=e("#"+a+" .otro").parent().next();e(this).hasClass("otro")?(t.attr("hidden",!1),t.removeClass("otros")):(t.attr("hidden",!0),t.addClass("otros"))})}function Q(a,t){e("#"+a).find("[name="+t+"]").on("change",function(){var t=e("#"+a+" .otro").parent().next();e(this).hasClass("otro")&&e(this).prop("checked")?(t.attr("hidden",!1),t.removeClass("otros")):(t.attr("hidden",!0),t.addClass("otros"))})}function ee(e,a){switch(a){case"codigo_estudiantil":case"num_doc_ini":te(e);break;case"nombre":case"apellido":ae(e);break;case"celular_modal":case"tel_res_modal":case"tel_ini":case"tel_acudiente_modal":case"tel_cont_2":case"estrato_modal":case"hijos_modal":case"semestre_actual":case"anio_ingreso":case"puntaje_icfes_modal":te(e)}}function ae(e){for(var a in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" áéíóúabcdefghijklmnñopqrstuvwxyz",especiales=[8,37,39,46],tecla_especial=!1,especiales)if(key==especiales[a]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function te(e){for(var a in key=e.keyCode||e.which,tecla=String.fromCharCode(key).toLowerCase(),letras=" 0123456789",especiales=[8,37,39],tecla_especial=!1,especiales)if(key==especiales[a]){tecla_especial=!0;break}-1!=letras.indexOf(tecla)||tecla_especial||e.preventDefault()}function ie(a){var t=!1;return e("."+a+"[required]").each(function(){var a=e(this);if("radio"==a.attr("type")){var i=a.attr("name");if(e('input:radio[name="'+i+'"]').is(":checked")){let a=e(this).prev();e(this).prev().hasClass("alert")&&a.attr("hidden",!0)}else{t=!0,e(this).prev().attr("hidden",!1)}}else if(""==a.val()){t=!0,e(this).next().attr("hidden",!1)}else{let a=e(this).next();e(this).next().hasClass("alert")&&a.attr("hidden",!0)}}),t}function ne(a){e("."+a+"[required]:visible").each(function(){let a=e(this).next();e(this).next().hasClass("alert")&&a.attr("hidden",!0)})}function oe(){var a=P(e("#table_familia"));G("set-vive",a);var t=JSON.stringify(a),n=e("#hijos_modal").val(),o=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"save_data_user_step2",params:[h,o,n,t,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function re(){var a=e("#puntaje_icfes_modal").val(),t=e("#anio_ingreso").val(),i=e("#colegio").val();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"save_data_user_step3",params:[h,a,t,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}function se(){var a=e("#input_discapacidad").val();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"save_data_user_step4",params:[h,a]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}e("#num_doc_ini").blur(function(){ne("step1"),z(e("#num_doc_ini").val()),e("#step-1 :input").prop("disabled",!1),null!=h?(q(e("#codigo_estudiantil").val()),function(a,t){e.ajax({async:!1,type:"POST",data:JSON.stringify({function:"get_exist_user_extended",params:[a,t]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){x=JSON.parse(e)},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(h,f),x?(W("step-2"),W("step-3"),W("div_educ_media"),W("step-4"),W("step-5"),W("step-6"),S(),s=!0,z(e("#num_doc_ini").val(),1),function(a){for(var t in a)if(null!=a[t])switch(t){case"vive_con":let l="";if(-1==a[t].indexOf("Array")){let i=(l=JSON.parse(a[t])).find(e=>"vive"===e.key_input);A(i.key_input,i.val_input),e("#table_familia").find("tr").remove();for(let e=0;e<l.length-1;e++){let a=l[e];N(a.nombre,a.rol,e)}}else e("#table_familia").find("tr").remove();break;case"fecha_nac":var n=new Date(a[t]),o="",r="";r=1+n.getMonth()<10?"0"+(1+n.getMonth()):1+n.getMonth(),o=n.getDate()<10?"0"+n.getDate():n.getDate(),e("#fecha_nac_modal").val(n.getFullYear()+"-"+r+"-"+o),E(a[t]);break;case"json_detalle":var s=a[t];s=JSON.parse(s);for(let a=0;a<s.length;a++){const t=s[a];null!=t.key_input_text?e("#"+t.key_input_text).val(t.val_input_text):"sede"==t.key_input_number?e("#select_sede").val(t.val_input_number):"orientacion_s"==t.key_input_number?e("#select-orientacion").val(t.val_input_number):e("#acompanamientos").val(t.val_input_number),null!=t.key_input&&(B(t.key_input),R(t.key_input))}break;case"actividades_ocio_deporte":var s=a[t];s=JSON.parse(s);for(let e=0;e<s.length;e++){const a=s[e];V(a.name,a.value)}break;case"id_economics_data":i=a[t],c=!0,w=!0,D(h,"exist_academics_data"),D(h,"exist_health_data"),D(h,"exist_discapacity_data");break;default:"estrato"==t||"puntaje_icfes"==t||"hijos"==t||"tel_res"==t||"celular"==t||"tel_acudiente"==t||"emailpilos"==t?e("#"+t+"_modal").val(a[t]):e("#"+t).val(a[t])}p=!1}(b)):(S(),e("#num_doc_ini").val(""),swal("Waarning","No existe relacion entre el numero de documento y el codigo del estudiante, intentalo nuevamente.","warning"))):swal({title:"Warning",text:"Usuario inexistente en la base de datos, ¿Esta seguro de registrar este usuario?.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnConfirm:!1,closeOnCancel:!1},function(a){a?(swal("Confirmado","","success"),e("#step-1 :input").prop("disabled",!1),S()):(swal("Cancelado","Ingresa nuevamente el documento del estudiante","error"),e("#num_doc_ini").val(""))})}),e(".step1").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),p=!0)}),a.bind("keypress",function(e){ee(e,a.attr("id"))})}),e(".step2").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),u=!0)}),a.bind("keypress",function(e){ee(e,a.attr("id"))})}),e(".step3").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),_=!0)}),a.bind("keypress",function(e){ee(e,a.attr("id"))})}),e(".step4").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),v=!0)})}),e(".step5").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),m=!0)})}),e(".step6").each(function(){var a=e(this);a.data("oldVal",a.val()),a.bind("propertychange change input paste",function(e){a.data("oldVal")!=a.val()&&(a.data("oldVal",a.val()),C=!0)})}),e('input[type="radio"]').on("change",function(){e(this).hasClass("step1")?p=!0:e(this).hasClass("step2")?u=!0:e(this).hasClass("step3")?_=!0:e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#codigo_estudiantil").each(function(){var a=e(this);a.bind("keypress",function(e){ee(e,a.attr("id"))})}),e('input[type="checkbox"]').on("change",function(){e(this).hasClass("step4")?v=!0:e(this).hasClass("step5")?m=!0:e(this).hasClass("step6")&&(C=!0)}),e("#emailpilos_modal").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEPilos").attr("hidden",!0),e("#successEPilos").attr("hidden",!1),setTimeout(()=>{e("#successEPilos").attr("hidden",!0)},3e3)):(e("#errorEPilos").attr("hidden",!1),e("#successEPilos").attr("hidden",!0))}),e("#emailinstitucional").on("keyup",function(){/([A-Z0-9a-z_-][^@])+?@[^$#<>?]+?\.[\w]{2,4}/.test(this.value)?(e("#errorEInst").attr("hidden",!0),e("#successEInst").attr("hidden",!1),setTimeout(()=>{e("#successEInst").attr("hidden",!0)},3e3)):(e("#errorEInst").attr("hidden",!1),e("#successEInst").attr("hidden",!0))}),e("#smartwizard").on("leaveStep",function(b,x,C,O,S){if("forward"===O)switch(function(){e("#tipo_doc").val(e("#tipo_doc_ini option:selected").val());for(var a=e(".select-registro").map(function(){return e(this).attr("id")}).get(),t=e(".select-registro").map(function(){return e(this).next().attr("id")}).get(),i=0;i<t.length;i++)e("#"+t[i]).val(e("#"+a[i]+" option:selected").val())}(),C){case 0:if(X=!1,e("."+"step1"+"[required]:visible").each(function(){if(""==e(this).val())X=!0,e(this).next().attr("hidden",!1);else{let a=e(this).next();e(this).next().hasClass("alert")&&a.attr("hidden",!0)}}),X)return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;r&&(F(e("#programa").val()),N=e("#codigo_estudiantil").val(),J=e("#nombre").val(),V=e("#apellido").val(),D=e("#emailinstitucional").val(),M=N+"-"+y,W=(W=J.charAt(0)+N+V.charAt(0)).toUpperCase(),e.ajax({type:"POST",data:JSON.stringify({function:"save_mdl_user",params:[M,J,V,D,W]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){f=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),r=!1),s?p&&(z(e("#num_doc_ini").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:a.getArr()}),i.push({name:"actividades",value:t.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=e("#programa").val(),s=[];G("otra_identidad",s),s.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),G("otra_orientacion",s),G("div_contacto_2",s),G("otros_acomp",s),G("sede_div",s),s=JSON.stringify(s),e.ajax({type:"POST",data:JSON.stringify({function:"update_data_ases",params:[n,i,r,h,s]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal("Cambios actualizados exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),p=!1):(q(e("#codigo_estudiantil").val()),function(){e("#num_doc_modal").val(e("#num_doc_ini").val());var i=[];i.push({name:"deportes",value:a.getArr()}),i.push({name:"actividades",value:t.getArr()}),i=JSON.stringify(i);var n=e(".talentospilos_usuario").serializeArray(),o=e("#div_tipo_institucion ").find("[name=estamento]:checked").val();n.push({name:"estamento",value:o}),n.push({name:"id_ciudad_nac",value:e("#id_ciudad_ini").val()});var r=P(e("#table_familia")),s=e("#programa").val(),c=[];G("otra_identidad",c),c.push({key_input_number:"orientacion_s",val_input_number:e("#select-orientacion").val()}),G("otra_orientacion",c),G("div_contacto_2",c),G("otros_acomp",c),G("sede_div",c),c=JSON.stringify(c),e.ajax({type:"POST",data:JSON.stringify({function:"save_data",params:[n,i,r,s,f,c]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),s=!0,p=!1),c&&(z(e("#num_doc_ini").val()),I(h,"get_economics_data"),function(a){let t=Object.values(a);for(let a=2;a<t.length;a++){var i=JSON.parse(t[a]);if(null!=i)if(Array.isArray(i))for(let a=0;a<i.length;a++)void 0!==i[a].key_input?(A(i[a].key_input,i[a].val_input),0==i[a].val_input&&(R(i[a].key_input),e("#"+i[a].key_input_text).val(i[a].val_input_text))):e("#"+i[a].key_input_text).val(i[a].val_input_text);else"beca"===i.key_input?(A(i.key_input,i.val_input),0==i.val_input&&(R("beca"),e("#"+i.key_input_text).val(i.val_input_text),e("#"+i.key_input_number).val(i.val_input_number))):A("solvencia_econo",i)}}(k));break;case 1:if(ie("step2"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;c?u&&(oe(),function(){var a=Y(),t=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"update_economics_dt",params:[a,t,h,i]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal("Cambios actualizados exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),u=!1):(!function(){var a=Y(),t=e("#estrato_modal").val();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"insert_economics_data",params:[a,t,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){i=e},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),oe(),c=!0,u=!1),j&&(z(e("#num_doc_ini").val()),I(h,"get_academics_data"),function(a){for(const t in a)switch(t){case"id":n=a[t];break;case"otras_instituciones":let i=JSON.parse(a[t]);for(let a=0;a<i.length;a++)e("#"+i[a].key_input_text).val(i[a].val_input_text),null!=i[a].key_input&&A(i[a].key_input,i[a].val_input);break;case"dificultades":let o=JSON.parse(a[t]);for(let a=0;a<o.length;a++)e("#"+o[a].key_input_text).val(o[a].val_input_text);break;case"datos_academicos_adicionales":let r=JSON.parse(a[t]);e("#table_ingresos").find("tbody").find("tr").remove();for(let a=0;a<r.length;a++)null!=r[a].name&&-1!=r[a].name.indexOf("anio")&&T(a+1,r[a].value,r[a+1].value,r[a+2].value),e("#"+r[a].key_input_text).val(r[a].val_input_text),e("#"+r[a].key_input_date).val(r[a].val_input_date),null!=r[a].key_input&&A(r[a].key_input,r[a].val_input);break;default:"observaciones"==t?e("#"+t+"_modal").val(a[t]):e("#"+t).val(a[t])}}(k));break;case 2:if(ie("step3"))return swal("Oops!","Rellena todos los campos necesarios para poder avanzar","warning"),!1;j?_&&(re(),function(){var a=U();z(e("#num_doc_ini").val());var t=e("#programa").val(),i=e("#titulo_1").val(),o=e("#observaciones_modal").val();e.ajax({type:"POST",data:JSON.stringify({function:"update_academics_dt",params:[a,t,i,o,h,n]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal("Cambios actualizados exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),_=!1):(re(),function(){var a=U();z(e("#num_doc_ini").val());var t=e("#programa").val(),i=e("#titulo_1").val(),n=e("#observaciones_modal").val();e.ajax({type:"POST",data:JSON.stringify({function:"insert_academics_data",params:[a,t,i,n,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),j=!0,_=!1),l&&(z(e("#num_doc_ini").val()),I(h,"get_discapacity_data"),function(a){for(const t in a){"id"==t&&(o=a[t]);let i=JSON.parse(a[t]);for(let a=0;a<i.length;a++)"on"===i[a].val_input?B(i[a].key_input):(A(i[a].key_input,i[a].val_input),0==i[a].val_input&&(R(i[a].key_input),e("#"+i[a].key_input_text).val(i[a].val_input_text))),"doc_localizacion"!==i[a].key_input_text&&"certi_disca"!==i[a].key_input_text&&(e("#"+i[a].key_input_text).val(i[a].val_input_text),e("#"+i[a].key_input_date).val(i[a].val_input_date))}}(k));break;case 3:w?v&&(se(),v=!1):(se(),w=!0,v=!1);break;case 4:l?m&&(!function(){var a=L();z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"update_discapacity_dt",params:[a,h,o]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){e&&swal("Cambios actualizados exitosamente!","","success")},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}})}(),m=!1):(E=L(),z(e("#num_doc_ini").val()),e.ajax({type:"POST",data:JSON.stringify({function:"insert_disapacity_data",params:[E,h]}),url:"../managers/student_profile/studentprofile_api.php",success:function(e){},error:function(e){swal("Error","Error al comunicarse con el servidor, por favor inténtelo nuevamente.","error")}}),l=!0,m=!1),d&&(z(e("#num_doc_ini").val()),I(h,"get_health_data"),function(a){for(const t in a)switch(t){case"id":g=a[t];break;case"servicio_salud_vinculado":e("#EPS").val(a[t]);break;default:let i=JSON.parse(a[t]);for(let a=0;a<i.length;a++)"on"===i[a].val_input?B(i[a].key_input):A(i[a].key_input,i[a].val_input),e("#"+i[a].key_input_text).val(i[a].val_input_text),e("#"+i[a].key_input_number).val(i[a].val_input_number),e("#"+i[a].key_input_date).val(i[a].val_input_date)}}(k))}var E,N,J,V,D,M,W,X})})}}});