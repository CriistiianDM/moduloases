/**
 * Load grades
 *
 * @module    amd/src/load_grades
 * @author    David Santiago Cortés
 * @copyright 2022 David Santiago Cortés <david.cortes@correounivalle.edu.co>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["jquery","block_ases/sweetalert","block_ases/mustache"],function(a,b,c){return{init:function(){let b=new FormData,c;a("[name='csv_file_loader']").on("change",()=>{b.append("file",a("[name='csv_file_loader']")[0].files[0])}),a("#btn-upload-csv").on("click",()=>{a.ajax({url:"../managers/load_grades/load_grades_api.php",type:"POST",dataType:"json",data:b,processData:!1,contentType:!1,cache:!1,success(b){let e={message:b.message,type:"success"};c=b.data_response,d(e),a("#btn-alertas").removeClass("disabled")},error(a){console.error(a),swal("Oops",a.message,"error")}})}),a("#btn-alertas").on("click",()=>{a.ajax({url:"../managers/load_grades/load_grades_api.php",type:"POST",data:JSON.stringify({function:"send_alerts",params:[c]}),cache:"false",success(b){b=JSON.parse(b);let c={message:b.message,type:"none",students:Object.values(b.data_response)};d(c),a("#btn-alertas").addClass("disabled")},error(a){console.error(a),swal("Oops",a.message,"error")}})})}};function d(b){a.ajax({url:"../templates/load_grades_info_tab.mustache",data:null,dataType:"text",success(d){let e=a(c.render(d,b));a("#div-info").append(e)}})}})