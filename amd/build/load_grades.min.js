/**
 * Load grades
 *
 * @module    amd/src/load_grades
 * @author    David Santiago Cortés
 * @copyright 2022 David Santiago Cortés <david.cortes@correounivalle.edu.co>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["jquery","block_ases/sweetalert","block_ases/mustache","block_ases/loading_indicator"],function($,a,b,c){return{init:function(){$("#btn-alertas").prop("disabled",!0);let a=new URLSearchParams(window.location.search),b=new FormData,e;$("[name='csv_file_loader']").on("change",()=>{b.append("file",$("[name='csv_file_loader']")[0].files[0])}),$("#btn-upload-csv").on("click",()=>{null!==b.get("file")?$.ajax({url:"../managers/load_grades/load_grades_api.php",type:"POST",dataType:"json",data:b,processData:!1,contentType:!1,cache:!1,success(a){let b={message:a.message,type:"success"};e=a.data_response,d(b),$("#btn-alertas").prop("disabled",!1),$("#btn-alertas").removeClass("disabled")},error(a){console.error(a),swal("Oops",a.message,"error")}}):swal("Oops","Olvidaste adjuntar el archivo","error")}),$("#btn-alertas").on("click",()=>{$("#btn-alertas").addClass("disabled"),$("#btn-alertas").prop("disabled",!0),c.show(),$.ajax({url:"../managers/load_grades/load_grades_api.php",type:"POST",data:JSON.stringify({function:"send_alerts",params:[e,a.get("instanceid")]}),cache:"false",success(a){c.hide(),a=JSON.parse(a);let b={message:a.message,type:"success"};d(b)},error(a){console.error(a),swal("Oops",a.message,"error"),c.hide()}})})}};function d(a){$.ajax({url:"../templates/load_grades_info_tab.mustache",data:null,dataType:"text",success(c){let d=$(b.render(c,a));$("#div-info").append(d)}})}})