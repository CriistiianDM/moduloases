{"version":3,"sources":["../src/massmanagement_main.js"],"names":["define","$","init","val","addHelpMessage","on","empty","uploadFile","getUrlParams","query_string","query","document","location","search","substring","vars","split","i","pair","length","urlParameters","formData","FormData","append","instanceid","files","swal","title","text","html","type","confirmButtonColor","controler","ajax","url","data","dataType","cache","contentType","processData","beforeSend","success","msj","warning","error","urlzip","alert","selector"],"mappings":"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","sourcesContent":["/**\n* mass management LOAD\n* @module amd/src/massmanagement_main\n* @author Jhon Lourido \n* @author Isabella Serna Ramírez\n* @author Camilo José Cruz rivera\n* @copyright 2018 - Jhon Lourido <jhonkrave@gmail.com>, Isabella Serna Ramírez <isabella.serna@correounivalle.edu.co>, Camilo José Cruz Rivera <cruz.camilo@correounivalle.edu.co> \n* @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n*/\n\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert'], function ($, bootstrap, sweetalert) {\n\n\n    return {\n        init: function () {\n\n            var val = $('#selector').val();\n            addHelpMessage(val);\n            $('#selector').on('change', function () {\n                var val = $('#selector').val();\n                addHelpMessage(val);\n            });\n\n            $('#boton_subir').on('click', function () {\n                $('#informacion').empty();\n                uploadFile();\n            });\n\n            /**\n             * @method getUrlParams\n             * @desc This function is anonymous, is executed immediately and  the return value is assigned to QueryString!\n             * @param {DOM element} page \n             * @return {query string}\n             */\n            function getUrlParams(page) {\n                //\n                var query_string = [];\n                var query = document.location.search.substring(1);\n                var vars = query.split(\"&\");\n                for (var i = 0; i < vars.length; i++) {\n                    var pair = vars[i].split(\"=\");\n                    query_string[pair[0]] = pair[1];\n                }\n\n                return query_string;\n            }\n\n            /**\n             * @method uploadFile\n             * @desc uploads a specific file depending on a choose on a selector. Change information deployed on a div\n             * @return {void}\n             */\n            function uploadFile() {\n\n                var urlParameters = getUrlParams(document.location.search); //method defined on checkrole\n\n                var formData = new FormData();\n\n                formData.append('idinstancia', urlParameters.instanceid);\n\n                //In case any file were uploaded\n                if ($('#archivo')[0].files[0] == undefined) {\n                    swal({\n                        title: \"Archivo no registrado.\",\n                        text: \"Seleccione el archivo a subir\",\n                        html: true,\n                        type: \"error\",\n                        confirmButtonColor: \"#d51b23\"\n                    });\n                    var val = $('#selector').val();\n                    addHelpMessage(val);\n                    return;\n                }\n\n                formData.append('file', $('#archivo')[0].files[0]);\n\n                var controler = '';\n\n                //The selector has two options, monitor_estud or roles_usuario, depending on selection is redirected to a php file. \n                switch ($('#selector').val()) {\n                    case 'monitor_estud':\n                        controler = 'mrm_monitor_estud.php'; //\n                        break;\n                    case 'roles_usuario':\n                        controler = 'mrm_roles.php'; //\n                        break;\n                    case 'status':\n                        controler = 'mrm_status.php'; //\n                        break;\n                    default:\n                        return 0;\n                }\n\n                $.ajax({\n                    url: '../managers/mass_management/' + controler,\n                    data: formData,\n                    type: 'POST',\n                    dataType: 'json',\n                    cache: false,\n                    // required parameters to upload files\n                    contentType: false,\n                    processData: false,\n                    beforeSend: function () {\n                        $('#response').html(\"<img src='../icon/facebook.gif' />\");\n                    },\n                    success: function (msj) {\n\n                        $('#response').empty();\n\n                        $('#informacion').empty();\n\n                        if (msj.success) {\n                            $('#informacion').append('<div class=\"alert alert-success\"><h4 align=\"center\">Información</h4><strong>Exito!</strong> <br><p>' + msj.success + '</p></div>');\n                        } else if (msj.warning) {\n                            $('#informacion').append('<div class=\"alert alert-warning\"><h4 align=\"center\">Información</h4><strong>Cargado con inconsitencias!</strong> <br>' + msj.warning + '</div>');\n                        } else if (msj.error) {\n                            $('#informacion').append('<div class=\"alert alert-danger\"><h4 align=\"center\">Información</h4><strong>Error!</strong> <br>' + msj.error + '</div>');\n                        }\n\n                        $('#informacion').append(msj.urlzip);\n                    },\n                    error: function (msj) {\n                        alert(\"error ajax\");\n                        $('#response').html(\"\");\n                        var val = $('#selector').val();\n                        addHelpMessage(val);\n                    }\n                    // ... Other options like success and etc\n                });\n\n            }\n\n            /**\n             * @method addHelpMessage\n             * @desc Changes the information deployed on a div depending on the choose on the previous selector\n             * @param {DOM element} selector \n             */\n            function addHelpMessage(selector) {\n                $('#informacion').empty();\n                switch (selector) {\n                    case 'monitor_estud':\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información Asignacion</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username_monitor</li><li>username_estudiante</li> </ul> </p></div>');\n                        break;\n                    case 'roles_usuario':\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información Roles</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username</li><li>rol(administrativo, reportes,profesional_ps, monitor_ps,  estudiante_t ó practicante_psp)</li> </ul> </p><p>Columnas extras aceptadas: <ul> <li>jefe</li>  </ul> </p></div>');\n                        break;\n                    case 'status':\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información estados</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username</li> <li>estado_ases</li> <li>estado_icetex</li> <li>estado_programa</li><li>tracking_status</li> <li>motivo_ases(puede ir en blanco)</li> <li>motivo_icetex(puede ir en blanco)</li> </ul> </p></div>');\n                        break;\n                    default:\n                    // code\n                }\n            }\n\n\n        }\n    };\n});"],"file":"massmanagement_main.min.js"}