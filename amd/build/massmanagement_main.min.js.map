{"version":3,"sources":["../src/massmanagement_main.js"],"names":["define","$","init","val","addHelpMessage","on","empty","uploadFile","getUrlParams","query_string","query","document","location","search","substring","vars","split","i","pair","length","urlParameters","formData","FormData","append","instanceid","files","swal","title","text","html","type","confirmButtonColor","controler","ajax","url","data","dataType","cache","contentType","processData","beforeSend","success","msj","warning","error","urlzip","alert","selector"],"mappings":"AAUAA,OAAM,kCAAC,CAAC,QAAD,CAAW,sBAAX,CAAmC,uBAAnC,CAAD,CAA8D,SAAUC,CAAV,CAAoC,CAGpG,MAAO,CACHC,IAAI,CAAE,eAAY,CAEd,GAAIC,CAAAA,CAAG,CAAGF,CAAC,CAAC,WAAD,CAAD,CAAeE,GAAf,EAAV,CACAC,CAAc,CAACD,CAAD,CAAd,CACAF,CAAC,CAAC,WAAD,CAAD,CAAeI,EAAf,CAAkB,QAAlB,CAA4B,UAAY,CACpC,GAAIF,CAAAA,CAAG,CAAGF,CAAC,CAAC,WAAD,CAAD,CAAeE,GAAf,EAAV,CACAC,CAAc,CAACD,CAAD,CACjB,CAHD,EAKAF,CAAC,CAAC,cAAD,CAAD,CAAkBI,EAAlB,CAAqB,OAArB,CAA8B,UAAY,CACtCJ,CAAC,CAAC,cAAD,CAAD,CAAkBK,KAAlB,GACAC,CAAU,EACb,CAHD,EAWA,QAASC,CAAAA,CAAT,EAA4B,CAKxB,OAHIC,CAAAA,CAAY,CAAG,EAGnB,CAFIC,CAAK,CAAGC,QAAQ,CAACC,QAAT,CAAkBC,MAAlB,CAAyBC,SAAzB,CAAmC,CAAnC,CAEZ,CADIC,CAAI,CAAGL,CAAK,CAACM,KAAN,CAAY,GAAZ,CACX,CAASC,CAAC,CAAG,CAAb,CACQC,CADR,CAAgBD,CAAC,CAAGF,CAAI,CAACI,MAAzB,CAAiCF,CAAC,EAAlC,CAAsC,CAC9BC,CAD8B,CACvBH,CAAI,CAACE,CAAD,CAAJ,CAAQD,KAAR,CAAc,GAAd,CADuB,CAElCP,CAAY,CAACS,CAAI,CAAC,CAAD,CAAL,CAAZ,CAAwBA,CAAI,CAAC,CAAD,CAC/B,CAED,MAAOT,CAAAA,CACV,CAOD,QAASF,CAAAA,CAAT,EAAsB,IAEda,CAAAA,CAAa,CAAGZ,CAAY,CAACG,QAAQ,CAACC,QAAT,CAAkBC,MAAnB,CAFd,CAIdQ,CAAQ,CAAG,GAAIC,CAAAA,QAJD,CAMlBD,CAAQ,CAACE,MAAT,CAAgB,aAAhB,CAA+BH,CAAa,CAACI,UAA7C,EAGA,GAAIvB,CAAC,CAAC,UAAD,CAAD,CAAc,CAAd,EAAiBwB,KAAjB,CAAuB,CAAvB,SAAJ,CAA4C,CACxCC,IAAI,CAAC,CACDC,KAAK,CAAE,wBADN,CAEDC,IAAI,CAAE,+BAFL,CAGDC,IAAI,GAHH,CAIDC,IAAI,CAAE,OAJL,CAKDC,kBAAkB,CAAE,SALnB,CAAD,CAAJ,CAOA,GAAI5B,CAAAA,CAAG,CAAGF,CAAC,CAAC,WAAD,CAAD,CAAeE,GAAf,EAAV,CACAC,CAAc,CAACD,CAAD,CAAd,CACA,MACH,CAEDkB,CAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBtB,CAAC,CAAC,UAAD,CAAD,CAAc,CAAd,EAAiBwB,KAAjB,CAAuB,CAAvB,CAAxB,EAEA,GAAIO,CAAAA,CAAS,CAAG,EAAhB,CAGA,OAAQ/B,CAAC,CAAC,WAAD,CAAD,CAAeE,GAAf,EAAR,EACI,IAAK,eAAL,CACI6B,CAAS,CAAG,uBAAZ,CACA,MACJ,IAAK,eAAL,CACIA,CAAS,CAAG,eAAZ,CACA,MACJ,IAAK,QAAL,CACIA,CAAS,CAAG,gBAAZ,CACA,MACJ,QACI,MAAO,EAAP,CAXR,CAcA/B,CAAC,CAACgC,IAAF,CAAO,CACHC,GAAG,CAAE,+BAAiCF,CADnC,CAEHG,IAAI,CAAEd,CAFH,CAGHS,IAAI,CAAE,MAHH,CAIHM,QAAQ,CAAE,MAJP,CAKHC,KAAK,GALF,CAOHC,WAAW,GAPR,CAQHC,WAAW,GARR,CASHC,UAAU,CAAE,qBAAY,CACpBvC,CAAC,CAAC,WAAD,CAAD,CAAe4B,IAAf,CAAoB,oCAApB,CACH,CAXE,CAYHY,OAAO,CAAE,iBAAUC,CAAV,CAAe,CAEpBzC,CAAC,CAAC,WAAD,CAAD,CAAeK,KAAf,GAEAL,CAAC,CAAC,cAAD,CAAD,CAAkBK,KAAlB,GAEA,GAAIoC,CAAG,CAACD,OAAR,CAAiB,CACbxC,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,6GAAwGmB,CAAG,CAACD,OAA5G,CAAsH,YAA/I,CACH,CAFD,IAEO,IAAIC,CAAG,CAACC,OAAR,CAAiB,CACpB1C,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,+HAA0HmB,CAAG,CAACC,OAA9H,CAAwI,QAAjK,CACH,CAFM,IAEA,IAAID,CAAG,CAACE,KAAR,CAAe,CAClB3C,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,yGAAoGmB,CAAG,CAACE,KAAxG,CAAgH,QAAzI,CACH,CAED3C,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyBmB,CAAG,CAACG,MAA7B,CACH,CA3BE,CA4BHD,KAAK,CAAE,gBAAe,CAClBE,KAAK,CAAC,YAAD,CAAL,CACA7C,CAAC,CAAC,WAAD,CAAD,CAAe4B,IAAf,CAAoB,EAApB,EACA,GAAI1B,CAAAA,CAAG,CAAGF,CAAC,CAAC,WAAD,CAAD,CAAeE,GAAf,EAAV,CACAC,CAAc,CAACD,CAAD,CACjB,CAjCE,CAAP,CAqCH,CAOD,QAASC,CAAAA,CAAT,CAAwB2C,CAAxB,CAAkC,CAC9B9C,CAAC,CAAC,cAAD,CAAD,CAAkBK,KAAlB,GACA,OAAQyC,CAAR,EACI,IAAK,eAAL,CACI9C,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,sOAAzB,EACA,MACJ,IAAK,eAAL,CACItB,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,8VAAzB,EACA,MACJ,IAAK,QAAL,CACItB,CAAC,CAAC,cAAD,CAAD,CAAkBsB,MAAlB,CAAyB,gXAAzB,EACA,MACJ,QAVJ,CAaH,CAGJ,CA9IE,CAgJV,CAnJK,CAAN","sourcesContent":["/**\r\n* mass management LOAD\r\n* @module amd/src/massmanagement_main\r\n* @author Jhon Lourido \r\n* @author Isabella Serna Ramírez\r\n* @author Camilo José Cruz rivera\r\n* @copyright 2018 - Jhon Lourido <jhonkrave@gmail.com>, Isabella Serna Ramírez <isabella.serna@correounivalle.edu.co>, Camilo José Cruz Rivera <cruz.camilo@correounivalle.edu.co> \r\n* @license  http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n*/\r\n\r\ndefine(['jquery', 'block_ases/bootstrap', 'block_ases/sweetalert'], function ($, bootstrap, sweetalert) {\r\n\r\n\r\n    return {\r\n        init: function () {\r\n\r\n            var val = $('#selector').val();\r\n            addHelpMessage(val);\r\n            $('#selector').on('change', function () {\r\n                var val = $('#selector').val();\r\n                addHelpMessage(val);\r\n            });\r\n\r\n            $('#boton_subir').on('click', function () {\r\n                $('#informacion').empty();\r\n                uploadFile();\r\n            });\r\n\r\n            /**\r\n             * @method getUrlParams\r\n             * @desc This function is anonymous, is executed immediately and  the return value is assigned to QueryString!\r\n             * @param {DOM element} page \r\n             * @return {query string}\r\n             */\r\n            function getUrlParams(page) {\r\n                //\r\n                var query_string = [];\r\n                var query = document.location.search.substring(1);\r\n                var vars = query.split(\"&\");\r\n                for (var i = 0; i < vars.length; i++) {\r\n                    var pair = vars[i].split(\"=\");\r\n                    query_string[pair[0]] = pair[1];\r\n                }\r\n\r\n                return query_string;\r\n            }\r\n\r\n            /**\r\n             * @method uploadFile\r\n             * @desc uploads a specific file depending on a choose on a selector. Change information deployed on a div\r\n             * @return {void}\r\n             */\r\n            function uploadFile() {\r\n\r\n                var urlParameters = getUrlParams(document.location.search); //method defined on checkrole\r\n\r\n                var formData = new FormData();\r\n\r\n                formData.append('idinstancia', urlParameters.instanceid);\r\n\r\n                //In case any file were uploaded\r\n                if ($('#archivo')[0].files[0] == undefined) {\r\n                    swal({\r\n                        title: \"Archivo no registrado.\",\r\n                        text: \"Seleccione el archivo a subir\",\r\n                        html: true,\r\n                        type: \"error\",\r\n                        confirmButtonColor: \"#d51b23\"\r\n                    });\r\n                    var val = $('#selector').val();\r\n                    addHelpMessage(val);\r\n                    return;\r\n                }\r\n\r\n                formData.append('file', $('#archivo')[0].files[0]);\r\n\r\n                var controler = '';\r\n\r\n                //The selector has two options, monitor_estud or roles_usuario, depending on selection is redirected to a php file. \r\n                switch ($('#selector').val()) {\r\n                    case 'monitor_estud':\r\n                        controler = 'mrm_monitor_estud.php'; //\r\n                        break;\r\n                    case 'roles_usuario':\r\n                        controler = 'mrm_roles.php'; //\r\n                        break;\r\n                    case 'status':\r\n                        controler = 'mrm_status.php'; //\r\n                        break;\r\n                    default:\r\n                        return 0;\r\n                }\r\n\r\n                $.ajax({\r\n                    url: '../managers/mass_management/' + controler,\r\n                    data: formData,\r\n                    type: 'POST',\r\n                    dataType: 'json',\r\n                    cache: false,\r\n                    // required parameters to upload files\r\n                    contentType: false,\r\n                    processData: false,\r\n                    beforeSend: function () {\r\n                        $('#response').html(\"<img src='../icon/facebook.gif' />\");\r\n                    },\r\n                    success: function (msj) {\r\n\r\n                        $('#response').empty();\r\n\r\n                        $('#informacion').empty();\r\n\r\n                        if (msj.success) {\r\n                            $('#informacion').append('<div class=\"alert alert-success\"><h4 align=\"center\">Información</h4><strong>Exito!</strong> <br><p>' + msj.success + '</p></div>');\r\n                        } else if (msj.warning) {\r\n                            $('#informacion').append('<div class=\"alert alert-warning\"><h4 align=\"center\">Información</h4><strong>Cargado con inconsitencias!</strong> <br>' + msj.warning + '</div>');\r\n                        } else if (msj.error) {\r\n                            $('#informacion').append('<div class=\"alert alert-danger\"><h4 align=\"center\">Información</h4><strong>Error!</strong> <br>' + msj.error + '</div>');\r\n                        }\r\n\r\n                        $('#informacion').append(msj.urlzip);\r\n                    },\r\n                    error: function (msj) {\r\n                        alert(\"error ajax\");\r\n                        $('#response').html(\"\");\r\n                        var val = $('#selector').val();\r\n                        addHelpMessage(val);\r\n                    }\r\n                    // ... Other options like success and etc\r\n                });\r\n\r\n            }\r\n\r\n            /**\r\n             * @method addHelpMessage\r\n             * @desc Changes the information deployed on a div depending on the choose on the previous selector\r\n             * @param {DOM element} selector \r\n             */\r\n            function addHelpMessage(selector) {\r\n                $('#informacion').empty();\r\n                switch (selector) {\r\n                    case 'monitor_estud':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información Asignacion</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username_monitor</li><li>username_estudiante</li> </ul> </p></div>');\r\n                        break;\r\n                    case 'roles_usuario':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información Roles</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username</li><li>rol(administrativo, reportes,profesional_ps, monitor_ps,  estudiante_t ó practicante_psp)</li> </ul> </p><p>Columnas extras aceptadas: <ul> <li>jefe</li>  </ul> </p></div>');\r\n                        break;\r\n                    case 'status':\r\n                        $('#informacion').append('<div class=\"alert alert-info\"><h4 align=\"center\">Información estados</h4><strong>Para tener en cuenta...</strong> <br><p>Columnas obligatorias:<ul> <li>username</li> <li>estado_ases</li> <li>estado_icetex</li> <li>estado_programa</li><li>tracking_status</li> <li>motivo_ases(puede ir en blanco)</li> <li>motivo_icetex(puede ir en blanco)</li> </ul> </p></div>');\r\n                        break;\r\n                    default:\r\n                    // code\r\n                }\r\n            }\r\n\r\n\r\n        }\r\n    };\r\n});"],"file":"massmanagement_main.min.js"}