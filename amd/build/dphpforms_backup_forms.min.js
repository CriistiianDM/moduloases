function _typeof(a){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("block_ases/dphpforms_backup_forms",["jquery","block_ases/jszip","block_ases/jquery.dataTables","block_ases/dataTables.autoFill","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2","block_ases/loading_indicator","block_ases/_general_modal_manager"],function(a,b,c,d,e,f,g,h,j,k,l,m,n,o){return{init:function init(){a(document).on("mousedown",".slider.round",function(){var b=a(this).data("status");if("off"==b){a(this).data("status","on");a("#busqueda-simplificada").hide();a("#busqueda-avanzada").show()}else{a(this).data("status","off");a("#busqueda-avanzada").hide();a("#busqueda-simplificada").show()}});a(document).on("click","#generarFiltroSimplificado",function(){var b=a("#simple_cod_user").val(),c=a("#simple_criteria_select option:selected").val();n.show();a.ajax({type:"POST",data:{loadF:"get_records_simple",username:b,is_student:c},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",cache:!1,async:!0,success:function success(b){n.hide();if(0===b.length){swal("ATTRIBUTE NOT FOUND","Oooops! Zero results","warning")}else{a("#div_table_forms").empty();a("#div_table_forms").append("<table id=\"tableBackupForms\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead><thead></table>");a("#tableBackupForms").DataTable(b);a("#div_table_forms").css("cursor","pointer")}},failure:function failure(){n.hide();alert("No encontrado")}})});a(document).ready(function(){n.show();a.ajax({type:"POST",data:{loadF:"loadForms"},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(b){n.hide();a("#div_table_forms").empty();a("#div_table_forms").append("<table id=\"tableBackupForms\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead><thead></table>");a("#tableBackupForms").DataTable(b);a("#div_table_forms").css("cursor","pointer")},dataType:"json",cache:!1,async:!0,failure:function failure(){n.hide()}});a.ajax({type:"POST",data:{loadF:"loadGeneralLogs"},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(b){a("#div_table_general_logs").empty();a("#div_table_general_logs").append("<table id=\"tableBackupGeneralLogs\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead><thead></table>");a("#tableBackupGeneralLogs").DataTable(b);a("#div_table_general_logs").css("cursor","pointer")},dataType:"json",cache:!1,async:!0,failure:function failure(){}})});a(document).on("click","#tableBackupForms tbody tr td",function(){var b="";b=a(this).parents("tr").find("td:first").html();e("get_form",b)});a(document).on("click","#tableBackupGeneralLogs tbody tr td",function(){var b="";b=a(this).parents("tr").find("td:first").html();e("get_form_general_logs",b)});a("#generarFiltro").on("click",function(){var a=document.getElementById("filtroCodigoUsuario").value,b=document.getElementById("selectTable").value;c(a,b)});a("#load_like").on("click",function(){var a=document.getElementById("typecolumn_select").value,c=document.getElementById("filtroLike").value;b(c,a)});a("#typecolumn_select").on("click",function(){if("datos_previos"==a("#typecolumn_select").val()||"datos_enviados"==a("#typecolumn_select").val()||"datos_almacenados"==a("#typecolumn_select").val()){a("#typekey_select").parent().parent().show()}else{a("#typekey_select").parent().parent().hide()}});a("#typekey_select").on("click",function(){if("datos_enviados"==a("#typecolumn_select").val()){var b="\"id\":\""+a(this).val()+"\",\"valor\":\"MODIFIQUE ESTE VALOR\"";a("#filtroLike").val(b)}if("datos_previos"==a("#typecolumn_select").val()||"datos_almacenados"==a("#typecolumn_select").val()){d(a(this).val())}});a(".dphpforms-restore").on("click",function(){if(!a(this).attr("disabled")&&1==a(this).attr("data-estado")){var b=a(this).attr("data-record-id");g(b)}});a(".dphpforms-compare").on("click",function(){if(!a(this).attr("disabled")){var b,c,d,e,f,g;d=JSON.parse(a("#json_record_dwarehouse_selected").val());e=d.id_usuario_moodle;f=d.accion;g=d.fecha_hora_registro;d.url_request;var l,m="",n;b=d.datos_previos;if(""==b||null==b){l="<div class = \"data_estado_json text_json\"> No hay datos previos </div>"}else{b=b.record;l="<div class=\"data_estado_json text_json\"> Alias formulario:        "+b.alias+"</div>"}c=d.datos_almacenados;if(""==c||null==c){n="<div class = \"data_estado_json text_json\"> No hay datos almacenados </div>"}else{c=c.record;n="<div class=\"data_estado_json text_json\"> Alias formulario:        "+c.alias+"</div>"}m+="<div class=\"contenedor\" >"+l+n+"</div>";if(""!=b&&null!=b&&""!=c&&null!=c){var p=h(b.campos,c.campos);m+=p}else{if(""!=b&&null!=b){m+=j(b.campos)}else if(""!=c&&null!=c){m+=j(c.campos)}}var q="<div class=\"grid_dphpforms_compare\">";q+="<div class=\"general_info_record_dwarehouse\"> ";q+="<div class= \"title_data\">Informaci\xF3n del registro </div>";q+="<div class=\"data_general text_json\">  Realizado por:        "+e+"</div>";q+="<div class=\"data_general text_json\">  Acci\xF3n del registro: <strong style= \"font-size: 18px;\"> "+f+"</strong></div>";q+="<div class=\"data_general text_json\">  Fecha:                "+g+"</div>";q+="<div class=\"url_students data_general text_json\"> </div>";q+="                            </div>";q+="<div class = \"json_data_compare\">";q+="<div class=\"contenedor\" >";q+="<div class=\"title_data text_json\"> Datos previos</div>";q+="<div class=\"title_data text_json\"> Datos almacenados</div>";q+="</div>";q+=m;q+="                                    </div>";q+="</div>";q+="<hr style=\"background-color: red; height: 1px; border: 0\">";o.generate_modal("modal_to_compare","Comparaci\xF3n de estados",q,null,function(){o.show_modal(".modal_to_compare")});k(d.id_registro_respuesta_form,f,d)}});a(".outside").click(function(){var b=a(this);swal({title:"Confirmaci\xF3n de salida",text:"",type:"warning",showCancelButton:!0,confirmButtonText:"Salir"},function(c){if(c){a(b).parent(".mymodal").fadeOut(300);console.log(a(this).parent(".mymodal"))}})});(function(a){a.fn.beautifyJSON=function(b){var c=jQuery.extend({},{type:"strict",hoverable:!0,collapsible:!0,color:!0},b);this.each(function(){if("plain"==c.type){var b=function(a){var b=a.pop();a.push(b);return b},d="&ensp;&ensp;&ensp;",e=[],f="",g=this.innerHTML,h=g.split("\"").map(function(a,b){return b%2?a:a.replace(/\s/g,"")}).join("\""),j="";for(i=0;i<g.length;i++){if("{"==g.charAt(i)){e.push(g.charAt(i));j+=g.charAt(i)+"<br>";f+=d;j+=f}else if("\""==g.charAt(i)&&"\""!=b(e)){j+=g.charAt(i);e.push(g.charAt(i))}else if("["==g.charAt(i)&&"]"==g.charAt(i+1)){e.push(g.charAt(i));j+=g.charAt(i);f+=d}else if("["==g.charAt(i)){e.push(g.charAt(i));j+=g.charAt(i)+"<br>";f+=d;j+=f}else if("]"==g.charAt(i)){f=f.substring(0,f.length-18);j+="<br>"+f;j+=g.charAt(i);e.pop()}else if("}"==g.charAt(i)){f=f.substring(0,f.length-18);j+="<br>"+f+g.charAt(i);e.pop();if(0!=e.length)if("["!=b(e)&&"{"!=b(e)){j+=f}}else if("\""==g.charAt(i)&&"\""==b(e)){j+=g.charAt(i);e.pop()}else if(","==g.charAt(i)&&"\""!=b(e)){j+=g.charAt(i)+"<br>";j+=f}else if("\n"==g.charAt(i)){}else if(!(" "==g.charAt(i)&&"\""!=b(e))){j+=g.charAt(i)}}this.innerHTML=j}else if("flexible"==c.type){var k=function(a){var b=a.pop();a.push(b);return b},e=[],l=[],g=this.innerHTML,j="";if(c.collapsible){var m="<span class='ellipsis'></span><div class='collapser'></div><ul class='array collapsible'>"}else{var m="<div></div><ul class='array'>"}if(c.hoverable){var n="<div class='hoverable'>"}else{var n="<div>"}j+="<div id='json'>";l.push("</div>");for(i=0;i<g.length;i++){if("{"==g.charAt(i)){e.push(g.charAt(i));j+=g.charAt(i);j+=m;l.push("</ul>");j+="<li>"+n;l.push("</div></li>")}else if("\""==g.charAt(i)&&"\""!=k(e)){j+=g.charAt(i);e.push(g.charAt(i))}else if("["==g.charAt(i)&&"]"==g.charAt(i+1)){e.push(g.charAt(i));j+=g.charAt(i);j+=m;l.push("</ul>");j+="<li>"+n;l.push("</div></li>")}else if("["==g.charAt(i)){e.push(g.charAt(i));j+=g.charAt(i);j+=m;l.push("</ul>");j+="<li>"+n;l.push("</div></li>")}else if("]"==g.charAt(i)){j+=l.pop()+l.pop();j+=g.charAt(i);e.pop()}else if("}"==g.charAt(i)){j+=l.pop()+l.pop();j+=g.charAt(i);e.pop();if(0!=e.length)if("["!=k(e)&&"{"!=k(e)){j+=l.pop()}}else if("\""==g.charAt(i)&&"\""==k(e)){j+=g.charAt(i);e.pop()}else if(","==g.charAt(i)&&"\""!=k(e)){j+=g.charAt(i);j+=l.pop();j+="<li>"+n;l.push("</div></li>")}else if("\n"==g.charAt(i)){}else if(!(" "==g.charAt(i)&&"\""!=k(e))){j+=g.charAt(i)}}this.innerHTML=j}else{var o=function(b){a.each(b,function(a,b){if(null==b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-null'>"+b+"</span></div></li>"}else if(b instanceof Array){j+="<li>"+n+"<span class='property'>"+a+"</span>: ["+m;l.push("</li>");l.push("</div>");l.push("</ul>");p(b)}else if("object"==_typeof(b)){j+="<li>"+n+"<span class='property'>"+a+"</span>: {"+q;l.push("</li>");l.push("</div>");l.push("</ul>");o(b)}else{if("number"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-number'>"+b+"</span></div></li>"}else if("string"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-string'>\""+b+"\"</span></div></li>"}else if("boolean"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-boolean'>"+b+"</span></div></li>"}else{j+="<li>"+n+"<span class='property'>"+a+"</span>: "+b+"</div></li>"}}});j+=l.pop()+"}"+l.pop()+l.pop()},p=function(b){a.each(b,function(a,b){if(null==b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-null'>"+b+"</span></div></li>"}else if(b instanceof Array){j+="<li>"+n+"["+m;l.push("</li>");l.push("</div>");l.push("</ul>");p(b)}else if("object"==_typeof(b)){j+="<li>"+n+"{"+q;l.push("</li>");l.push("</div>");l.push("</ul>");o(b)}else{if("number"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-number'>"+b+"</span></div></li>"}else if("string"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-string'>\""+b+"\"</span></div></li>"}else if("boolean"==typeof b){j+="<li>"+n+"<span class='property'>"+a+"</span>: <span class='type-boolean'>"+b+"</span></div></li>"}else{j+="<li>"+n+"<span class='property'>"+a+"</span>: "+b+"</div></li>"}}});j+=l.pop()+"]"+l.pop()+l.pop()},j="",l=[];if(c.collapsible){var m="<span class='ellipsis'></span><div class='collapser'></div><ul class='array collapsible'>",q="<span class='ellipsis'></span><div class='collapser'></div><ul class='obj collapsible'>"}else{var m="<div></div><ul class='array'>",q="<div></div><ul class='obj'>"}if(c.hoverable){var n="<div class='hoverable'>"}else{var n="<div>"}var g=this.innerHTML,r=jQuery.parseJSON(g);j="";j+="<div id='json'>";j+=n+"{"+q;l.push("");l.push("</div>");l.push("</ul>");o(r);j+="</ul></div></div>";this.innerHTML=j}a(".hoverable").hover(function(b){b.stopPropagation();a(".hoverable").removeClass("hovered");a(this).addClass("hovered")},function(b){b.stopPropagation();a(this).addClass("hovered")});a(".collapser").off().click(function(){a(this).parent(".hoverable").toggleClass("collapsed")})})}})(jQuery);function b(b,c){n.show();a.ajax({type:"POST",data:{loadF:"get_like",cadena:b,atributo:c},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(b){n.hide();if(0===b.length){swal("ATTRIBUTE NOT FOUND","Oooops! Zero results","warning")}else{a("#div_table_forms").empty();a("#div_table_forms").append("<table id=\"tableBackupForms\" class=\"display\" cellspacing=\"0\" width=\"100%\"><thead><thead></table>");a("#tableBackupForms").DataTable(b);a("#div_table_forms").css("cursor","pointer")}},cache:!1,async:!0,failure:function failure(){n.hide();alert("No encontrado")}})}function c(b,c){n.show();a.ajax({type:"POST",data:{loadF:"get_id_user",params:[b,c]},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(b){n.hide();if(0===b.length){swal("USER NOT FOUND","Oooops! Incorrect code","warning")}else{a("#div_code_user").empty();a("#div_code_user").append("<strong>Usuario: </strong>"+b[0].cod_user);a("#div_name_user").empty();a("#div_name_user").append(b[0].name_user+" "+b[0].last_name_user)}},cache:!1,async:!0,failure:function failure(){n.hide();alert("No encontrado")}})}function d(b){n.show();a.ajax({type:"POST",data:{loadF:"get_values",params:b},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(b){n.hide();if(0===b.length){swal("QUESTION NOT FOUND","Oooops! Incorrect code","warning")}else{opciones=b[0].options_c;tipo_campo=b[0].tipo_campo;var c="\"respuesta\":\"MODIFIQUE ESTE VALOR\",\"opciones\":\""+opciones+"\",\"tipo_campo\":\""+tipo_campo+"\",\"id_pregunta\":\""+a("#typekey_select").val()+"\"";a("#filtroLike").val(c)}},cache:!1,async:!0,failure:function failure(){n.hide();alert("No encontrado")}})}function e(b,c){n.show();a.ajax({type:"POST",data:{loadF:b,params:c},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",dataType:"json",cache:!1,async:!0,success:function success(a){n.hide();if(""!=a[c].datos_previos){var d=JSON.parse(a[c].datos_previos);if("get_form"==b){a[c].datos_previos=d}if("get_form_general_logs"==b){if(Array.isArray(d)){a[c].datos_previos=d}else{var e=[];for(data in d){var g={};g[data]=d[data];e.push(g)}a[c].datos_previos=e}}}if(""!=a[c].datos_enviados){a[c].datos_enviados=JSON.parse(a[c].datos_enviados)}if(""!=a[c].datos_almacenados){a[c].datos_almacenados=JSON.parse(a[c].datos_almacenados)}f(a)},failure:function failure(){n.hide()}})}function f(b){a("#div_JSONform").empty();var c=JSON.stringify(b);a("#div_JSONform").append(c);a("#div_JSONform").beautifyJSON({type:"flexible",hoverable:!0,collapsible:!0,color:!0});var d=Object.keys(b)[0],e=b[d];a("#json_record_dwarehouse_selected").attr("value",JSON.stringify(e));if(-1!=e.id_registro_respuesta_form){if("DELETE"==e.accion){a(".dphpforms-peer-record").attr("data-record-id",e.id_registro_respuesta_form);a(".dphpforms-restore").attr("data-record-id",d);a(".dphpforms-restore").attr("data-estado",1);a(".dphpforms-peer-record").attr("disabled",!1);a(".dphpforms-restore").attr("disabled",!1);a(".dphpforms-compare").attr("disabled",!1);a(".dphpforms-peer-record").hide();a(".dphpforms-restore").show();a(".dphpforms-compare").show()}else if("INSERT"==e.accion||"UPDATE"==e.accion||"RESTORE"==e.accion){a(".dphpforms-peer-record").attr("data-record-id",e.id_registro_respuesta_form);a(".dphpforms-peer-record").attr("disabled",!1);a(".dphpforms-restore").attr("disabled",!0);a(".dphpforms-compare").attr("disabled",!1);a(".dphpforms-peer-record").hide();a(".dphpforms-restore").show();a(".dphpforms-compare").show()}else{a(".dphpforms-peer-record").attr("disabled",!0);a(".dphpforms-restore").attr("disabled",!0);a(".dphpforms-compare").attr("disabled",!0);a(".dphpforms-peer-record").hide();a(".dphpforms-restore").hide();a(".dphpforms-compare").hide()}}else{a(".dphpforms-peer-record").attr("disabled",!0);a(".dphpforms-restore").attr("disabled",!0);a(".dphpforms-compare").attr("disabled",!0);a(".dphpforms-peer-record").hide();a(".dphpforms-restore").hide();a(".dphpforms-compare").hide()}a("#modal_JSON").fadeIn(300)}function g(b){n.show();a.ajax({type:"POST",data:{loadF:"restore_dwarehouse_record",params:b},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",success:function success(a){n.hide();if(!a){swal("NOT RESTORED SUCCESSFULLY","Oooops! Error","warning")}else{swal("RESTORED SUCCESSFULLY","SUCCESS","success")}},cache:!1,async:!0,error:function error(){n.hide();swal("SYSTEM ERROR","Report to Systems office","error")}})}function h(a,b){var c,d,e,f,g;g="";e=a.length;c="";d="";for(campo_b in b){f=0;for(campo_a in a){f++;if(b[campo_b].local_alias==a[campo_a].local_alias){if(b[campo_b].respuesta==a[campo_a].respuesta){d+="<div data-id-pregunta="+a[campo_a].id_pregunta+" data-id-relacion-form-pregunta="+a[campo_a].id_relacion_form_pregunta+"  class=\"data_estado_json data_estado_json_similar\" style=\"border: 1px solid green !important;\">  <div class = \"text_json\">Alias: "+a[campo_a].local_alias+"  </div> ";d+="<div class = \"text_json\">Respuesta: "+a[campo_a].respuesta+"  </div> </div>";c+="<div data-id-pregunta="+b[campo_b].id_pregunta+" data-id-relacion-form-pregunta="+b[campo_b].id_relacion_form_pregunta+" class=\"data_estado_json data_estado_json_similar\" style=\"border: 1px solid green !important;\">  <div class = \"text_json\">Alias: "+b[campo_b].local_alias+"  </div> ";c+="<div class = \"text_json\">Respuesta: "+b[campo_b].respuesta+"  </div> </div>"}else{d+="<div data-id-pregunta="+a[campo_a].id_pregunta+" data-id-relacion-form-pregunta="+a[campo_a].id_relacion_form_pregunta+"  class=\"data_estado_json data_estado_json_different\" style=\"border: 1px solid red !important;\">  <div class = \"text_json\" >Alias: "+a[campo_a].local_alias+"  </div> ";d+="<div class = \"text_json data_estado_json_different\" >Respuesta: "+a[campo_a].respuesta+"  </div> </div>";c+="<div  data-id-pregunta="+b[campo_b].id_pregunta+" data-id-relacion-form-pregunta="+b[campo_b].id_relacion_form_pregunta+" class=\"data_estado_json data_estado_json_different\" style=\"border: 1px solid red !important;\">  <div class = \"text_json\" >Alias: "+b[campo_b].local_alias+"  </div> ";c+="<div class = \"text_json data_estado_json_different\">Respuesta: "+b[campo_b].respuesta+"  </div> </div>"}break}else if(f==e){d+="<div data-id-pregunta="+b[campo_b].id_pregunta+" data-id-relacion-form-pregunta="+b[campo_b].id_relacion_form_pregunta+"  class=\"data_estado_json data_estado_json_different\" style=\"border: 1px solid red !important;\">  <div class = \"text_json\" >Alias: No registra en esta versi\xF3n</div> ";d+="<div  class = \"text_json\">Respuesta: No registra en esta versi\xF3n</div> </div>";c+="<div  data-id-pregunta="+b[campo_b].id_pregunta+" data-id-relacion-form-pregunta="+b[campo_b].id_relacion_form_pregunta+" class=\"data_estado_json data_estado_json_different\" style=\"border: 1px solid red !important;\">  <div class = \"text_json\">Alias: "+b[campo_b].local_alias+"  </div> ";c+="<div  class = \"text_json\">Respuesta: "+b[campo_b].respuesta+"  </div> </div>"}}g+="<div class=\"contenedor\" >"+d+c+"</div>";d="";c=""}return g}function j(a){var b="";for(campo in a){b+="<div class=\"contenedor\" >";b+="<div data-id-pregunta="+a[campo].id_pregunta+" data-id-relacion-form-pregunta="+a[campo].id_relacion_form_pregunta+"  class=\"data_estado_json data_estado_json_different\" style=\"border: 1px solid red !important;\">  <div >Alias: No registra en esta versi\xF3n</div> ";b+="<div>Respuesta: No registra en esta versi\xF3n</div> </div>";b+="<div data-id-pregunta="+a[campo].id_pregunta+" data-id-relacion-form-pregunta="+a[campo].id_relacion_form_pregunta+"  class=\"data_estado_json data_estado_json_similar\" style=\"border: 1px solid green !important;\">  <div>Alias: "+a[campo].local_alias+"  </div> ";b+="<div>Respuesta: "+a[campo].respuesta+"  </div> </div>";b+="</div>"}return b}function k(b,c,d){var e=[b,c,JSON.stringify(d)];a.ajax({type:"POST",data:{loadF:"get_student_code_to_url",params:e},url:"../managers/dphpforms/dphpforms_dwarehouse_api.php",cache:!1,success:function success(b){var c="",d,e,f,g,h,j;if(0===b.length){c="<strong>Enlace(s) no disponible(s)</strong>";a(".url_students").empty();a(".url_students").append(c)}else{for(student_data in b){f=b[student_data];j=Object.keys(f)[0];d=f[j].username;e=f[j].firstname+" "+f[j].lastname;g=f[j].courseid;h=f[j].instanceid;var k=void 0;k="student_profile.php?courseid="+g+"&instanceid="+h+"&student_code="+d;c+="<div> Estudiante: <a href=\""+k+"\"  target=\"_blank\" ><strong>"+e+" "+d+"</strong></a></div>"}a(".url_students").empty();a(".url_students").append(c)}},error:function error(){swal("TYPE FORM NOT FOUND","Oooops! Is not a valid form to create url","warning")}})}a(".mymodal-close").click(function(){a("#modal_JSON").hide()});a(".btn-danger-close").click(function(){a("#modal_JSON").hide()})}}});
//# sourceMappingURL=dphpforms_backup_forms.min.js.map
