define(["jquery","block_ases/jszip","block_ases/pdfmake","block_ases/jquery.dataTables","block_ases/dataTables.autoFill","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/bootstrap","block_ases/sweetalert"],function(t,e,a,s,n,i,l,o,r,c,d){return{init:function(){window.JSZip=e,t("#send_form_btn").on("click",function(){var e,a;(e=t("#form_general_report").serializeArray()).push({name:"instance_id",value:u()}),t("#div_table").html('<img class="icon-loading" src="../icon/loading.gif"/>'),t.ajax({type:"POST",data:e,url:"../managers/ases_report/asesreport_server_processing.php",success:function(e){t("#div_table").html(""),t("#div_table").fadeIn(1e3).append('<table id="tableResult" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),t("#tableResult").DataTable(e),t("#tableResult tr").each(function(){t.each(this.cells,function(){"Bajo"==t(this).html()?t(this).addClass("bajo"):"Medio"==t(this).html()?t(this).addClass("medio"):"Alto"==t(this).html()&&t(this).addClass("alto")})}),t("#tableResult").bind("DOMSubtreeModified",function(){t("#tableResult tr").each(function(){t.each(this.cells,function(){"bajo"==t(this).html()?t(this).addClass("bajo"):"medio"==t(this).html()?t(this).addClass("medio"):"alto"==t(this).html()&&t(this).addClass("alto")})})})},dataType:"json",cache:"false",error:function(t){alert("Error al conectar con el servidor")}}),(a=t("#form_general_report").serializeArray()).push({name:"instance_id",value:u()}),t("#not_assigned_students").html('<img class="icon-loading" src="../icon/loading.gif"/>'),t.ajax({type:"POST",data:a,url:"../managers/ases_report/load_not_assigned_students.php",success:function(e){t("#not_assigned_students").html(""),t("#not_assigned_students").fadeIn(1e3).append('<table id="tableAssign" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),t("#tableAssign").DataTable(e)},dataType:"json",cache:"false",error:function(t){alert("Error al cargar estudiantes no asignados")}})}),t(document).on("click","#tableAssign tbody tr td #student_assign",function(){var e=t("#tableAssign").DataTable().row(t(this).parents("tr")).data(),a=u(),s=e.username,n=t(this).closest("tr").find("#monitors").val(),i=t(this).closest("tr").find("#practicants").val(),l=!0,o="";"-1"==n&&(l=!1,o+="* Debe elegir monitor a asignar \n"),"-1"==i&&(l=!1,o+="*Debe elegir practicantes a asignar"),l?t.ajax({type:"POST",data:{type:"assign_student",monitor:n,practicant:i,instance:a,student:s},url:"../managers/ases_report/asesreport.php",success:function(t){alert(t)},dataType:"text",cache:"false",error:function(t){console.log("Error al asignar estudiantes"+t)}}):alert(o)}),t(document).on("click","#tableResult tbody tr td",function(){var e=t("#tableResult").DataTable();e.cell(this).index().column<=2&&(t("#formulario").each(function(){this.reset}),location.href="student_profile.php"+location.search+"&student_code="+e.cell(e.row(this).index(),0).data())}),t(document).on("click","#tableAssign tbody tr td",function(){var e=t("#tableAssign").DataTable();e.cell(this).index().column<=2&&(t("#formulario").each(function(){this.reset}),location.href="student_profile.php"+location.search+"&student_code="+e.cell(e.row(this).index(),0).data())}),t(document).on("change","#tableResult thead tr th select",function(){var e=t("#tableResult").DataTable(),a=t(this).parent().index()+1;t(this).parent().find(":selected").text();e.columns(a-1).search(this.value).draw()}),t(document).on("change","#tableAssign tbody tr td select#practicants",function(){var e=t(this).val(),a=u();t.ajax({type:"POST",data:{user:e,instance:a,source:"list_monitors"},url:"../managers/ases_report/asesreport.php",success:function(e){t("select#monitors").find("option").remove().end(),t("select#monitors").append(e)},dataType:"json",cache:"false",error:function(t){alert("Error al cargar monitores con practicante seleccionado")}})})},load_defaults_students:function(e){t("#div_table").html(""),t("#div_table").fadeIn(1e3).append('<table id="tableResult" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),t("#tableResult").DataTable(e)},create_table:function(){},get_id_instance:function(){var t=location.search.split("&");for(x in t){if(t[x].indexOf("instanceid")>=0)return t[x].split("=")[1]}return 0}};function u(){var t=location.search.split("&");for(x in t){if(t[x].indexOf("instanceid")>=0)return t[x].split("=")[1]}return 0}});