define(['jquery','block_ases/jszip','block_ases/pdfmake','block_ases/jquery.dataTables','block_ases/dataTables.autoFill','block_ases/dataTables.buttons','block_ases/buttons.html5','block_ases/buttons.flash','block_ases/buttons.print','block_ases/bootstrap','block_ases/sweetalert2'],function(a,b){function l(){m();var o=a('#conditions').val();'TODOS'==o?(a('#div-summary-spp').prop('hidden',!1),a('#div-summary-spe').prop('hidden',!1),a('#div-summary-3740').prop('hidden',!1),a('#div-summary-oa').prop('hidden',!1)):'TODOS-SPP'==o||'SPP'==o.substring(0,3)?(a('#div-summary-spp').prop('hidden',!1),a('#div-summary-spe').prop('hidden',!0),a('#div-summary-3740').prop('hidden',!0),a('#div-summary-oa').prop('hidden',!0)):'TODOS-SPE'==o||'SPE'==o.substring(0,3)?(a('#div-summary-spp').prop('hidden',!0),a('#div-summary-spe').prop('hidden',!1),a('#div-summary-3740').prop('hidden',!0),a('#div-summary-oa').prop('hidden',!0)):'TODOS-3740'==o||'3740'==o.substring(0,4)?(a('#div-summary-spp').prop('hidden',!0),a('#div-summary-spe').prop('hidden',!0),a('#div-summary-3740').prop('hidden',!1),a('#div-summary-oa').prop('hidden',!0)):'TODOS-OTROS'==o&&(a('#div-summary-spp').prop('hidden',!0),a('#div-summary-spe').prop('hidden',!0),a('#div-summary-3740').prop('hidden',!0),a('#div-summary-oa').prop('hidden',!1))}function m(){var o=a('#form_general_report').serializeArray();o.push({name:'instance_id',value:n()}),a('#div_table').html('<img class="icon-loading" src="../icon/loading.gif"/>'),a.ajax({type:'POST',data:o,url:'../managers/ases_report/asesreport_server_processing.php',success:function success(p){a('#div_table').html(''),a('#div_table').fadeIn(1e3).append('<table id="tableResult" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),a('#tableResult').DataTable(p),a('#tableResult tr').each(function(){a.each(this.cells,function(){'Bajo'==a(this).html()?a(this).addClass('riesgo_bajo'):'Medio'==a(this).html()?a(this).addClass('riesgo_medio'):'Alto'==a(this).html()&&a(this).addClass('riesgo_alto')})}),a('#tableResult').bind('DOMSubtreeModified',function(){a('#tableResult tr').each(function(){a.each(this.cells,function(){'Bajo'==a(this).html()?a(this).addClass('riesgo_bajo'):'Medio'==a(this).html()?a(this).addClass('riesgo_medio'):'Alto'==a(this).html()&&a(this).addClass('riesgo_alto')})})})},dataType:'json',cache:'false',error:function error(){alert('Error al conectar con el servidor')}})}function n(){var o=location.search.split('&');for(x in o)if(0<=o[x].indexOf('instanceid')){var p=o[x].split('=');return p[1]}return 0}return{init:function init(){window.JSZip=b,a(document).on('click','#tableResult tbody tr td',function(){var p=a('#tableResult').DataTable(),q=p.cell(this).index().column;2>=q&&(a('#formulario').each(function(){this.reset}),location.href='student_profile.php'+location.search+'&student_code='+p.cell(p.row(this).index(),0).data())}),a('#contact_fields_check').on('change',function(){a('#contact_fields_check').prop('checked')?a('#contact_fields input[type=\'checkbox\']').prop('checked',!0):a('#contact_fields input[type=\'checkbox\']').prop('checked',!1),l()}),a('#status_fields_check').on('change',function(){a('#status_fields_check').prop('checked')?a('input[name=\'status_fields[]\']').prop('checked',!0):a('input[name=\'status_fields[]\']').prop('checked',!1),l()}),a('#academic_fields_check').on('change',function(){a('#academic_fields_check').prop('checked')?a('input[name=\'academic_fields[]\']').prop('checked',!0):a('input[name=\'academic_fields[]\']').prop('checked',!1),l()}),a('#risk_fields_check').on('change',function(){a('#risk_fields_check').prop('checked')?a('input[name=\'risk_fields[]\']').prop('checked',!0):a('input[name=\'risk_fields[]\']').prop('checked',!1),l()}),a('#assignment_fields_check').on('change',function(){a('#assignment_fields_check').prop('checked')?a('input[name=\'assignment_fields[]\']').prop('checked',!0):a('input[name=\'assignment_fields[]\']').prop('checked',!1),l()}),a('#conditions').on('change',function(){l()}),a('#contact_fields input[type=\'checkbox\']').on('change',function(){l()}),a('input[name=\'status_fields[]\']').on('change',function(){l()}),a('input[name=\'academic_fields[]\']').on('change',function(){l()}),a('input[name=\'risk_fields[]\']').on('change',function(){l()}),a('input[name=\'assignment_fields[]\']').on('change',function(){l()}),a(document).on('change','.select_risk',function(){var o=a('#tableResult').DataTable(),p=a(this).parent().index()+1,q=a(this).parent().find(':selected').text();o.columns(p-1).search(this.value).draw()}),a(document).on('change','.filter_assignments',function(){var o=a('#tableResult').DataTable(),p=a(this).parent().index()+1,q=a(this).parent().find(':selected').text();o.columns(p-1).search(this.value).draw()}),a(document).on('change','.select_filter_statuses',function(){var o=a('#tableResult').DataTable(),p=a(this).parent().index()+1,q=a(this).parent().find(':selected').text();o.columns(p-1).search(q?'^'+q+'$':'',!0,!1).draw()}),a(document).on('click','.summary-title',function(){var o=a(a(this).data('icon'));o.hasClass('glyphicon-chevron-right')?(o.removeClass('glyphicon-chevron-right'),o.addClass('glyphicon-chevron-down')):(o.addClass('glyphicon-chevron-right'),o.removeClass('glyphicon-chevron-down'));var p=a(a(this).data('target'));'none'==p.css('display')?p.show(300):p.hide(300)}),a('.panel-heading-summary').on('click',function(){var o=a(this).find('.icon-group-cohort');o.hasClass('glyphicon-chevron-right')?(o.removeClass('glyphicon-chevron-right'),o.addClass('glyphicon-chevron-down')):(o.addClass('glyphicon-chevron-right'),o.removeClass('glyphicon-chevron-down'));var p=a(a(this).data('target'));'none'==p.css('display')?p.show(300):p.hide(300)})},load_defaults_students:function load_defaults_students(o){a('#div_table').html(''),a('#div_table').fadeIn(1e3).append('<table id="tableResult" class="stripe row-border order-column" cellspacing="0" width="100%"><thead> </thead></table>'),a('#tableResult').DataTable(o)},create_table:function create_table(){},get_id_instance:function get_id_instance(){var o=location.search.split('&');for(x in o)if(0<=o[x].indexOf('instanceid')){var p=o[x].split('=');return p[1]}return 0}}});