{"version":3,"sources":["../src/mon_trackings.js"],"names":["define","$","mustache","loading_indicator","init","dataInit","moodleID","instanceID","on","length","remove","periodID","val","trackingsCount","document","ajaxStart","show","ajaxStop","hide","ajax","type","dataType","data","JSON","stringify","url","cache","success","msg","result","status_code","async","template","divToAppend","render","data_response","append","error","console","log","swal"],"mappings":"AASAA,OAAM,4BAAC,CAAC,QAAD,CACC,qBADD,CAEC,8BAFD,CAAD,CAEmC,SAASC,CAAT,CAAYC,CAAZ,CAAsBC,CAAtB,CAAwC,CAE7E,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAmB,IAKjBC,CAAAA,CAAQ,CAAGD,CAAQ,CAAC,CAAD,CALF,CAMjBE,CAAU,CAAGF,CAAQ,CAAC,CAAD,CANJ,CAQrBJ,CAAC,CAAC,sBAAD,CAAD,CAA0BO,EAA1B,CAA6B,OAA7B,CAAsC,UAAY,CAC9C,GAAKP,CAAC,CAAC,kBAAD,CAAD,CAAsBQ,MAA3B,CAAoC,CAChCR,CAAC,CAAC,kBAAD,CAAD,CAAsBS,MAAtB,EACH,CAED,GAAIC,CAAAA,CAAQ,CAAGV,CAAC,CAAC,iBAAD,CAAD,CAAqBW,GAArB,EAAf,CACAC,CAAc,CAACP,CAAD,CAAWC,CAAX,CAAuBI,CAAvB,CACjB,CAPD,EASAV,CAAC,CAAEa,QAAF,CAAD,CAAcC,SAAd,CAAwB,UAAW,CAC/BZ,CAAiB,CAACa,IAAlB,EACH,CAFD,EAEGC,QAFH,CAEY,UAAW,CACnBd,CAAiB,CAACe,IAAlB,EACH,CAJD,CAKH,CAvBE,CAAP,CA0BA,QAASL,CAAAA,CAAT,CAAwBP,CAAxB,CAAkCC,CAAlC,CAA8CI,CAA9C,CAAwD,CAEpDV,CAAC,CAACkB,IAAF,CAAO,CACHC,IAAI,CAAE,MADH,CAEHC,QAAQ,CAAE,MAFP,CAGHC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjB,SAAY,gBADK,CAEjB,OAAU,CAAClB,CAAD,CAAWC,CAAX,CAAuBI,CAAvB,CAFO,CAAf,CAHH,CAOHc,GAAG,CAAE,qDAPF,CAQHC,KAAK,CAAE,OARJ,CASHC,OAAO,CAAE,iBAAUC,CAAV,CAAe,CACpB,GAAIC,CAAAA,CAAM,CAAGD,CAAb,CACA,GAA2B,CAAvB,GAAAC,CAAM,CAACC,WAAX,CAA8B,CAC1B7B,CAAC,CAACkB,IAAF,CAAO,CACHM,GAAG,CAAE,2CADF,CAEHH,IAAI,CAAE,IAFH,CAGHD,QAAQ,CAAE,MAHP,CAIHK,KAAK,CAAE,OAJJ,CAKHK,KAAK,CAAE,OALJ,CAMHJ,OAAO,CAAE,iBAAUK,CAAV,CAAoB,CACzB,GAAIC,CAAAA,CAAW,CAAGhC,CAAC,CAACC,CAAQ,CAACgC,MAAT,CAAgBF,CAAhB,CAA0BH,CAAM,CAACM,aAAjC,CAAD,CAAnB,CACAlC,CAAC,CAAC,0BAAD,CAAD,CAA8BmC,MAA9B,CAAqCH,CAArC,CACH,CATE,CAUHI,KAAK,CAAE,gBAAW,CACdC,OAAO,CAACC,GAAR,CAAY,wBAAZ,CACH,CAZE,CAAP,CAcH,CAfD,IAgBK,CACDD,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBX,CAArB,CACH,CACJ,CA9BE,CA+BHS,KAAK,CAAE,eAAUT,CAAV,CAAe,CACnBU,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBX,CAArB,EACCY,IAAI,CACA,OADA,CAEA,0EAFA,CAGA,OAHA,CAKP,CAtCE,CAAP,CAyCH,CACJ,CA1EK,CAAN","sourcesContent":["/**\n * Trackings tab belonging to the monitor's profile.\n *\n * @module block_ases/mon_trackings\n * @author David Santiago Cortés\n * @copyright 2020 David S. Cortés <david.cortes@correounivalle.edu.co>\n * @license GNU GPL v3 or later\n */\n\ndefine(['jquery', \n        'block_ases/mustache',\n        'block_ases/loading_indicator'], function($, mustache, loading_indicator){\n\n    return {\n        init: function(dataInit) {\n            //$('#select-periods').on('click', function () {\n            //    $(\"#btn-consulta-fichas\").removeAttr('hidden');\n            //})\n            \n            var moodleID = dataInit[0];\n            var instanceID = dataInit[1];\n\n            $(\"#btn-consulta-fichas\").on('click', function () {\n                if ( $(\"#total-count-row\").length ) {\n                    $(\"#total-count-row\").remove();\n                }\n\n                let periodID = $(\"#select-periods\").val();\n                trackingsCount(moodleID, instanceID, periodID);\n            });\n\n            $( document ).ajaxStart(function() {\n                loading_indicator.show();\n            }).ajaxStop(function() {\n                loading_indicator.hide();\n            });\n        }\n    };\n\n    function trackingsCount(moodleID, instanceID, periodID) {\n\n        $.ajax({\n            type: \"POST\",\n            dataType: \"json\",\n            data: JSON.stringify({\n                \"function\": \"tracking_count\",\n                \"params\": [moodleID, instanceID, periodID],\n            }),\n            url: \"../managers/monitor_profile/monitor_profile_api.php\",\n            cache: \"false\",\n            success: function (msg) {\n                var result = msg;\n                if (result.status_code === 0) {\n                    $.ajax({\n                        url: \"../templates/monitor_total_count.mustache\",\n                        data: null,\n                        dataType: \"text\",\n                        cache: \"false\",\n                        async: \"false\",\n                        success: function (template) {\n                            let divToAppend = $(mustache.render(template, result.data_response));\n                            $(\"#ases-container-tracking\").append(divToAppend);\n                        },\n                        error: function() {\n                            console.log('Cannot reach template.');\n                        }\n                    });\n                }\n                else {\n                    console.log('error', msg);\n                }\n            },\n            error: function (msg) {\n               console.log('error', msg); \n                swal(\n                    \"Error\",\n                    \"Error al comunicarse con el servidor, por favor inténtelo nuevamente.\",\n                    \"error\"\n                );\n            },\n\n        });\n    }\n});\n"],"file":"mon_trackings.min.js"}