{"version":3,"sources":["../src/mon_trackings.js"],"names":["define","$","mustache","loading_indicator","init","dataInit","moodleID","instanceID","on","length","remove","periodID","val","trackingsCount","document","ajaxStart","show","ajaxStop","hide","ajax","type","dataType","data","JSON","stringify","url","cache","success","msg","result","status_code","async","template","divToAppend","render","data_response","append","error","console","log","swal"],"mappings":"AASAA,OAAM,4BAAC,CAAC,QAAD,CACC,qBADD,CAEC,8BAFD,CAAD,CAEmC,SAASC,CAAT,CAAYC,CAAZ,CAAsBC,CAAtB,CAAwC,CAE7E,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAmB,IAKjBC,CAAAA,CAAQ,CAAGD,CAAQ,CAAC,CAAD,CALF,CAMjBE,CAAU,CAAGF,CAAQ,CAAC,CAAD,CANJ,CAQrBJ,CAAC,CAAC,sBAAD,CAAD,CAA0BO,EAA1B,CAA6B,OAA7B,CAAsC,UAAY,CAC9C,GAAKP,CAAC,CAAC,kBAAD,CAAD,CAAsBQ,MAA3B,CAAoC,CAChCR,CAAC,CAAC,kBAAD,CAAD,CAAsBS,MAAtB,EACH,CAED,GAAIC,CAAAA,CAAQ,CAAGV,CAAC,CAAC,iBAAD,CAAD,CAAqBW,GAArB,EAAf,CACAC,CAAc,CAACP,CAAD,CAAWC,CAAX,CAAuBI,CAAvB,CACjB,CAPD,EASAV,CAAC,CAAEa,QAAF,CAAD,CAAcC,SAAd,CAAwB,UAAW,CAC/BZ,CAAiB,CAACa,IAAlB,EACH,CAFD,EAEGC,QAFH,CAEY,UAAW,CACnBd,CAAiB,CAACe,IAAlB,EACH,CAJD,CAKH,CAvBE,CAAP,CA0BA,QAASL,CAAAA,CAAT,CAAwBP,CAAxB,CAAkCC,CAAlC,CAA8CI,CAA9C,CAAwD,CAEpDV,CAAC,CAACkB,IAAF,CAAO,CACHC,IAAI,CAAE,MADH,CAEHC,QAAQ,CAAE,MAFP,CAGHC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjB,SAAY,gBADK,CAEjB,OAAU,CAAClB,CAAD,CAAWC,CAAX,CAAuBI,CAAvB,CAFO,CAAf,CAHH,CAOHc,GAAG,CAAE,qDAPF,CAQHC,KAAK,CAAE,OARJ,CASHC,OAAO,CAAE,iBAAUC,CAAV,CAAe,CACpB,GAAIC,CAAAA,CAAM,CAAGD,CAAb,CACA,GAA2B,CAAvB,GAAAC,CAAM,CAACC,WAAX,CAA8B,CAC1B7B,CAAC,CAACkB,IAAF,CAAO,CACHM,GAAG,CAAE,2CADF,CAEHH,IAAI,CAAE,IAFH,CAGHD,QAAQ,CAAE,MAHP,CAIHK,KAAK,CAAE,OAJJ,CAKHK,KAAK,CAAE,OALJ,CAMHJ,OAAO,CAAE,iBAAUK,CAAV,CAAoB,CACzB,GAAIC,CAAAA,CAAW,CAAGhC,CAAC,CAACC,CAAQ,CAACgC,MAAT,CAAgBF,CAAhB,CAA0BH,CAAM,CAACM,aAAjC,CAAD,CAAnB,CACAlC,CAAC,CAAC,0BAAD,CAAD,CAA8BmC,MAA9B,CAAqCH,CAArC,CACH,CATE,CAUHI,KAAK,CAAE,gBAAW,CACdC,OAAO,CAACC,GAAR,CAAY,wBAAZ,CACH,CAZE,CAAP,CAcH,CAfD,IAgBK,CACDD,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBX,CAArB,CACH,CACJ,CA9BE,CA+BHS,KAAK,CAAE,eAAUT,CAAV,CAAe,CACnBU,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBX,CAArB,EACCY,IAAI,CACA,OADA,CAEA,0EAFA,CAGA,OAHA,CAKP,CAtCE,CAAP,CAyCH,CACJ,CA1EK,CAAN","sourcesContent":["/**\r\n * Trackings tab belonging to the monitor's profile.\r\n *\r\n * @module block_ases/mon_trackings\r\n * @author David Santiago Cortés\r\n * @copyright 2020 David S. Cortés <david.cortes@correounivalle.edu.co>\r\n * @license GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', \r\n        'block_ases/mustache',\r\n        'block_ases/loading_indicator'], function($, mustache, loading_indicator){\r\n\r\n    return {\r\n        init: function(dataInit) {\r\n            //$('#select-periods').on('click', function () {\r\n            //    $(\"#btn-consulta-fichas\").removeAttr('hidden');\r\n            //})\r\n            \r\n            var moodleID = dataInit[0];\r\n            var instanceID = dataInit[1];\r\n\r\n            $(\"#btn-consulta-fichas\").on('click', function () {\r\n                if ( $(\"#total-count-row\").length ) {\r\n                    $(\"#total-count-row\").remove();\r\n                }\r\n\r\n                let periodID = $(\"#select-periods\").val();\r\n                trackingsCount(moodleID, instanceID, periodID);\r\n            });\r\n\r\n            $( document ).ajaxStart(function() {\r\n                loading_indicator.show();\r\n            }).ajaxStop(function() {\r\n                loading_indicator.hide();\r\n            });\r\n        }\r\n    };\r\n\r\n    function trackingsCount(moodleID, instanceID, periodID) {\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            data: JSON.stringify({\r\n                \"function\": \"tracking_count\",\r\n                \"params\": [moodleID, instanceID, periodID],\r\n            }),\r\n            url: \"../managers/monitor_profile/monitor_profile_api.php\",\r\n            cache: \"false\",\r\n            success: function (msg) {\r\n                var result = msg;\r\n                if (result.status_code === 0) {\r\n                    $.ajax({\r\n                        url: \"../templates/monitor_total_count.mustache\",\r\n                        data: null,\r\n                        dataType: \"text\",\r\n                        cache: \"false\",\r\n                        async: \"false\",\r\n                        success: function (template) {\r\n                            let divToAppend = $(mustache.render(template, result.data_response));\r\n                            $(\"#ases-container-tracking\").append(divToAppend);\r\n                        },\r\n                        error: function() {\r\n                            console.log('Cannot reach template.');\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    console.log('error', msg);\r\n                }\r\n            },\r\n            error: function (msg) {\r\n               console.log('error', msg); \r\n                swal(\r\n                    \"Error\",\r\n                    \"Error al comunicarse con el servidor, por favor inténtelo nuevamente.\",\r\n                    \"error\"\r\n                );\r\n            },\r\n\r\n        });\r\n    }\r\n});\r\n"],"file":"mon_trackings.min.js"}