define(["jquery","block_ases/jszip","block_ases/pdfmake","block_ases/jquery.dataTables","block_ases/dataTables.autoFill","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/bootstrap","block_ases/sweetalert2","block_ases/jqueryui","block_ases/select2","block_ases/Chart","block_ases/loading_indicator","block_ases/chartjs_plugin_datalabels"],function($,jszip,pdfmake,dataTables,autoFill,buttons,html5,flash,print,bootstrap,sweetalert,jqueryui,select2,Chart,loading_indicator,chartjs_plugin_datalabels){var graficas={};return{init:function(){window.JSZip=jszip,$("#list-students-programa-panel").on("click",function(){get_data_to_graphic("programa")}),$("#status_fields").on("change",function(){console.log($("#t_progsrama").length>0),get_data_to_graphic("programa")})},get_id_instance:function(){var urlParameters=location.search.split("&");for(x in urlParameters){var intanceparameter;if(urlParameters[x].indexOf("instanceid")>=0)return urlParameters[x].split("=")[1]}return 0}};function get_data_to_graphic(type){var ases_status=$("#ases_status").is(":checked")?1:0,icetex_status=$("#icetex_status").is(":checked")?1:0,program_status=$("#academic_program_status").is(":checked")?1:0;$.ajax({type:"POST",data:{type:type,cohort:$("#conditions").val(),ases_status:ases_status,icetex_status:icetex_status,program_status:program_status,instance_id:getIdinstancia()},url:"../managers/ases_report/asesreport_graphics_processing.php",success:function(msg){creategraphicProgramas(msg.data),createTable(msg)},dataType:"json",cache:!1,async:!0,failure:function(msg){}})}function createTable(msg){$("#div_table_programa").empty(),$("#div_table_programa").append('<table id="t_programa" class="table" cellspacing="0" width="100%"><thead> </thead></table>'),$("#t_programa").DataTable(msg)}function creategraphicProgramas(data){var programas=[],cantidades=[];for(var x in data)nombrePrograma=data[x].nombre,cantidadPrograma=data[x].count,nombrePrograma=data[x].nombre,cantidadPrograma=data[x].count,"PLAN TALENTOS PILOS"!==nombrePrograma&&("LICENCIATURA EN EDUCACIÓN BÁSICA CON ÉNFASIS EN CIENCIAS NATURALES Y EDUCACIÓN AMBIENTAL"===nombrePrograma&&(nombrePrograma="LIC. EN EDU. BÁSICA ÉNFASIS EN CIENCIAS NATURALES Y EDU. AMBIENTAL"),"LICENCIATURA EN EDUCACIÓN BÁSICA CON ÉNFASIS EN CIENCIAS SOCIALES"===nombrePrograma&&(nombrePrograma="LIC. EN EDU. BÁSICA CON ÉNFASIS EN CIENCIAS SOCIALES"),programas.push(nombrePrograma),cantidades.push(cantidadPrograma));$(".chart-container").css("height","1300px"),$(".chart-container").css("width","100%");for(var backgroundColors=[],borderColors=[],i=0;i<programas.length;i++)i%2==0?(backgroundColors.push("rgba(255, 99, 132, 0.2)"),borderColors.push("rgba(255, 99, 132, 1)")):(backgroundColors.push("rgba(130, 130, 130, 0.2)"),borderColors.push("rgba(130, 130, 130, 1)"));var ctx=document.getElementById("grafica_programa").getContext("2d"),data={labels:programas,datasets:[{label:"Cantidad de Estudiantes",data:cantidades,backgroundColor:backgroundColors,borderColor:borderColors,borderWidth:3}]};graficas.chart_programa?(graficas.chart_programa.data=data,graficas.chart_programa.update()):graficas.chart_programa=new Chart(ctx,{type:"horizontalBar",data:data,options:{elements:{rectangle:{borderWidth:2}},responsive:!0,legend:{position:"top",display:!1},title:{display:!0,text:"No. de Estudiantes por Programa",fontSize:30},scales:{yAxes:[{ticks:{display:!0},categoryPercentage:1,barPercentage:1}]},maintainAspectRatio:!1,plugins:{datalabels:{display:!0,align:"center",anchor:"center"}}}})}function createBarGraphic(tipo,labelsGrafica,cantidades){$(".chart-container").css("height","1300px"),$(".chart-container").css("width","100%");for(var backgroundColors=[],borderColors=[],i=0;i<programas.length;i++)i%2==0?(backgroundColors.push("rgba(255, 99, 132, 0.2)"),borderColors.push("rgba(255, 99, 132, 1)")):(backgroundColors.push("rgba(130, 130, 130, 0.2)"),borderColors.push("rgba(130, 130, 130, 1)"));var ctx=document.getElementById("grafica_"+tipo).getContext("2d"),data={labels:labelsGrafica,datasets:[{label:"Cantidad de Estudiantes",data:cantidades,backgroundColor:backgroundColors,borderColor:borderColors,borderWidth:3}]};graficas["chart_"+tipo]?(graficas["chart_"+tipo].data=data,graficas["chart_"+tipo].update()):graficas["chart_"+tipo]=new Chart(ctx,{type:"horizontalBar",data:data,options:{elements:{rectangle:{borderWidth:2}},responsive:!0,legend:{position:"top",display:!1},title:{display:!0,text:"No. de Estudiantes por"+tipo,fontSize:30},scales:{yAxes:[{ticks:{display:!0},categoryPercentage:1,barPercentage:1}]},maintainAspectRatio:!1,plugins:{datalabels:{display:!0,align:"center",anchor:"center"}}}})}function updateTable(){var cohorts=$("#conditions").val();"TODOS"==cohorts?($("#div-summary-spp").prop("hidden",!1),$("#div-summary-spe").prop("hidden",!1),$("#div-summary-3740").prop("hidden",!1),$("#div-summary-oa").prop("hidden",!1)):"TODOS-SPP"==cohorts||"SPP"==cohorts.substring(0,3)?($("#div-summary-spp").prop("hidden",!1),$("#div-summary-spe").prop("hidden",!0),$("#div-summary-3740").prop("hidden",!0),$("#div-summary-oa").prop("hidden",!0)):"TODOS-SPE"==cohorts||"SPE"==cohorts.substring(0,3)?($("#div-summary-spfunctionp").prop("hidden",!0),$("#div-summary-spe").prop("hidden",!1),$("#div-summary-3740").prop("hidden",!0),$("#div-summary-oa").prop("hidden",!0)):"TODOS-3740"==cohorts||"3740"==cohorts.substring(0,4)?($("#div-summary-spp").prop("hidden",!0),$("#div-summary-spe").prop("hidden",!0),$("#div-summary-3740").prop("hidden",!1),$("#div-summary-oa").prop("hidden",!0)):"TODOS-OTROS"==cohorts&&($("#div-summary-spp").prop("hidden",!0),$("#div-summary-spe").prop("hidden",!0),$("#div-summary-3740").prop("hidden",!0),$("#div-summary-oa").prop("hidden",!1))}function getIdinstancia(){var urlParameters=location.search.split("&");for(x in urlParameters){var intanceparameter;if(urlParameters[x].indexOf("instanceid")>=0)return urlParameters[x].split("=")[1]}return 0}});